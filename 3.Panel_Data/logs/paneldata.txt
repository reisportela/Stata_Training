-----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/miguelportela/Documents/GitHub/Stata_Training/3.Panel_Data/logs/paneldata.txt
  log type:  text
 opened on:  28 Dec 2021, 21:37:13
r; t=0.00 21:37:13

. 
. // # 1. build simulated data: 10000 observations
. 
.         set obs 5000                    //      define the number of observations
Number of observations (_N) was 0, now 5,000.
r; t=0.00 21:37:13

.         set seed 345567789              //      define the 'seed' in order to be able
r; t=0.00 21:37:13

.                                                         //      to replicate the results
. 
.         // # 1.1. define worker's id and year of observation
. 
.                 gen workerid = int(_n/10.1)+1
r; t=0.00 21:37:13

.                 bysort workerid: gen year = _n
r; t=0.00 21:37:13

. 
.                 sort workerid year
r; t=0.00 21:37:13

.                 xtset workerid year

Panel variable: workerid (unbalanced)
 Time variable: year, 1 to 11
         Delta: 1 unit
r; t=0.01 21:37:13

. 
.         // # 1.2. generate individual's specific effect, ui
. 
.                 bysort workerid (year): gen double ui = runiform() if _n == 1
(4,504 missing values generated)
r; t=0.00 21:37:13

.                          bysort workerid (year): replace ui = ui[_n-1] if _n > 1
(4504 real changes made)
r; t=0.00 21:37:13

. 
.         // # 1.3. build the instrument, q1
. 
.                 bysort workerid (year): gen quarter= int(4*uniform()+1) if _n == 1
(4,504 missing values generated)
r; t=0.00 21:37:13

.                          bysort workerid (year): replace quarter = quarter[_n-1] if _n > 1
(4504 real changes made)
r; t=0.00 21:37:13

. 
.                         gen q1=(quarter==1)
r; t=0.00 21:37:13

. 
.         // # 1.4. build education and experience; education is a function of ui,
.                         // the worker specific effect, as well as the instrument, q1
. 
.                 bysort workerid (year): gen educ= int(16*runiform())*ui if _n == 1
(4,504 missing values generated)
r; t=0.00 21:37:13

.                         bysort workerid (year): replace educ= educ - 3*q1 if _n == 1
(119 real changes made)
r; t=0.00 21:37:13

. 
.                         bysort workerid (year): replace educ = educ[_n-1] + round(runiform()) if _n > 1
(4,504 real changes made)
r; t=0.00 21:37:13

.                                 sum educ, detail

                            educ
-------------------------------------------------------------
      Percentiles      Smallest
 1%      -2.1118             -3
 5%    -.1260787             -3
10%     .5240426             -3       Obs               5,000
25%     2.330317      -2.922136       Sum of wgt.       5,000

50%     4.685726                      Mean           5.193152
                        Largest       Std. dev.      3.914044
75%     7.689298       18.25217
90%      10.7564       18.30014       Variance       15.31974
95%     12.63449       18.44627       Skewness       .5687296
99%      15.5471       19.44627       Kurtosis       3.003111
r; t=0.00 21:37:13

.                         
.                         egen sd = sd(educ),by(workerid)
(1 missing value generated)
r; t=0.00 21:37:13

.                                 sum sd, detail

                             sd
-------------------------------------------------------------
      Percentiles      Smallest
 1%      .421637              0
 5%     .8232726              0
10%     .9660916              0       Obs               4,999
25%     1.229273              0       Sum of wgt.       4,999

50%     1.595132                      Mean           1.610723
                        Largest       Std. dev.      .5084654
75%      1.95789       3.316625
90%     2.299758       3.316625       Variance       .2585371
95%     2.440401       3.316625       Skewness        .006283
99%      2.65832       3.316625       Kurtosis       2.734078
r; t=0.00 21:37:13

.                                 drop sd
r; t=0.00 21:37:13

.                                 
.                                 recode educ min/0 = 0 20/max = 20
(281 changes made to educ)
r; t=0.00 21:37:13

.                                         sum educ, detail

                            educ
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%     .5240426              0       Obs               5,000
25%     2.330317              0       Sum of wgt.       5,000

50%     4.685726                      Mean           5.260554
                        Largest       Std. dev.       3.80712
75%     7.689298       18.25217
90%      10.7564       18.30014       Variance       14.49416
95%     12.63449       18.44627       Skewness       .7024372
99%      15.5471       19.44627       Kurtosis         3.0027
r; t=0.00 21:37:13

. 
.                 bysort workerid (year): gen exper= int(20*uniform()) if _n == 1
(4,504 missing values generated)
r; t=0.00 21:37:13

.                         bysort workerid (year): replace exper = exper[_n-1] + 1 if _n > 1
(4504 real changes made)
r; t=0.00 21:37:13

. 
.                         gen exper2 = exper^2
r; t=0.00 21:37:13

.         
.         // # 1.5. union status
.         
.                 gen union = round(uniform(),1.0)
r; t=0.00 21:37:13

.                         
.                         tab union

      union |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      2,568       51.36       51.36
          1 |      2,432       48.64      100.00
------------+-----------------------------------
      Total |      5,000      100.00
r; t=0.00 21:37:13

. 
.         // # 1.6. generate the true log wage equation, where the error term is
.                                 // defined by 'uniform()/ln(600)'; 600 is the minimum wage
.         
.                 gen double lnwage = ln(600) + 0.06*educ + 0.007*exper - 0.00001*exper2 ///
>                                                         + 0.02*year + ui + uniform()/ln(600)
r; t=0.00 21:37:13

. 
.                         gen wage = exp(lnwage)
r; t=0.00 21:37:13

.                         
.                         egen nobs = count(workerid),by(workerid)
r; t=0.00 21:37:13

.                                 tab nobs

       nobs |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.02        0.02
         10 |      4,460       89.20       89.22
         11 |        539       10.78      100.00
------------+-----------------------------------
      Total |      5,000      100.00
r; t=0.00 21:37:13

.                                         drop if nobs < 10
(1 observation deleted)
r; t=0.00 21:37:13

.                                         
.                                                 drop nobs
r; t=0.00 21:37:13

. 
.         compress
  variable workerid was float now int
  variable year was float now byte
  variable quarter was float now byte
  variable q1 was float now byte
  variable exper was float now byte
  variable exper2 was float now int
  variable union was float now byte
  (94,981 bytes saved)
r; t=0.00 21:37:13

.         order workerid year ui quarter q1 wage educ exper union exper2 lnwage
r; t=0.00 21:37:13

. 
.         sort workerid year
r; t=0.00 21:37:13

.         xtset workerid year

Panel variable: workerid (unbalanced)
 Time variable: year, 1 to 11
         Delta: 1 unit
r; t=0.00 21:37:13

. 
.                                 save ../data/data_simulation, replace
file ../data/data_simulation.dta saved
r; t=0.00 21:37:13

. 
. 
. // # 2. DESCRIPTIVE STATISTICS
. 
.                 describe

Contains data from ../data/data_simulation.dta
 Observations:         4,999                  
    Variables:            11                  28 Dec 2021 21:37
-----------------------------------------------------------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
-----------------------------------------------------------------------------------------------------------------------------------
workerid        int     %9.0g                 
year            byte    %9.0g                 
ui              double  %10.0g                
quarter         byte    %9.0g                 
q1              byte    %9.0g                 
wage            float   %9.0g                 
educ            float   %9.0g                 
exper           byte    %9.0g                 
union           byte    %9.0g                 
exper2          int     %9.0g                 
lnwage          double  %10.0g                
-----------------------------------------------------------------------------------------------------------------------------------
Sorted by: workerid  year
r; t=0.00 21:37:13

.                 codebook, compact

Variable    Obs Unique      Mean       Min       Max  Label
-----------------------------------------------------------------------------------------------------------------------------------
workerid   4999    495  248.0294         1       495  
year       4999     11  5.553911         1        11  
ui         4999    495  .4884879  .0004503  .9957856  
quarter    4999      4  2.517904         1         4  
q1         4999      2   .239848         0         1  
wage       4999   4999  2008.105  662.0831  7198.693  
educ       4999   2491  5.261493         0  19.44627  
exper      4999     30  14.38588         0        29  
union      4999      2  .4864973         0         1  
exper2     4999     30  248.9076         0       841  
lnwage     4999   4999    7.4873  6.495391  8.881655  
-----------------------------------------------------------------------------------------------------------------------------------
r; t=0.02 21:37:13

.                 
.                 sum

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
    workerid |      4,999    248.0294    142.8941          1        495
        year |      4,999    5.553911    2.909369          1         11
          ui |      4,999    .4884879    .2884566   .0004503   .9957856
     quarter |      4,999    2.517904    1.127891          1          4
          q1 |      4,999     .239848    .4270333          0          1
-------------+---------------------------------------------------------
        wage |      4,999    2008.105    1039.732   662.0831   7198.693
        educ |      4,999    5.261493    3.806922          0   19.44627
       exper |      4,999    14.38588    6.477848          0         29
       union |      4,999    .4864973    .4998676          0          1
      exper2 |      4,999    248.9076    188.5734          0        841
-------------+---------------------------------------------------------
      lnwage |      4,999      7.4873    .4775467   6.495391   8.881655
r; t=0.00 21:37:13

.                 inspect educ

educ:                                           Number of observations
-------                                ---------------------------------------
                                             Total      Integers   Nonintegers
|  #                         Negative            -             -             -
|  #   #                     Zero              333           333             -
|  #   #                     Positive        4,666           206         4,460
|  #   #                               -----------   -----------   -----------
|  #   #   #                 Total           4,999           539         4,460
|  #   #   #   .   .         Missing             -
+----------------------                -----------
0              19.44627                      4,999
(More than 99 unique values)
r; t=0.00 21:37:13

.                 
.                 xtdes

workerid:  1, 2, ..., 495                                    n =        495
    year:  1, 2, ..., 11                                     T =         11
           Delta(year) = 1 unit
           Span(year)  = 11 periods
           (workerid*year uniquely identifies each observation)

Distribution of T_i:   min      5%     25%       50%       75%     95%     max
                        10      10      10        10        10      11      11

     Freq.  Percent    Cum. |  Pattern
 ---------------------------+-------------
      446     90.10   90.10 |  1111111111.
       49      9.90  100.00 |  11111111111
 ---------------------------+-------------
      495    100.00         |  XXXXXXXXXXX
r; t=0.02 21:37:13

.                 xtsum

Variable         |      Mean   Std. dev.       Min        Max |    Observations
-----------------+--------------------------------------------+----------------
workerid overall |  248.0294   142.8941          1        495 |     N =    4999
         between |             143.0385          1        495 |     n =     495
         within  |                    0   248.0294   248.0294 | T-bar =  10.099
                 |                                            |
year     overall |  5.553911   2.909369          1         11 |     N =    4999
         between |             .1494753        5.5          6 |     n =     495
         within  |             2.905233   .5539108   10.55391 | T-bar =  10.099
                 |                                            |
ui       overall |  .4884879   .2884566   .0004503   .9957856 |     N =    4999
         between |             .2887778   .0004503   .9957856 |     n =     495
         within  |             6.95e-17   .4884879   .4884879 | T-bar =  10.099
                 |                                            |
quarter  overall |  2.517904   1.127891          1          4 |     N =    4999
         between |             1.128938          1          4 |     n =     495
         within  |                    0   2.517904   2.517904 | T-bar =  10.099
                 |                                            |
q1       overall |   .239848   .4270333          0          1 |     N =    4999
         between |             .4277611          0          1 |     n =     495
         within  |                    0    .239848    .239848 | T-bar =  10.099
                 |                                            |
wage     overall |  2008.105   1039.732   662.0831   7198.693 |     N =    4999
         between |             963.0626   766.2481    5430.79 |     n =     495
         within  |             391.8998    632.141   3911.588 | T-bar =  10.099
                 |                                            |
educ     overall |  5.261493   3.806922          0   19.44627 |     N =    4999
         between |              3.47616          0   15.79511 |     n =     495
         within  |             1.563407    .261493   10.26149 | T-bar =  10.099
                 |                                            |
exper    overall |  14.38588   6.477848          0         29 |     N =    4999
         between |             5.789282        4.5         24 |     n =     495
         within  |             2.905233   9.385877   19.38588 | T-bar =  10.099
                 |                                            |
union    overall |  .4864973   .4998676          0          1 |     N =    4999
         between |             .1594503          0         .9 |     n =     495
         within  |             .4738822  -.4135027   1.386497 | T-bar =  10.099
                 |                                            |
exper2   overall |  248.9076   188.5734          0        841 |     N =    4999
         between |             165.3961       28.5        586 |     n =     495
         within  |             90.43946   23.90758   503.9076 | T-bar =  10.099
                 |                                            |
lnwage   overall |    7.4873   .4775467   6.495391   8.881655 |     N =    4999
         between |              .445779   6.635227   8.581674 |     n =     495
         within  |             .1725307   7.075361   7.910865 | T-bar =  10.099
r; t=0.01 21:37:13

.                 
.                         gen educ_int = round(educ,1.0)
r; t=0.00 21:37:13

. 
.         xttab educ_int

                  Overall             Between            Within
 educ_int |    Freq.  Percent      Freq.  Percent        Percent
----------+-----------------------------------------------------
        0 |     491      9.82       135     27.27          36.24
        1 |     394      7.88       199     40.20          19.67
        2 |     447      8.94       245     49.49          18.15
        3 |     564     11.28       279     56.36          20.02
        4 |     522     10.44       291     58.79          17.75
        5 |     499      9.98       280     56.57          17.63
        6 |     431      8.62       250     50.51          17.04
        7 |     344      6.88       210     42.42          16.19
        8 |     318      6.36       179     36.16          17.49
        9 |     254      5.08       149     30.10          16.86
       10 |     183      3.66       120     24.24          15.05
       11 |     145      2.90        92     18.59          15.51
       12 |     137      2.74        70     14.14          19.32
       13 |     112      2.24        58     11.72          19.09
       14 |      64      1.28        41      8.28          15.48
       15 |      43      0.86        23      4.65          18.50
       16 |      27      0.54        15      3.03          17.88
       17 |      15      0.30        12      2.42          12.35
       18 |       8      0.16         7      1.41          11.17
       19 |       1      0.02         1      0.20          10.00
----------+-----------------------------------------------------
    Total |    4999    100.00      2656    536.57          18.64
                               (n = 495)
r; t=0.01 21:37:13

.         xttab union

                  Overall             Between            Within
    union |    Freq.  Percent      Freq.  Percent        Percent
----------+-----------------------------------------------------
        0 |    2567     51.35       495    100.00          51.36
        1 |    2432     48.65       494     99.80          48.74
----------+-----------------------------------------------------
    Total |    4999    100.00       989    199.80          50.05
                               (n = 495)
r; t=0.00 21:37:13

. 
.         xttrans educ_int

           |                                              educ_int
  educ_int |         0          1          2          3          4          5          6          7          8 |     Total
-----------+---------------------------------------------------------------------------------------------------+----------
         0 |     73.71      26.29       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         1 |      0.00      50.78      49.22       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         2 |      0.00       0.00      46.98      53.02       0.00       0.00       0.00       0.00       0.00 |    100.00 
         3 |      0.00       0.00       0.00      52.88      47.12       0.00       0.00       0.00       0.00 |    100.00 
         4 |      0.00       0.00       0.00       0.00      48.94      51.06       0.00       0.00       0.00 |    100.00 
         5 |      0.00       0.00       0.00       0.00       0.00      49.32      50.68       0.00       0.00 |    100.00 
         6 |      0.00       0.00       0.00       0.00       0.00       0.00      48.66      51.34       0.00 |    100.00 
         7 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00      46.05      53.95 |    100.00 
         8 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00      50.55 |    100.00 
         9 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        10 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        11 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        12 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        13 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        14 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        15 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        16 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        17 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        18 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
-----------+---------------------------------------------------------------------------------------------------+----------
     Total |      7.90       7.15       8.68      11.39      10.77      10.21       9.01       7.22       6.57 |    100.00 


           |                                              educ_int
  educ_int |         9         10         11         12         13         14         15         16         17 |     Total
-----------+---------------------------------------------------------------------------------------------------+----------
         0 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         1 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         2 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         3 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         4 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         5 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         6 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         7 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         8 |     49.45       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
         9 |     48.39      51.61       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        10 |      0.00      42.28      57.72       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
        11 |      0.00       0.00      45.30      54.70       0.00       0.00       0.00       0.00       0.00 |    100.00 
        12 |      0.00       0.00       0.00      56.30      43.70       0.00       0.00       0.00       0.00 |    100.00 
        13 |      0.00       0.00       0.00       0.00      56.84      43.16       0.00       0.00       0.00 |    100.00 
        14 |      0.00       0.00       0.00       0.00       0.00      50.00      50.00       0.00       0.00 |    100.00 
        15 |      0.00       0.00       0.00       0.00       0.00       0.00      57.14      42.86       0.00 |    100.00 
        16 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00      50.00      50.00 |    100.00 
        17 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00      30.00 |    100.00 
        18 |      0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00       0.00 |    100.00 
-----------+---------------------------------------------------------------------------------------------------+----------
     Total |      5.35       3.89       3.09       2.91       2.35       1.42       0.95       0.60       0.33 |    100.00 


           |       educ_int
  educ_int |        18         19 |     Total
-----------+----------------------+----------
         0 |      0.00       0.00 |    100.00 
         1 |      0.00       0.00 |    100.00 
         2 |      0.00       0.00 |    100.00 
         3 |      0.00       0.00 |    100.00 
         4 |      0.00       0.00 |    100.00 
         5 |      0.00       0.00 |    100.00 
         6 |      0.00       0.00 |    100.00 
         7 |      0.00       0.00 |    100.00 
         8 |      0.00       0.00 |    100.00 
         9 |      0.00       0.00 |    100.00 
        10 |      0.00       0.00 |    100.00 
        11 |      0.00       0.00 |    100.00 
        12 |      0.00       0.00 |    100.00 
        13 |      0.00       0.00 |    100.00 
        14 |      0.00       0.00 |    100.00 
        15 |      0.00       0.00 |    100.00 
        16 |      0.00       0.00 |    100.00 
        17 |     70.00       0.00 |    100.00 
        18 |     50.00      50.00 |    100.00 
-----------+----------------------+----------
     Total |      0.18       0.02 |    100.00 
r; t=0.00 21:37:13

.         xttrans union

           |         union
     union |         0          1 |     Total
-----------+----------------------+----------
         0 |     51.67      48.33 |    100.00 
         1 |     51.66      48.34 |    100.00 
-----------+----------------------+----------
     Total |     51.67      48.33 |    100.00 
r; t=0.00 21:37:13

. 
.                         preserve
r; t=0.00 21:37:13

.                                 collapse (mean) mean_educ = educ (count) educ,by(workerid)
r; t=0.00 21:37:13

.                                 sum mean_educ educ if mean_educ ~= .

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
   mean_educ |        495    5.252014     3.47616          0   15.79511
        educ |        495    10.09899    .2989506         10         11
r; t=0.00 21:37:13

.                         restore
r; t=0.00 21:37:13

. 
.                                 tabstat educ,by(union)

Summary for variables: educ
Group variable: union 

   union |      Mean
---------+----------
       0 |  5.365979
       1 |  5.151207
---------+----------
   Total |  5.261493
--------------------
r; t=0.00 21:37:13

.                                 sum educ, detail

                            educ
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%     .5167809              0       Obs               4,999
25%     2.333112              0       Sum of wgt.       4,999

50%     4.686391                      Mean           5.261493
                        Largest       Std. dev.      3.806922
75%     7.690707       18.25217
90%      10.7591       18.30014       Variance       14.49265
95%     12.63789       18.44627       Skewness       .7023227
99%      15.5471       19.44627       Kurtosis       3.002771
r; t=0.00 21:37:13

.                                         scalar median_educ = r(p50)
r; t=0.00 21:37:13

. 
.         // # 2.1. export descriptive statistics & graphs
. 
.                                         preserve
r; t=0.00 21:37:13

.                                                 set dp comma
r; t=0.00 21:37:13

.                                                         tab year

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495        9,90        9,90
          2 |        495        9,90       19,80
          3 |        495        9,90       29,71
          4 |        495        9,90       39,61
          5 |        495        9,90       49,51
          6 |        495        9,90       59,41
          7 |        495        9,90       69,31
          8 |        495        9,90       79,22
          9 |        495        9,90       89,12
         10 |        495        9,90       99,02
         11 |         49        0,98      100,00
------------+-----------------------------------
      Total |       4999      100,00
r; t=0.00 21:37:13

.                                                                 sum year

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4.999    5,553911    2,909369          1         11
r; t=0.00 21:37:13

.                                                                 
.                                                         keep if year == r(max)
(4.950 observations deleted)
r; t=0.00 21:37:13

.                                                         
.                                                         format %12.3f wage educ exper
r; t=0.00 21:37:13

.                                                         
.                                         estpost summarize wage educ exper

             |  e(count)   e(sum_w)    e(mean)     e(Var)      e(sd)     e(min)     e(max)     e(sum) 
-------------+----------------------------------------------------------------------------------------
        wage |        49         49   2950,271    1798876   1341,222   1277,173   7198,693   144563,3 
        educ |        49         49   8,816067   11,25093   3,354241   3,376724   18,15874   431,9873 
       exper |        49         49   19,38776   41,15901   6,415529         10         29        950 
r; t=0.00 21:37:13

.                                         esttab using ../tex_paper/summary_statistics.tex, replace ///
>                                                 cells("count mean sd min max") nonumbers noobs label ///
>                                                 nomtitles nonotes addnotes("Source: own computations.")
(output written to ../tex_paper/summary_statistics.tex)
r; t=0.02 21:37:13

.                                                 
.                                                 set dp period
r; t=0.00 21:37:13

.                                         restore
r; t=0.00 21:37:13

. 
.                                         preserve
r; t=0.00 21:37:13

.                                                 collapse (mean) mean_educ = educ mean_wage = wage,by(year)
r; t=0.00 21:37:13

.                                                 gen ln_mean_wage = ln(mean_wage)
r; t=0.00 21:37:13

.                                                 
.                                                 label var mean_educ "Average education"
r; t=0.00 21:37:13

.                                                 label var ln_mean_wage "Ln Average WAGE"
r; t=0.00 21:37:13

.                                                 
.                                                 sum year

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        year |         11           6    3.316625          1         11
r; t=0.00 21:37:13

.                                                 local mm = r(min)
r; t=0.00 21:37:13

.                                                 local jj = r(max)
r; t=0.00 21:37:13

.                                                 twoway (line mean_educ year, yaxis(1)) || (line ln_mean_wage year, yaxis(2) title
> ("`mm' - `jj'")), ///
>                                                         scheme(sj) title("") graphregion(color(white)) legend(region(color(white)
> ))
r; t=0.73 21:37:14

.                                                         
.                                                         graph export ../tex_paper/figures/mean_education_wage_year.png, replace
file /Users/miguelportela/Documents/GitHub/Stata_Training/3.Panel_Data/logs/../tex_paper/figures/mean_education_wage_year.png
    saved as PNG format
r; t=0.15 21:37:14

.                                                         graph export ../tex_paper/figures/mean_education_wage_year.eps, replace
file ../tex_paper/figures/mean_education_wage_year.eps saved as EPS format
r; t=0.00 21:37:14

.                                         restore
r; t=0.00 21:37:14

. 
.                                                 sum year

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        year |      4,999    5.553911    2.909369          1         11
r; t=0.00 21:37:14

.                                                 local mm = r(min)
r; t=0.00 21:37:14

.                                                 local jj = r(max)
r; t=0.00 21:37:14

.                                         
.                                         twoway kdensity lnwage if educ <= median_educ,legend(on label(1 "Low education")) || kden
> sity lnwage if educ > median_educ, /*
>                                                 */ legend(on label(2 "High education")) title("`mm' - `jj'") scheme(s2mono) graph
> region(color(white)) xtitle("Ln GDP") /*
>                                                 */ ytitle("Density") legend(region(lcolor(white))) legend(region(color(white)))
r; t=0.54 21:37:14

. 
.                                                 graph export ../tex_paper/figures/lnwage_education.png, replace                  
>                
file /Users/miguelportela/Documents/GitHub/Stata_Training/3.Panel_Data/logs/../tex_paper/figures/lnwage_education.png saved as
    PNG format
r; t=0.15 21:37:14

.                                                 graph export ../tex_paper/figures/lnwage_education.eps, replace
file ../tex_paper/figures/lnwage_education.eps saved as EPS format
r; t=0.00 21:37:14

. 
. 
. // # 3. REGRESSIONS
. 
.         // # 3.1 OLS
. 
.                 reg lnwage educ exper exper2

      Source |       SS           df       MS      Number of obs   =     4,999
-------------+----------------------------------   F(3, 4995)      =   4890.34
       Model |  850.299027         3  283.433009   Prob > F        =    0.0000
    Residual |  289.498964     4,995  .057957751   R-squared       =    0.7460
-------------+----------------------------------   Adj R-squared   =    0.7459
       Total |  1139.79799     4,998  .228050819   Root MSE        =    .24074

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .1068286   .0009049   118.06   0.000     .1050546    .1086026
       exper |   .0130625   .0021764     6.00   0.000     .0087959    .0173291
      exper2 |  -.0002847   .0000748    -3.81   0.000    -.0004314   -.0001381
       _cons |   6.808179   .0149628   455.01   0.000     6.778846    6.837513
------------------------------------------------------------------------------
r; t=0.04 21:37:14

.                 reg lnwage educ exper exper2 i.year ui

      Source |       SS           df       MS      Number of obs   =     4,999
-------------+----------------------------------   F(14, 4984)     =  39233.71
       Model |  1129.54866        14  80.6820472   Prob > F        =    0.0000
    Residual |  10.2493308     4,984  .002056447   R-squared       =    0.9910
-------------+----------------------------------   Adj R-squared   =    0.9910
       Total |  1139.79799     4,998  .228050819   Root MSE        =    .04535

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0602745   .0002219   271.63   0.000     .0598395    .0607096
       exper |   .0072459   .0004172    17.37   0.000      .006428    .0080639
      exper2 |  -.0000189   .0000143    -1.32   0.187     -.000047    9.18e-06
             |
        year |
          2  |   .0196236   .0028883     6.79   0.000     .0139612    .0252861
          3  |   .0395367   .0029039    13.61   0.000     .0338437    .0452297
          4  |   .0542252   .0029267    18.53   0.000     .0484875    .0599629
          5  |   .0779397   .0029553    26.37   0.000     .0721461    .0837334
          6  |   .0987565   .0029901    33.03   0.000     .0928945    .1046184
          7  |    .116347   .0030308    38.39   0.000     .1104053    .1222888
          8  |   .1378029     .00308    44.74   0.000     .1317646    .1438411
          9  |   .1558036   .0031344    49.71   0.000     .1496589    .1619484
         10  |   .1776208   .0031974    55.55   0.000     .1713525    .1838892
         11  |   .1961003   .0069773    28.11   0.000     .1824218    .2097789
             |
          ui |   1.001255   .0027175   368.45   0.000     .9959278    1.006583
       _cons |   6.492699   .0032952  1970.33   0.000     6.486239    6.499159
------------------------------------------------------------------------------
r; t=0.00 21:37:14

. 
.                 reg lnwage educ exper exper2 i.year

      Source |       SS           df       MS      Number of obs   =     4,999
-------------+----------------------------------   F(13, 4985)     =   1126.70
       Model |  850.379111        13  65.4137778   Prob > F        =    0.0000
    Residual |   289.41888     4,985   .05805795   R-squared       =    0.7461
-------------+----------------------------------   Adj R-squared   =    0.7454
       Total |  1139.79799     4,998  .228050819   Root MSE        =    .24095

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .1071192   .0009663   110.85   0.000     .1052248    .1090136
       exper |    .013314   .0022152     6.01   0.000     .0089712    .0176567
      exper2 |  -.0002855    .000076    -3.76   0.000    -.0004344   -.0001366
             |
        year |
          2  |  -.0010763    .015344    -0.07   0.944    -.0311573    .0290046
          3  |  -.0020475   .0154181    -0.13   0.894    -.0322738    .0281788
          4  |  -.0076576   .0155252    -0.49   0.622    -.0380939    .0227787
          5  |  -.0041708   .0156579    -0.27   0.790    -.0348672    .0265256
          6  |  -.0049112   .0158171    -0.31   0.756    -.0359197    .0260973
          7  |  -.0090163   .0160022    -0.56   0.573    -.0403876     .022355
          8  |  -.0107764   .0162246    -0.66   0.507    -.0425837    .0210309
          9  |  -.0131273    .016475    -0.80   0.426    -.0454256     .019171
         10  |  -.0106152   .0167709    -0.63   0.527    -.0434936    .0222631
         11  |   .0061882   .0369717     0.17   0.867    -.0662926    .0786691
             |
       _cons |   6.809441   .0169026   402.86   0.000     6.776304    6.842577
------------------------------------------------------------------------------
r; t=0.00 21:37:14

.                         est store OLS
r; t=0.00 21:37:14

.                         
.         // # 3.2 PANEL
. 
.                 // # 3.2.1 RANDOM EFFECTS
. 
.                         xtreg lnwage educ exper exper2 i.year, re theta

Random-effects GLS regression                   Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9372                                         min =         10
     Between = 0.7206                                         avg =       10.1
     Overall = 0.7162                                         max =         11

                                                Wald chi2(13)     =   65607.05
corr(u_i, X) = 0 (assumed)                      Prob > chi2       =     0.0000

------------------- theta --------------------
  min      5%       median        95%      max
0.9388   0.9388     0.9388     0.9417   0.9417

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0664224   .0009286    71.53   0.000     .0646025    .0682424
       exper |   .0045625   .0019449     2.35   0.019     .0007505    .0083744
      exper2 |   2.74e-06   .0000195     0.14   0.888    -.0000354    .0000409
             |
        year |
          2  |   .0192164   .0035213     5.46   0.000     .0123149    .0261179
          3  |   .0385848   .0048399     7.97   0.000     .0290988    .0480708
          4  |   .0526923   .0064635     8.15   0.000     .0400241    .0653605
          5  |   .0757218   .0082143     9.22   0.000     .0596222    .0918215
          6  |   .0955659   .0100328     9.53   0.000      .075902    .1152299
          7  |   .1120524   .0118874     9.43   0.000     .0887536    .1353512
          8  |   .1320914   .0137717     9.59   0.000     .1050994    .1590834
          9  |    .148938   .0156592     9.51   0.000     .1182465    .1796295
         10  |   .1696252   .0175546     9.66   0.000     .1352188    .2040315
         11  |   .1862191   .0205745     9.05   0.000     .1458938    .2265444
             |
       _cons |   6.985542   .0217866   320.64   0.000     6.942842    7.028243
-------------+----------------------------------------------------------------
     sigma_u |  .23484825
     sigma_e |  .04551187
         rho |  .96380377   (fraction of variance due to u_i)
------------------------------------------------------------------------------
r; t=0.08 21:37:15

.                                         est store RE
r; t=0.00 21:37:15

.                                 
.                 // # 3.2.2 FIXED EFFECTS
. 
.                         // discuss why some time dummies are dropped
. 
.                         xtreg lnwage educ exper exper2, fe                      // omit the time dummies

Fixed-effects (within) regression               Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9374                                         min =         10
     Between = 0.5419                                         avg =       10.1
     Overall = 0.5872                                         max =         11

                                                F(3,4501)         =   22462.32
corr(u_i, Xb) = 0.1874                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |    .062331   .0009488    65.70   0.000     .0604709    .0641911
       exper |   .0252895    .000743    34.04   0.000     .0238327    .0267462
      exper2 |   3.96e-06   .0000186     0.21   0.832    -.0000326    .0000405
       _cons |   6.794548   .0047692  1424.67   0.000     6.785198    6.803898
-------------+----------------------------------------------------------------
     sigma_u |  .30961595
     sigma_e |  .04549214
         rho |  .97886755   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4501) = 274.06                 Prob > F = 0.0000
r; t=0.02 21:37:15

. 
.                         xtreg lnwage educ exper exper2 i.year, fe       // complete model
note: 11.year omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9375                                         min =         10
     Between = 0.5431                                         avg =       10.1
     Overall = 0.5881                                         max =         11

                                                F(12,4492)        =    5611.14
corr(u_i, Xb) = 0.1898                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0623007   .0009527    65.40   0.000      .060433    .0641685
       exper |   .0252215   .0010239    24.63   0.000      .023214    .0272289
      exper2 |   2.16e-06   .0000191     0.11   0.910    -.0000353    .0000396
             |
        year |
          2  |   .0003418     .00284     0.12   0.904    -.0052259    .0059096
          3  |   .0008999   .0029667     0.30   0.762    -.0049163    .0067162
          4  |  -.0038063   .0032479    -1.17   0.241    -.0101738    .0025612
          5  |   .0004514   .0036446     0.12   0.901    -.0066939    .0075967
          6  |   .0016886   .0041206     0.41   0.682    -.0063897     .009767
          7  |  -.0003714   .0046521    -0.08   0.936    -.0094919     .008749
          8  |   .0013029   .0052223     0.25   0.803    -.0089353    .0115411
          9  |  -.0004192   .0058235    -0.07   0.943    -.0118361    .0109977
         10  |   .0016554   .0064479     0.26   0.797    -.0109857    .0142965
         11  |          0  (omitted)
             |
       _cons |   6.795963   .0085426   795.54   0.000     6.779215    6.812711
-------------+----------------------------------------------------------------
     sigma_u |  .30940374
     sigma_e |  .04551187
         rho |  .97882119   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4492) = 273.75                 Prob > F = 0.0000
r; t=0.03 21:37:15

.                                 est store FE
r; t=0.00 21:37:15

.                                 
.                 // # 3.2.3 HAUSMAN test
. 
.                         hausman FE RE

Note: the rank of the differenced variance matrix (11) does not equal the number of coefficients being tested (12); be sure this is
        what you expect, or there may be problems computing the test.  Examine the output of your estimators for anything
        unexpected and possibly consider scaling your variables so that the coefficients are on a similar scale.

                 ---- Coefficients ----
             |      (b)          (B)            (b-B)     sqrt(diag(V_b-V_B))
             |       FE           RE         Difference       Std. err.
-------------+----------------------------------------------------------------
        educ |    .0623007     .0664224       -.0041217         .000213
       exper |    .0252215     .0045625         .020659               .
      exper2 |    2.16e-06     2.74e-06       -5.83e-07               .
        year |
          2  |    .0003418     .0192164       -.0188746               .
          3  |    .0008999     .0385848       -.0376848               .
          4  |   -.0038063     .0526923       -.0564986               .
          5  |    .0004514     .0757218       -.0752704               .
          6  |    .0016886     .0955659       -.0938773               .
          7  |   -.0003714     .1120524       -.1124238               .
          8  |    .0013029     .1320914       -.1307885               .
          9  |   -.0004192      .148938       -.1493572               .
         10  |    .0016554     .1696252       -.1679698               .
------------------------------------------------------------------------------
                          b = Consistent under H0 and Ha; obtained from xtreg.
           B = Inconsistent under Ha, efficient under H0; obtained from xtreg.

Test of H0: Difference in coefficients not systematic

   chi2(11) = (b-B)'[(V_b-V_B)^(-1)](b-B)
            = 304.97
Prob > chi2 = 0.0000
(V_b-V_B is not positive definite)
r; t=0.00 21:37:15

. 
.         // # 3.3 IV: cross-section
. 
.                 preserve
r; t=0.00 21:37:15

.                         bysort workerid (year): keep if _n==1           // cross-section
(4,504 observations deleted)
r; t=0.00 21:37:15

.                         
.                         xi: ivreg2 lnwage (educ = q1) exper exper2 i.year, first
i.year            _Iyear_1-1          (naturally coded; _Iyear_1 omitted)

First-stage regressions
-----------------------


First-stage regression of educ:

Statistics consistent for homoskedasticity only
Number of obs =                    495
------------------------------------------------------------------------------
        educ | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
          q1 |  -1.925479   .3248022    -5.93   0.000    -2.563652   -1.287305
       exper |  -.1254006   .0924319    -1.36   0.176    -.3070114    .0562103
      exper2 |   .0061944   .0047033     1.32   0.188    -.0030468    .0154355
       _cons |   4.023993    .391794    10.27   0.000     3.254194    4.793793
------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   491) =    35.14
  Prob > F      =   0.0000
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   491) =    35.14
  Prob > F      =   0.0000



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   491)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   491)
educ         |      35.14    0.0000 |       35.43   0.0000 |       35.14

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Sanderson-Windmeijer F statistic.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Anderson canon. corr. LM statistic       Chi-sq(1)=33.06    P-val=0.0000

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                      35.14

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,491)=       5.35     P-val=0.0211
Anderson-Rubin Wald test           Chi-sq(1)=      5.39     P-val=0.0202
Stock-Wright LM S statistic        Chi-sq(1)=      5.34     P-val=0.0209

Number of observations               N  =        495
Number of regressors                 K  =          4
Number of endogenous regressors      K1 =          1
Number of instruments                L  =          4
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics consistent for homoskedasticity only

                                                      Number of obs =      495
                                                      F(  3,   491) =     4.59
                                                      Prob > F      =   0.0035
Total (centered) SS     =  94.46239836                Centered R2   =   0.5187
Total (uncentered) SS   =  26033.74243                Uncentered R2 =   0.9983
Residual SS             =  45.46376833                Root MSE      =    .3031

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0550889   .0165682     3.32   0.001     .0226158     .087562
       exper |   .0149673   .0092318     1.62   0.105    -.0031267    .0330613
      exper2 |  -.0005777   .0004694    -1.23   0.218    -.0014976    .0003423
       _cons |   6.994305   .0687991   101.66   0.000     6.859462    7.129149
------------------------------------------------------------------------------
Underidentification test (Anderson canon. corr. LM statistic):          33.063
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):               35.143
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
------------------------------------------------------------------------------
Sargan statistic (overidentification test of all instruments):           0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         educ
Included instruments: exper exper2
Excluded instruments: q1
------------------------------------------------------------------------------
r; t=0.24 21:37:15

.                                 est store IV
r; t=0.00 21:37:15

.                 restore
r; t=0.00 21:37:15

. 
.         // # 3.4 PANEL + IV
. 
.                 // DISCUSS why education is dropped in the following regression
. 
.                 xtivreg lnwage (educ=q1) exper exper2 i.year, fe

Fixed-effects (within) IV regression            Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.8779                                         min =         10
     Between = 0.0023                                         avg =       10.1
     Overall = 0.0370                                         max =         11

                                                Wald chi2(11)     =   6.94e+07
corr(u_i, Xb) = -0.5041                         Prob > chi2       =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |          0  (omitted)
       exper |    .056961   .0012595    45.22   0.000     .0544923    .0594296
      exper2 |   -.000029   .0000267    -1.09   0.277    -.0000812    .0000233
             |
        year |
          2  |  -.0039643   .0039664    -1.00   0.318    -.0117382    .0038097
          3  |  -.0066957   .0041413    -1.62   0.106    -.0148126    .0014211
          4  |  -.0146991   .0045313    -3.24   0.001    -.0235803   -.0058179
          5  |  -.0130612   .0050833    -2.57   0.010    -.0230244   -.0030981
          6  |  -.0119044   .0057491    -2.07   0.038    -.0231724   -.0006364
          7  |  -.0130892   .0064933    -2.02   0.044    -.0258159   -.0003625
          8  |  -.0077464   .0072929    -1.06   0.288    -.0220402    .0065475
          9  |  -.0088378   .0081334    -1.09   0.277     -.024779    .0071034
         10  |  -.0067529    .009006    -0.75   0.453    -.0244042    .0108985
         11  |          0  (omitted)
             |
       _cons |   6.683668   .0116903   571.73   0.000     6.660756    6.706581
-------------+----------------------------------------------------------------
     sigma_u |  .53894948
     sigma_e |  .06357994
         rho |  .98627407   (fraction of variance due to u_i)
------------------------------------------------------------------------------
 F test that all u_i=0: F(494,4493) =   137.89            Prob > F    = 0.0000
------------------------------------------------------------------------------
Instrumented: educ
 Instruments: exper exper2 2.year 3.year 4.year 5.year 6.year 7.year 8.year
              9.year 10.year 11.year q1
r; t=0.15 21:37:15

.                         est store FE_IV
r; t=0.00 21:37:15

.                         
.                 // COMPARE 'ivreg2' & 'xtivreg2, re' results
. 
.                 xtivreg lnwage (educ=q1) exper exper2 i.year, re

G2SLS random-effects IV regression              Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9369                                         min =         10
     Between = 0.7198                                         avg =       10.1
     Overall = 0.6889                                         max =         11

                                                Wald chi2(13)     =   57429.67
corr(u_i, X) = 0 (assumed)                      Prob > chi2       =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0562058   .0094581     5.94   0.000     .0376683    .0747434
       exper |   .0045405   .0018406     2.47   0.014     .0009329     .008148
      exper2 |  -2.50e-06   .0000205    -0.12   0.903    -.0000427    .0000377
             |
        year |
          2  |   .0237399    .005463     4.35   0.000     .0130327    .0344472
          3  |   .0477989   .0097145     4.92   0.000     .0287588    .0668389
          4  |   .0665959   .0142386     4.68   0.000     .0386887    .0945031
          5  |   .0944263   .0189336     4.99   0.000     .0573171    .1315356
          6  |    .119488   .0240162     4.98   0.000     .0724171    .1665588
          7  |    .141349   .0292521     4.83   0.000      .084016     .198682
          8  |   .1672209   .0348943     4.79   0.000     .0988294    .2356125
          9  |   .1894025   .0401148     4.72   0.000      .110779     .268026
         10  |   .2153233   .0452517     4.76   0.000     .1266316     .304015
         11  |   .2385992   .0520585     4.58   0.000     .1365665    .3406319
             |
       _cons |   7.018463   .0366596   191.45   0.000     6.946611    7.090314
-------------+----------------------------------------------------------------
     sigma_u |  .30009579
     sigma_e |  .06360118
         rho |  .95701383   (fraction of variance due to u_i)
------------------------------------------------------------------------------
Instrumented: educ
 Instruments: exper exper2 2.year 3.year 4.year 5.year 6.year 7.year 8.year
              9.year 10.year 11.year q1
r; t=0.06 21:37:15

.                         est store RE_IV
r; t=0.00 21:37:15

. 
.                 // DISCUSS the underlying problems with this exercise
. 
. 
. // # 4. HETEROSKEDASDICITY & SERIAL CORRELATION
. 
.         // # 4.1. test for heteroskedasticity within panel data
. 
.                 // optimal solution proposed by Greene, Econometric Analysis
. 
.                         xtreg lnwage educ exper exper2 i.year, fe
note: 11.year omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9375                                         min =         10
     Between = 0.5431                                         avg =       10.1
     Overall = 0.5881                                         max =         11

                                                F(12,4492)        =    5611.14
corr(u_i, Xb) = 0.1898                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0623007   .0009527    65.40   0.000      .060433    .0641685
       exper |   .0252215   .0010239    24.63   0.000      .023214    .0272289
      exper2 |   2.16e-06   .0000191     0.11   0.910    -.0000353    .0000396
             |
        year |
          2  |   .0003418     .00284     0.12   0.904    -.0052259    .0059096
          3  |   .0008999   .0029667     0.30   0.762    -.0049163    .0067162
          4  |  -.0038063   .0032479    -1.17   0.241    -.0101738    .0025612
          5  |   .0004514   .0036446     0.12   0.901    -.0066939    .0075967
          6  |   .0016886   .0041206     0.41   0.682    -.0063897     .009767
          7  |  -.0003714   .0046521    -0.08   0.936    -.0094919     .008749
          8  |   .0013029   .0052223     0.25   0.803    -.0089353    .0115411
          9  |  -.0004192   .0058235    -0.07   0.943    -.0118361    .0109977
         10  |   .0016554   .0064479     0.26   0.797    -.0109857    .0142965
         11  |          0  (omitted)
             |
       _cons |   6.795963   .0085426   795.54   0.000     6.779215    6.812711
-------------+----------------------------------------------------------------
     sigma_u |  .30940374
     sigma_e |  .04551187
         rho |  .97882119   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4492) = 273.75                 Prob > F = 0.0000
r; t=0.01 21:37:15

.                                 xttest3

Modified Wald test for groupwise heteroskedasticity
in fixed effect regression model

H0: sigma(i)^2 = sigma^2 for all i

chi2 (495)  =   1459.82
Prob>chi2 =      0.0000

r; t=0.00 21:37:15

. 
.         // # 4.2. test for serial correlation within panel data
. 
.                 tab year, gen(yy)

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495        9.90        9.90
          2 |        495        9.90       19.80
          3 |        495        9.90       29.71
          4 |        495        9.90       39.61
          5 |        495        9.90       49.51
          6 |        495        9.90       59.41
          7 |        495        9.90       69.31
          8 |        495        9.90       79.22
          9 |        495        9.90       89.12
         10 |        495        9.90       99.02
         11 |         49        0.98      100.00
------------+-----------------------------------
      Total |      4,999      100.00
r; t=0.00 21:37:15

.                         ret li

scalars:
                  r(N) =  4999
                  r(r) =  11
r; t=0.00 21:37:15

. 
.                 xtserial lnwage educ exper exper2 yy2-yy11

Wooldridge test for autocorrelation in panel data
H0: no first-order autocorrelation
    F(  1,     494) =      0.432
           Prob > F =      0.5113
r; t=0.01 21:37:15

.                         
.                         xtreg lnwage educ exper exper2 i.year, fe cluster(workerid)
note: 11.year omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9375                                         min =         10
     Between = 0.5431                                         avg =       10.1
     Overall = 0.5881                                         max =         11

                                                F(12,494)         =    5616.45
corr(u_i, Xb) = 0.1898                          Prob > F          =     0.0000

                             (Std. err. adjusted for 495 clusters in workerid)
------------------------------------------------------------------------------
             |               Robust
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0623007   .0009518    65.45   0.000     .0604306    .0641708
       exper |   .0252215   .0010315    24.45   0.000     .0231949     .027248
      exper2 |   2.16e-06   .0000196     0.11   0.912    -.0000364    .0000407
             |
        year |
          2  |   .0003418   .0027746     0.12   0.902    -.0051097    .0057934
          3  |   .0008999   .0027679     0.33   0.745    -.0045383    .0063382
          4  |  -.0038063   .0032359    -1.18   0.240    -.0101642    .0025516
          5  |   .0004514   .0033295     0.14   0.892    -.0060903    .0069931
          6  |   .0016886   .0038981     0.43   0.665    -.0059703    .0093476
          7  |  -.0003714   .0043083    -0.09   0.931    -.0088363    .0080934
          8  |   .0013029   .0049943     0.26   0.794    -.0085099    .0111156
          9  |  -.0004192   .0055793    -0.08   0.940    -.0113813    .0105429
         10  |   .0016554   .0060444     0.27   0.784    -.0102204    .0135312
         11  |          0  (omitted)
             |
       _cons |   6.795963   .0084019   808.86   0.000     6.779455    6.812471
-------------+----------------------------------------------------------------
     sigma_u |  .30940374
     sigma_e |  .04551187
         rho |  .97882119   (fraction of variance due to u_i)
------------------------------------------------------------------------------
r; t=0.02 21:37:15

. 
.                 // following this sequence of tests you can also test for cross-sectional
.                 // correlation in fixed effects model
.                 
.                 xtdes

workerid:  1, 2, ..., 495                                    n =        495
    year:  1, 2, ..., 11                                     T =         11
           Delta(year) = 1 unit
           Span(year)  = 11 periods
           (workerid*year uniquely identifies each observation)

Distribution of T_i:   min      5%     25%       50%       75%     95%     max
                        10      10      10        10        10      11      11

     Freq.  Percent    Cum. |  Pattern
 ---------------------------+-------------
      446     90.10   90.10 |  1111111111.
       49      9.90  100.00 |  11111111111
 ---------------------------+-------------
      495    100.00         |  XXXXXXXXXXX
r; t=0.01 21:37:15

.                 
.                 
.                 // the following solution would issue an error message in the original data as there 
.                 // are too many cross-section units ==> build a small ramdom sample
. 
.                         preserve
r; t=0.00 21:37:15

.                                 set seed 234
r; t=0.00 21:37:15

.                                 sample2 1,cluster(workerid)
(4,949 observations deleted)
r; t=0.00 21:37:15

.                                 xtreg lnwage educ exper exper2 i.year, fe
note: 10.year omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =         50
Group variable: workerid                        Number of groups  =          5

R-squared:                                      Obs per group:
     Within  = 0.9631                                         min =         10
     Between = 0.7783                                         avg =       10.0
     Overall = 0.7813                                         max =         10

                                                F(11,34)          =      80.72
corr(u_i, Xb) = 0.4439                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0645531   .0137589     4.69   0.000     .0365917    .0925145
       exper |   .0166479   .0123028     1.35   0.185    -.0083543    .0416501
      exper2 |   .0001863   .0002777     0.67   0.507    -.0003781    .0007507
             |
        year |
          2  |    .002368   .0259857     0.09   0.928    -.0504414    .0551774
          3  |   .0164184   .0256101     0.64   0.526    -.0356276    .0684643
          4  |   .0220129   .0241706     0.91   0.369    -.0271077    .0711335
          5  |  -.0244237   .0239147    -1.02   0.314    -.0730243     .024177
          6  |  -.0310858   .0240097    -1.29   0.204    -.0798793    .0177077
          7  |   .0271069    .024192     1.12   0.270    -.0220572    .0762709
          8  |  -.0097394    .024749    -0.39   0.696    -.0600355    .0405566
          9  |   .0031325   .0256451     0.12   0.904    -.0489846    .0552496
         10  |          0  (omitted)
             |
       _cons |    6.90132   .1026113    67.26   0.000     6.692788    7.109851
-------------+----------------------------------------------------------------
     sigma_u |  .31394578
     sigma_e |  .04238479
         rho |  .98209946   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(4, 34) = 392.99                     Prob > F = 0.0000
r; t=0.01 21:37:15

.                                         xttest2
 
Correlation matrix of residuals:

         __e133   __e188   __e283   __e396   __e494
__e133   1.0000
__e188  -0.2136   1.0000
__e283  -0.2821   0.1818   1.0000
__e396   0.4345  -0.6385  -0.5044   1.0000
__e494  -0.6423  -0.2824  -0.1207  -0.3154   1.0000

Breusch-Pagan LM test of independence: chi2(10) =    16.155, Pr = 0.0953
Based on 10 complete observations over panel units
r; t=0.01 21:37:15

.                         restore
r; t=0.00 21:37:15

. 
.                 // you can also apply specification tests for error-component models
.                 // this is only relevant in case the Hausman test does not reject the validity of the RE model
. 
.                         xtreg lnwage educ exper exper2 year, re

Random-effects GLS regression                   Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9371                                         min =         10
     Between = 0.7206                                         avg =       10.1
     Overall = 0.7162                                         max =         11

                                                Wald chi2(4)      =   65664.84
corr(u_i, X) = 0 (assumed)                      Prob > chi2       =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0664212   .0009251    71.80   0.000     .0646081    .0682343
       exper |   .0045494   .0019413     2.34   0.019     .0007446    .0083542
      exper2 |   3.21e-06    .000019     0.17   0.866     -.000034    .0000405
        year |   .0187797   .0019365     9.70   0.000     .0149843    .0225751
       _cons |   6.966766    .020136   345.99   0.000     6.927301    7.006232
-------------+----------------------------------------------------------------
     sigma_u |  .23484863
     sigma_e |  .04549214
         rho |  .96383413   (fraction of variance due to u_i)
------------------------------------------------------------------------------
r; t=0.03 21:37:15

.                                 
.                                 xttest1

Tests for the error component model:

        lnwage[workerid,t] = Xb + u[workerid] + v[workerid,t]
           v[workerid,t] = lambda v[workerid,(t-1)] + e[workerid,t]

        Estimated results:
                         |       Var     sd = sqrt(Var)
                ---------+-----------------------------
                  lnwage |   .2280508       .4775467
                       e |   .0020695      .04549214
                       u |   .0551539      .23484863

        Tests:
           Random Effects, Two Sided:
           ALM(Var(u)=0)         =15298.72 Pr>chi2(1) =  0.0000

           Random Effects, One Sided:
           ALM(Var(u)=0)         =  123.69 Pr>N(0,1)  =  0.0000

           Serial Correlation:
           ALM(lambda=0)         =   75.50 Pr>chi2(1) =  0.0000

           Joint Test:
           LM(Var(u)=0,lambda=0) =20358.11 Pr>chi2(2) =  0.0000

r; t=0.02 21:37:15

. 
.                 // CONCLUSION: the above results lead us to conclude that we reject the base hypothesis
.                 // of the FE model that we have homoskedasticy & no serial correlation in the error term
. 
.                 // the cluster-robust standard errors allow for heteroscedasticity and serial correlation
.                 // correct solution would be
. 
. 
.         // # 4.3. SUGGESTED MODEL
. 
.                 xtreg lnwage educ exper exper2 i.year, fe cluster(workerid)
note: 11.year omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9375                                         min =         10
     Between = 0.5431                                         avg =       10.1
     Overall = 0.5881                                         max =         11

                                                F(12,494)         =    5616.45
corr(u_i, Xb) = 0.1898                          Prob > F          =     0.0000

                             (Std. err. adjusted for 495 clusters in workerid)
------------------------------------------------------------------------------
             |               Robust
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .0623007   .0009518    65.45   0.000     .0604306    .0641708
       exper |   .0252215   .0010315    24.45   0.000     .0231949     .027248
      exper2 |   2.16e-06   .0000196     0.11   0.912    -.0000364    .0000407
             |
        year |
          2  |   .0003418   .0027746     0.12   0.902    -.0051097    .0057934
          3  |   .0008999   .0027679     0.33   0.745    -.0045383    .0063382
          4  |  -.0038063   .0032359    -1.18   0.240    -.0101642    .0025516
          5  |   .0004514   .0033295     0.14   0.892    -.0060903    .0069931
          6  |   .0016886   .0038981     0.43   0.665    -.0059703    .0093476
          7  |  -.0003714   .0043083    -0.09   0.931    -.0088363    .0080934
          8  |   .0013029   .0049943     0.26   0.794    -.0085099    .0111156
          9  |  -.0004192   .0055793    -0.08   0.940    -.0113813    .0105429
         10  |   .0016554   .0060444     0.27   0.784    -.0102204    .0135312
         11  |          0  (omitted)
             |
       _cons |   6.795963   .0084019   808.86   0.000     6.779455    6.812471
-------------+----------------------------------------------------------------
     sigma_u |  .30940374
     sigma_e |  .04551187
         rho |  .97882119   (fraction of variance due to u_i)
------------------------------------------------------------------------------
r; t=0.02 21:37:15

.                         est store FE_cluster
r; t=0.00 21:37:15

. 
.                                 test educ

 ( 1)  educ = 0

       F(  1,   494) = 4284.33
            Prob > F =    0.0000
r; t=0.00 21:37:15

.                                 test exper exper2

 ( 1)  exper = 0
 ( 2)  exper2 = 0

       F(  2,   494) =  472.74
            Prob > F =    0.0000
r; t=0.00 21:37:15

.                                 estat ic

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |          N   ll(null)  ll(model)      df        AIC        BIC
-------------+---------------------------------------------------------------
  FE_cluster |      4,999   1691.371   8619.843      12  -17215.69  -17137.48
-----------------------------------------------------------------------------
Note: BIC uses N = number of observations. See [R] BIC note.
r; t=0.00 21:37:15

. 
. 
. // # 5. GOODNESS-OF-FIT measures
. 
.         egen meduc = mean(educ),by(workerid)
r; t=0.00 21:37:15

.         gen deduc = educ - meduc
r; t=0.00 21:37:15

.         egen mlnwage = mean(lnwage),by(workerid)
r; t=0.00 21:37:15

.         gen dlnwage = lnwage - mlnwage
r; t=0.00 21:37:15

. 
.                 xtreg lnwage educ, fe

Fixed-effects (within) regression               Number of obs     =      4,999
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9029                                         min =         10
     Between = 0.7164                                         avg =       10.1
     Overall = 0.7407                                         max =         11

                                                F(1,4503)         =   41895.06
corr(u_i, Xb) = 0.0497                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .1048638   .0005123   204.68   0.000     .1038594    .1058682
       _cons |    6.93556    .002812  2466.37   0.000     6.930047    6.941073
-------------+----------------------------------------------------------------
     sigma_u |  .23772986
     sigma_e |  .05662582
         rho |  .94630982   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 4503) = 177.46                 Prob > F = 0.0000
r; t=0.01 21:37:15

.                 
.                 ereturn list

scalars:
               e(r2_w) =  .9029485352215441
                e(F_f) =  177.4563746022165
               e(rank) =  2
               e(Tbar) =  10.0989898989899
               e(Tcon) =  0
              e(g_min) =  10
              e(g_avg) =  10.0989898989899
              e(g_max) =  11
                e(N_g) =  495
            e(sigma_u) =  .2377298624085747
               e(corr) =  .0496615895591422
               e(r2_o) =  .7407170684750654
               e(r2_b) =  .716424306282808
            e(sigma_e) =  .056625816852684
              e(sigma) =  .2443807901923422
                e(rho) =  .9463098236509536
                  e(p) =  0
                e(p_f) =  0
               e(df_m) =  495
               e(df_b) =  1
               e(ll_0) =  1691.370776945239
                 e(ll) =  7521.489211137272
                e(tss) =  1139.797990921046
               e(df_a) =  494
               e(r2_a) =  .8922799864617538
                e(rss) =  14.43879355345441
                e(mss) =  134.3358136759629
               e(rmse) =  .056625816852684
                 e(r2) =  .9029485352215441
                  e(F) =  41895.06323664682
               e(df_r) =  4503
                  e(N) =  4999

macros:
            e(cmdline) : "xtreg lnwage educ, fe"
                e(cmd) : "xtreg"
       e(marginsnotok) : "E U UE SCore STDP XBU"
            e(predict) : "xtrefe_p"
              e(model) : "fe"
                e(vce) : "conventional"
               e(ivar) : "workerid"
             e(depvar) : "lnwage"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 2
                  e(V) :  2 x 2

functions:
             e(sample)   
r; t=0.00 21:37:15

.                         display "RMSE:  " e(rmse)
RMSE:  .05662582
r; t=0.00 21:37:15

.                         
.                 estat ic

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |          N   ll(null)  ll(model)      df        AIC        BIC
-------------+---------------------------------------------------------------
           . |      4,999   1691.371   7521.489       2  -15038.98  -15025.94
-----------------------------------------------------------------------------
Note: BIC uses N = number of observations. See [R] BIC note.
r; t=0.00 21:37:15

.                         
.                 // R sq, within
.                         reg dlnwage deduc

      Source |       SS           df       MS      Number of obs   =     4,999
-------------+----------------------------------   F(1, 4997)      =  46491.15
       Model |  134.335814         1  134.335814   Prob > F        =    0.0000
    Residual |  14.4387936     4,997  .002889492   R-squared       =    0.9029
-------------+----------------------------------   Adj R-squared   =    0.9029
       Total |  148.774607     4,998  .029766828   Root MSE        =    .05375

------------------------------------------------------------------------------
     dlnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       deduc |   .1048638   .0004863   215.62   0.000     .1039104    .1058172
       _cons |  -2.56e-09   .0007603    -0.00   1.000    -.0014905    .0014905
------------------------------------------------------------------------------
r; t=0.00 21:37:15

. 
.                 // R sq, between
.                         preserve
r; t=0.00 21:37:15

.                                 collapse (mean) lnwage educ,by(workerid)
r; t=0.00 21:37:15

.                                 reg lnwage educ

      Source |       SS           df       MS      Number of obs   =       495
-------------+----------------------------------   F(1, 493)       =   1245.51
       Model |  70.3293181         1  70.3293181   Prob > F        =    0.0000
    Residual |  27.8378123       493  .056466151   R-squared       =    0.7164
-------------+----------------------------------   Adj R-squared   =    0.7158
       Total |  98.1671304       494  .198718887   Root MSE        =    .23763

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .1085438   .0030756    35.29   0.000     .1025009    .1145867
       _cons |      6.916   .0193648   357.14   0.000     6.877952    6.954048
------------------------------------------------------------------------------
r; t=0.00 21:37:15

.                         restore
r; t=0.00 21:37:15

. 
.                 // R sq, overall
.                         reg lnwage educ

      Source |       SS           df       MS      Number of obs   =     4,999
-------------+----------------------------------   F(1, 4997)      =  14275.38
       Model |  844.267826         1  844.267826   Prob > F        =    0.0000
    Residual |  295.530164     4,997  .059141518   R-squared       =    0.7407
-------------+----------------------------------   Adj R-squared   =    0.7407
       Total |  1139.79799     4,998  .228050819   Root MSE        =    .24319

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .1079613   .0009036   119.48   0.000     .1061898    .1097327
       _cons |   6.919262    .005868  1179.15   0.000     6.907758    6.930766
------------------------------------------------------------------------------
r; t=0.00 21:37:15

.                                 predict y_hat_ols
(option xb assumed; fitted values)
r; t=0.00 21:37:15

.                                         correlate lnwage y_hat_ols
(obs=4,999)

             |   lnwage y_hat_~s
-------------+------------------
      lnwage |   1.0000
   y_hat_ols |   0.8606   1.0000

r; t=0.00 21:37:15

.                                         ret li

scalars:
                  r(N) =  4999
                r(rho) =  .8606492083329131

matrices:
                  r(C) :  2 x 2
r; t=0.00 21:37:15

.                                         di r(rho)^2
.74071706
r; t=0.00 21:37:15

. 
.                         estimates restore FE
(results FE are active now)
r; t=0.00 21:37:15

.                                 predict y_hat_fe
(option xb assumed; fitted values)
r; t=0.00 21:37:15

.                                         correlate lnwage y_hat_fe
(obs=4,999)

             |   lnwage y_hat_fe
-------------+------------------
      lnwage |   1.0000
    y_hat_fe |   0.7669   1.0000

r; t=0.00 21:37:15

.                                         ret li

scalars:
                  r(N) =  4999
                r(rho) =  .7669002377253136

matrices:
                  r(C) :  2 x 2
r; t=0.00 21:37:15

.                                         di r(rho)^2
.58813597
r; t=0.00 21:37:15

. 
. 
. // # 6. OUTPUT EXPORT
. 
.                 estimates dir

-------------------------------------------------------------------
             |           Dependent  Number of        
        Name | Command    variable     param.  Title 
-------------+-----------------------------------------------------
         OLS | regress      lnwage         15  Linear regression
          RE | xtreg        lnwage         15  
          FE | xtreg        lnwage         15  
          IV | ivreg2       lnwage          4  IV (2SLS) estimation
       FE_IV | xtivreg      lnwage         15  
       RE_IV | xtivreg      lnwage         15  
  FE_cluster | xtreg        lnwage         15  
-------------------------------------------------------------------
r; t=0.00 21:37:15

.                 est stats OLS RE FE IV FE_IV RE_IV FE_cluster

Akaike's information criterion and Bayesian information criterion

-----------------------------------------------------------------------------
       Model |          N   ll(null)  ll(model)      df        AIC        BIC
-------------+---------------------------------------------------------------
         OLS |      4,999  -3398.046   28.09701      14  -28.19403   63.04387
          RE |      4,999          .          .      14          .          .
          FE |      4,999   1691.371   8619.843      13  -17213.69  -17128.97
          IV |        495          .  -111.4332       4   230.8663   247.6846
       FE_IV |      4,999          .          .      12          .          .
       RE_IV |      4,999          .          .      14          .          .
  FE_cluster |      4,999   1691.371   8619.843      12  -17215.69  -17137.48
-----------------------------------------------------------------------------
Note: BIC uses N = number of observations. See [R] BIC note.
r; t=0.00 21:37:15

. 
.                         estimates table OLS RE FE IV FE_IV RE_IV FE_cluster, keep(educ exper exper2) ///
>                                 b(%7.4f) se(%7.4f) stats(N r2_a)

--------------------------------------------------------------------------------------------------
    Variable |    OLS         RE          FE          IV         FE_IV       RE_IV     FE_clus~r  
-------------+------------------------------------------------------------------------------------
        educ |    0.1071      0.0664      0.0623      0.0551   (omitted)      0.0562      0.0623  
             |    0.0010      0.0009      0.0010      0.0166                  0.0095      0.0010  
       exper |    0.0133      0.0046      0.0252      0.0150      0.0570      0.0045      0.0252  
             |    0.0022      0.0019      0.0010      0.0092      0.0013      0.0018      0.0010  
      exper2 |   -0.0003      0.0000      0.0000     -0.0006     -0.0000     -0.0000      0.0000  
             |    0.0001      0.0000      0.0000      0.0005      0.0000      0.0000      0.0000  
-------------+------------------------------------------------------------------------------------
           N |      4999        4999        4999         495        4999        4999        4999  
        r2_a |    0.7454                  0.9304      0.5158                              0.9373  
--------------------------------------------------------------------------------------------------
                                                                                      Legend: b/se
r; t=0.02 21:37:15

. 
.                         estimates table OLS RE FE IV FE_IV RE_IV FE_cluster, keep(educ exper exper2) ///
>                                 b(%7.4f) star stats(N r2_a)

-----------------------------------------------------------------------------------------------------------------------
    Variable |     OLS             RE             FE             IV           FE_IV          RE_IV        FE_cluster   
-------------+---------------------------------------------------------------------------------------------------------
        educ |    0.1071***      0.0664***      0.0623***      0.0551***   (omitted)         0.0562***      0.0623***  
       exper |    0.0133***      0.0046*        0.0252***      0.0150         0.0570***      0.0045*        0.0252***  
      exper2 |   -0.0003***      0.0000         0.0000        -0.0006        -0.0000        -0.0000         0.0000     
-------------+---------------------------------------------------------------------------------------------------------
           N |      4999           4999           4999            495           4999           4999           4999     
        r2_a |    0.7454                        0.9304         0.5158                                       0.9373     
-----------------------------------------------------------------------------------------------------------------------
                                                                               Legend: * p<0.05; ** p<0.01; *** p<0.001
r; t=0.02 21:37:15

.                         
.         outreg, clear
r; t=0.06 21:37:15

.                 
.                 estimates restore OLS
(results OLS are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag replace ///
>                                 rtitles("Education" \ "" \ "Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(educ exper exper2) ///
>                                 ctitle("","OLS") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")

                                                     -------------------------
                                                                     OLS     
                                                     -------------------------
                                                      Education   0.1071***  
                                                                   (0.0010)  
                                                      Exper       0.0133***  
                                                                   (0.0022)  
                                                      Exper2      -0.0003*** 
                                                                   (0.0001)  
                                                      R2             0.75    
                                                      RMSE           0.24    
                                                      N             4,999    
                                                     -------------------------
                                                  * p<0.1; ** p<0.05; *** p<0.01

r; t=0.02 21:37:15

. 
.                 estimates restore RE
(results RE are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag merge ///
>                                 rtitles("Education" \ "" \ "Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(educ exper exper2) ///
>                                 ctitle("","RE") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 nodisplay summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")
r; t=0.00 21:37:15

. 
.                 estimates restore FE
(results FE are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag merge ///
>                                 rtitles("Education" \ "" \ "Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(educ exper exper2) ///
>                                 ctitle("","FE") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 nodisplay summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")
r; t=0.00 21:37:15

. 
.                 estimates restore IV
(results IV are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag merge ///
>                                 rtitles("Education" \ "" \ "Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(educ exper exper2) ///
>                                 ctitle("","IV") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 nodisplay summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")
r; t=0.00 21:37:15

. 
.                 estimates restore FE_IV
(results FE_IV are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag merge ///
>                                 rtitles("Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(exper exper2) ///
>                                 ctitle("","FE_IV") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 nodisplay summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")
r; t=0.00 21:37:15

. 
.                 estimates restore RE_IV
(results RE_IV are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag merge ///
>                                 rtitles("Education" \ "" \ "Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(educ exper exper2) ///
>                                 ctitle("","RE_IV") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 nodisplay summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")
r; t=0.00 21:37:15

. 
.                 estimates restore FE_cluster
(results FE_cluster are active now)
r; t=0.00 21:37:15

.                         outreg using ../tex_paper/regression_analysis, tex frag merge ///
>                                 rtitles("Education" \ "" \ "Exper" \ "" \ "Exper2" \ "")  ///
>                                 keep(educ exper exper2) ///
>                                 ctitle("","FE_cluster") ///
>                                 bdec(4) se starlevels(10 5 1) starloc(1) ///
>                                 summstat(r2\rmse \ N) summtitle("R2"\"RMSE" \ "N")

                   --------------------------------------------------------------------------------------------
                                   OLS         RE         FE         IV        FE_IV      RE_IV    FE_cluster 
                   --------------------------------------------------------------------------------------------
                    Education   0.1071***   0.0664***  0.0623***  0.0551***             0.0562***  0.0623***  
                                 (0.0010)   (0.0009)   (0.0010)   (0.0166)              (0.0095)    (0.0010)  
                    Exper       0.0133***   0.0046**   0.0252***   0.0150    0.0570***  0.0045**   0.0252***  
                                 (0.0022)   (0.0019)   (0.0010)   (0.0092)   (0.0013)   (0.0018)    (0.0010)  
                    Exper2      -0.0003***   0.0000     0.0000     -0.0006    -0.0000    -0.0000     0.0000   
                                 (0.0001)   (0.0000)   (0.0000)   (0.0005)   (0.0000)   (0.0000)    (0.0000)  
                    R2             0.75         .        0.94       0.52         .          .         0.94    
                    RMSE           0.24       0.05       0.05       0.30         .          .         0.04    
                    N             4,999       4,999      4,999       495       4,999      4,999      4,999    
                   --------------------------------------------------------------------------------------------
                                                  * p<0.1; ** p<0.05; *** p<0.01

r; t=0.00 21:37:15

. 
. 
. // # 7. DYNAMIC PANEL DATA
. 
.         use ../data/data_simulation, clear
r; t=0.00 21:37:15

. 
.                 tab year, ge(yy)

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495        9.90        9.90
          2 |        495        9.90       19.80
          3 |        495        9.90       29.71
          4 |        495        9.90       39.61
          5 |        495        9.90       49.51
          6 |        495        9.90       59.41
          7 |        495        9.90       69.31
          8 |        495        9.90       79.22
          9 |        495        9.90       89.12
         10 |        495        9.90       99.02
         11 |         49        0.98      100.00
------------+-----------------------------------
      Total |      4,999      100.00
r; t=0.00 21:37:15

. 
.                 // # 7.1. estimate OLS & FE benchmark models
. 
.                                 reg lnwage l.lnwage educ exper exper2 yy3-yy10, cluster(workerid)

Linear regression                               Number of obs     =      4,504
                                                F(12, 494)        =   37946.23
                                                Prob > F          =     0.0000
                                                R-squared         =     0.9786
                                                Root MSE          =     .06947

                             (Std. err. adjusted for 495 clusters in workerid)
------------------------------------------------------------------------------
             |               Robust
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9392126   .0037982   247.28   0.000       .93175    .9466751
             |
        educ |   .0080006   .0004727    16.93   0.000     .0070719    .0089294
       exper |   .0011293    .000507     2.23   0.026     .0001332    .0021254
      exper2 |  -.0000289    .000017    -1.70   0.090    -.0000622    4.48e-06
         yy3 |    .001024   .0050166     0.20   0.838    -.0088325    .0108805
         yy4 |  -.0050206   .0040312    -1.25   0.214    -.0129411    .0028999
         yy5 |   .0035026   .0043177     0.81   0.418    -.0049807     .011986
         yy6 |   .0022258   .0040939     0.54   0.587    -.0058178    .0102694
         yy7 |  -.0010015    .004268    -0.23   0.815    -.0093871    .0073841
         yy8 |   .0042017    .004067     1.03   0.302    -.0037891    .0121924
         yy9 |   -.002708    .004264    -0.64   0.526    -.0110858    .0056699
        yy10 |  -.0002563   .0043158    -0.06   0.953    -.0087359    .0082233
       _cons |   .4553338    .025822    17.63   0.000     .4045994    .5060683
------------------------------------------------------------------------------
r; t=0.00 21:37:15

.                                         est store ols
r; t=0.00 21:37:15

. 
.                                 xtreg lnwage l.lnwage educ exper exper2 yy3-yy10, fe cluster(workerid)

Fixed-effects (within) regression               Number of obs     =      4,504
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9266                                         min =          9
     Between = 0.4446                                         avg =        9.1
     Overall = 0.4961                                         max =         10

                                                F(12,494)         =    4016.28
corr(u_i, Xb) = 0.1082                          Prob > F          =     0.0000

                             (Std. err. adjusted for 495 clusters in workerid)
------------------------------------------------------------------------------
             |               Robust
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |  -.0793845   .0135145    -5.87   0.000    -.1059375   -.0528315
             |
        educ |   .0664633   .0012464    53.32   0.000     .0640144    .0689122
       exper |   .0283031   .0012909    21.92   0.000     .0257668    .0308395
      exper2 |  -.0000191    .000024    -0.79   0.427    -.0000662    .0000281
         yy3 |   .0002633    .002736     0.10   0.923    -.0051123    .0056389
         yy4 |  -.0045975   .0029541    -1.56   0.120    -.0104017    .0012067
         yy5 |  -.0009161     .00315    -0.29   0.771    -.0071052     .005273
         yy6 |   .0003825    .003639     0.11   0.916    -.0067672    .0075323
         yy7 |  -.0016762   .0040819    -0.41   0.682    -.0096963    .0063439
         yy8 |  -.0003311   .0048396    -0.07   0.945    -.0098399    .0091777
         yy9 |  -.0016192   .0054876    -0.30   0.768    -.0124011    .0091628
        yy10 |    .000462   .0059706     0.08   0.938    -.0112689    .0121929
       _cons |   7.326065    .091593    79.98   0.000     7.146105    7.506025
-------------+----------------------------------------------------------------
     sigma_u |  .33608623
     sigma_e |   .0454614
         rho |  .98203159   (fraction of variance due to u_i)
------------------------------------------------------------------------------
r; t=0.02 21:37:16

.                                         est store fe
r; t=0.00 21:37:16

. 
.                 // # 7.2. GMM first-differences estimation, Arellano & Bond (1991)
. 
.                                 xtabond2 lnwage l.lnwage educ exper exper2 yy3-yy10, gmm(lnwage, lag(2 5)) gmm(educ, lag(2 5)) iv
> (i.year) ar(2) small noleveleq
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4009
Time variable : year                            Number of groups   =       495
Number of instruments = 69                      Obs per group: min =         8
F(0, 4009)    =         .                                      avg =      8.10
Prob > F      =         .                                      max =         9
------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .0090296   .0270984     0.33   0.739    -.0440983    .0621576
             |
        educ |    .072806   .0100987     7.21   0.000     .0530069     .092605
       exper |    .012849   .0079612     1.61   0.107    -.0027593    .0284573
      exper2 |   .0002225    .000177     1.26   0.209    -.0001245    .0005695
         yy3 |   .0027833   .0033152     0.84   0.401    -.0037163    .0092829
         yy4 |  -.0001373   .0042652    -0.03   0.974    -.0084995     .008225
         yy5 |   .0054098   .0052619     1.03   0.304    -.0049064     .015726
         yy6 |   .0069915    .006017     1.16   0.245    -.0048051    .0187881
         yy7 |   .0046894   .0066353     0.71   0.480    -.0083194    .0176983
         yy8 |   .0052422   .0071591     0.73   0.464    -.0087936     .019278
         yy9 |   .0024223   .0077313     0.31   0.754    -.0127353    .0175799
        yy10 |    .003132   .0084161     0.37   0.710    -.0133683    .0196323
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(1b.year 2.year 3.year 4.year 5.year 6.year 7.year 8.year 9.year 10.year
    11.year)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).educ
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -28.40  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -1.57  Pr > z =  0.117
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(57)   =  57.92  Prob > chi2 =  0.441
  (Not robust, but not weakened by many instruments.)

Difference-in-Sargan tests of exogeneity of instrument subsets:
  gmm(lnwage, lag(2 5))
    Sargan test excluding group:     chi2(27)   =  21.45  Prob > chi2 =  0.765
    Difference (null H = exogenous): chi2(30)   =  36.47  Prob > chi2 =  0.193
  gmm(educ, lag(2 5))
    Sargan test excluding group:     chi2(27)   =  32.34  Prob > chi2 =  0.220
    Difference (null H = exogenous): chi2(30)   =  25.58  Prob > chi2 =  0.696
  iv(1b.year 2.year 3.year 4.year 5.year 6.year 7.year 8.year 9.year 10.year 11.year)
    Sargan test excluding group:     chi2(48)   =  50.40  Prob > chi2 =  0.379
    Difference (null H = exogenous): chi2(9)    =   7.52  Prob > chi2 =  0.583

r; t=0.51 21:37:16

. 
.                                 xtabond2 lnwage l.lnwage educ exper exper2 yy3-yy10, gmm(lnwage, lag(2 5)) gmm(educ, lag(2 5)) iv
> (yy3-yy9) ar(2) small noleveleq
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4009
Time variable : year                            Number of groups   =       495
Number of instruments = 67                      Obs per group: min =         8
F(0, 4009)    =         .                                      avg =      8.10
Prob > F      =         .                                      max =         9
------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |    .007222   .0274869     0.26   0.793    -.0466676    .0611116
             |
        educ |   .0795978   .0114326     6.96   0.000     .0571836     .102012
       exper |  -.0039305   .0171019    -0.23   0.818    -.0374597    .0295988
      exper2 |   .0006691   .0004534     1.48   0.140    -.0002198     .001558
         yy3 |   .0064794   .0048157     1.35   0.179    -.0029621    .0159209
         yy4 |   .0063714   .0074614     0.85   0.393    -.0082572        .021
         yy5 |   .0137612   .0094634     1.45   0.146    -.0047924    .0323148
         yy6 |   .0160396    .010492     1.53   0.126    -.0045305    .0366097
         yy7 |   .0134427   .0107215     1.25   0.210    -.0075774    .0344628
         yy8 |   .0125053   .0101525     1.23   0.218    -.0073991    .0324098
         yy9 |   .0076517   .0094497     0.81   0.418     -.010875    .0261784
        yy10 |   .0054971   .0089336     0.62   0.538    -.0120177     .023012
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(yy3 yy4 yy5 yy6 yy7 yy8 yy9)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).educ
    L(2/5).lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -24.11  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.68  Pr > z =  0.498
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(55)   =  51.56  Prob > chi2 =  0.607
  (Not robust, but not weakened by many instruments.)

Difference-in-Sargan tests of exogeneity of instrument subsets:
  gmm(lnwage, lag(2 5))
    Sargan test excluding group:     chi2(25)   =  20.49  Prob > chi2 =  0.721
    Difference (null H = exogenous): chi2(30)   =  31.07  Prob > chi2 =  0.412
  gmm(educ, lag(2 5))
    Sargan test excluding group:     chi2(25)   =  29.64  Prob > chi2 =  0.238
    Difference (null H = exogenous): chi2(30)   =  21.91  Prob > chi2 =  0.857
  iv(yy3 yy4 yy5 yy6 yy7 yy8 yy9)
    Sargan test excluding group:     chi2(48)   =  49.26  Prob > chi2 =  0.423
    Difference (null H = exogenous): chi2(7)    =   2.30  Prob > chi2 =  0.941

r; t=0.43 21:37:16

.                                         est store fd
r; t=0.00 21:37:16

. 
. 
.                 // # 7.3. GMM system estimation, Arellano & Bover (1995), Blundell & Bond (1998)
. 
.                         // automatically insert timme dummies
.                                 xtabond2 lnwage l.lnwage educ exper exper2 i.year, gmm(lnwage, lag(2 .))
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
1b.year dropped due to collinearity
3.year dropped due to collinearity

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4504
Time variable : year                            Number of groups   =       495
Number of instruments = 55                      Obs per group: min =         9
Wald chi2(13) =  1.07e+08                                      avg =      9.10
Prob > chi2   =     0.000                                      max =        10
------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .1170073   .0264441     4.42   0.000     .0651777    .1688368
             |
        educ |   .0624477   .0022205    28.12   0.000     .0580956    .0667998
       exper |  -.0240692   .0104851    -2.30   0.022    -.0446197   -.0035187
      exper2 |   .0005513   .0003261     1.69   0.091    -.0000878    .0011903
             |
        year |
          2  |  -.0311392   .0047237    -6.59   0.000    -.0403975   -.0218809
          4  |   .0247489    .004352     5.69   0.000     .0162192    .0332787
          5  |   .0579399   .0063908     9.07   0.000     .0454142    .0704656
          6  |   .0857342   .0083642    10.25   0.000     .0693406    .1021278
          7  |   .1095345   .0100982    10.85   0.000     .0897424    .1293265
          8  |   .1358677   .0116127    11.70   0.000     .1131073     .158628
          9  |   .1569925   .0131462    11.94   0.000     .1312265    .1827585
         10  |   .1817416   .0147187    12.35   0.000     .1528936    .2105897
         11  |   .2236488   .0193921    11.53   0.000      .185641    .2616565
             |
       _cons |   6.430808   .2054126    31.31   0.000     6.028206    6.833409
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/10).lnwage
Instruments for levels equation
  Standard
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    DL.lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -20.51  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   1.01  Pr > z =  0.311
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(41)   = 361.06  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)

r; t=0.35 21:37:17

. 
.                         // manually insert timme dummies (created above with the command 'tab year, ge(yy)')
.                                 xtabond2 lnwage l.lnwage educ exper exper2 yy2-yy10, gmm(lnwage, lag(2 5)) gmm(educ exper exper2,
>  lag(2 5) collapse) iv(yy2-yy10, eq(level)) ar(2) twostep robust small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate optimal weighting matrix for two-step estimation.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, two-step system GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4504
Time variable : year                            Number of groups   =       495
Number of instruments = 63                      Obs per group: min =         9
F(13, 494)    =  36878.68                                      avg =      9.10
Prob > F      =     0.000                                      max =        10
------------------------------------------------------------------------------
             |              Corrected
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .0080908   .0293266     0.28   0.783    -.0495294     .065711
             |
        educ |    .070387   .0049527    14.21   0.000      .060656     .080118
       exper |   .0065919   .0020977     3.14   0.002     .0024703    .0107135
      exper2 |  -.0000331   .0000268    -1.24   0.217    -.0000858    .0000196
         yy2 |  -.1423929   .0305357    -4.66   0.000    -.2023888   -.0823971
         yy3 |   -.125249   .0280116    -4.47   0.000    -.1802855   -.0702124
         yy4 |  -.1146188   .0255659    -4.48   0.000    -.1648501   -.0643876
         yy5 |  -.0957305   .0228224    -4.19   0.000    -.1405714   -.0508896
         yy6 |  -.0789083   .0202056    -3.91   0.000    -.1186079   -.0392088
         yy7 |  -.0661068    .017962    -3.68   0.000    -.1013982   -.0308154
         yy8 |  -.0479846   .0158992    -3.02   0.003    -.0792229   -.0167462
         yy9 |  -.0358596   .0143638    -2.50   0.013    -.0640812    -.007638
        yy10 |   -.017671    .013198    -1.34   0.181    -.0436021    .0082601
       _cons |   7.054499    .216274    32.62   0.000     6.629568    7.479429
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(2/5).(educ exper exper2) collapsed
    L(2/5).lnwage
Instruments for levels equation
  Standard
    yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    DL.(educ exper exper2) collapsed
    DL.lnwage
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -15.17  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -1.46  Pr > z =  0.145
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(49)   = 361.75  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(49)   =  37.40  Prob > chi2 =  0.887
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(38)   =  32.97  Prob > chi2 =  0.701
    Difference (null H = exogenous): chi2(11)   =   4.43  Prob > chi2 =  0.956
  gmm(lnwage, lag(2 5))
    Hansen test excluding group:     chi2(10)   =   4.24  Prob > chi2 =  0.936
    Difference (null H = exogenous): chi2(39)   =  33.16  Prob > chi2 =  0.733
  gmm(educ exper exper2, collapse lag(2 5))
    Hansen test excluding group:     chi2(35)   =  33.50  Prob > chi2 =  0.540
    Difference (null H = exogenous): chi2(14)   =   3.90  Prob > chi2 =  0.996
  iv(yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10, eq(level))
    Hansen test excluding group:     chi2(40)   =  35.94  Prob > chi2 =  0.654
    Difference (null H = exogenous): chi2(9)    =   1.46  Prob > chi2 =  0.997

r; t=0.72 21:37:18

.                                         est store sys
r; t=0.00 21:37:18

. 
.                         xtabond2 lnwage l.lnwage educ exper exper2 yy2-yy10, gmm(lnwage, lag(3 5) collapse) gmm(educ exper exper2
> , lag(3 5) collapse) iv(yy2-yy10, eq(level)) ar(2) robust small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4504
Time variable : year                            Number of groups   =       495
Number of instruments = 25                      Obs per group: min =         9
F(13, 494)    =  3.61e+06                                      avg =      9.10
Prob > F      =     0.000                                      max =        10
------------------------------------------------------------------------------
             |               Robust
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9067089   .2011521     4.51   0.000     .5114897    1.301928
             |
        educ |   .0086229   .0144151     0.60   0.550    -.0196996    .0369454
       exper |   .0002337   .0015504     0.15   0.880    -.0028125    .0032799
      exper2 |   4.86e-06   .0000373     0.13   0.897    -.0000685    .0000782
         yy2 |  -.0074389   .0409347    -0.18   0.856    -.0878665    .0729887
         yy3 |  -.0055596   .0376655    -0.15   0.883     -.079564    .0684448
         yy4 |  -.0100754   .0346135    -0.29   0.771    -.0780832    .0579323
         yy5 |  -.0002702   .0320671    -0.01   0.993     -.063275    .0627346
         yy6 |  -.0000457   .0285504    -0.00   0.999     -.056141    .0560495
         yy7 |  -.0018656   .0256263    -0.07   0.942    -.0522157    .0484845
         yy8 |   .0045723   .0235543     0.19   0.846    -.0417067    .0508514
         yy9 |  -.0009288   .0197381    -0.05   0.962    -.0397097    .0378522
        yy10 |   .0026598      .0173     0.15   0.878    -.0313307    .0366504
       _cons |   .7011682   1.433117     0.49   0.625    -2.114589    3.516925
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(3/5).(educ exper exper2) collapsed
    L(3/5).lnwage collapsed
Instruments for levels equation
  Standard
    yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    DL2.(educ exper exper2) collapsed
    DL2.lnwage collapsed
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -5.75  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   3.10  Pr > z =  0.002
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(11)   =   7.74  Prob > chi2 =  0.736
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(11)   =   7.73  Prob > chi2 =  0.737
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(7)    =   1.06  Prob > chi2 =  0.994
    Difference (null H = exogenous): chi2(4)    =   6.67  Prob > chi2 =  0.155
  gmm(lnwage, collapse lag(3 5))
    Hansen test excluding group:     chi2(7)    =   3.25  Prob > chi2 =  0.861
    Difference (null H = exogenous): chi2(4)    =   4.48  Prob > chi2 =  0.345
  iv(yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10, eq(level))
    Hansen test excluding group:     chi2(3)    =   0.34  Prob > chi2 =  0.953
    Difference (null H = exogenous): chi2(8)    =   7.39  Prob > chi2 =  0.495

r; t=0.22 21:37:18

.                         xtabond2 lnwage l.lnwage educ exper exper2 yy2-yy10, gmm(lnwage, lag(3 5) collapse) gmm(educ exper exper2
> , lag(3 5) collapse) iv(yy2-yy10, eq(level)) ar(2) robust small twostep
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate optimal weighting matrix for two-step estimation.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, two-step system GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4504
Time variable : year                            Number of groups   =       495
Number of instruments = 25                      Obs per group: min =         9
F(13, 494)    =  3.54e+06                                      avg =      9.10
Prob > F      =     0.000                                      max =        10
------------------------------------------------------------------------------
             |              Corrected
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .8926347   .2486215     3.59   0.000     .4041488    1.381121
             |
        educ |    .009892   .0180417     0.55   0.584    -.0255559      .04534
       exper |   .0005637   .0016906     0.33   0.739    -.0027579    .0038852
      exper2 |  -2.24e-06   .0000357    -0.06   0.950    -.0000723    .0000679
         yy2 |   -.008561   .0459263    -0.19   0.852    -.0987959     .081674
         yy3 |  -.0062468   .0419018    -0.15   0.882    -.0885746    .0760809
         yy4 |   -.012307   .0382802    -0.32   0.748     -.087519     .062905
         yy5 |  -.0014093   .0357441    -0.04   0.969    -.0716385    .0688199
         yy6 |  -.0011048   .0309558    -0.04   0.972    -.0619262    .0597165
         yy7 |  -.0032166   .0276065    -0.12   0.907    -.0574571     .051024
         yy8 |   .0039999   .0252919     0.16   0.874    -.0456931    .0536929
         yy9 |  -.0021053   .0206123    -0.10   0.919    -.0426038    .0383932
        yy10 |   .0020215    .017725     0.11   0.909    -.0328041    .0368472
       _cons |   .7971238   1.766026     0.45   0.652    -2.672725    4.266973
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(3/5).(educ exper exper2) collapsed
    L(3/5).lnwage collapsed
Instruments for levels equation
  Standard
    yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    DL2.(educ exper exper2) collapsed
    DL2.lnwage collapsed
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -4.69  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   2.71  Pr > z =  0.007
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(11)   =   7.74  Prob > chi2 =  0.736
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(11)   =   7.73  Prob > chi2 =  0.737
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(7)    =   1.06  Prob > chi2 =  0.994
    Difference (null H = exogenous): chi2(4)    =   6.67  Prob > chi2 =  0.155
  gmm(lnwage, collapse lag(3 5))
    Hansen test excluding group:     chi2(7)    =   3.25  Prob > chi2 =  0.861
    Difference (null H = exogenous): chi2(4)    =   4.48  Prob > chi2 =  0.345
  iv(yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10, eq(level))
    Hansen test excluding group:     chi2(3)    =   0.34  Prob > chi2 =  0.953
    Difference (null H = exogenous): chi2(8)    =   7.39  Prob > chi2 =  0.495

r; t=0.27 21:37:18

. 
.                         // see the comments for the FD model on the rejection of the statistics
. 
.                                 est table ols fe fd sys, star(.1 .05 .02) drop(yy* _cons) stats(r2 ll sargan sarganp hansen hanse
> np) b(%5.4f) title(Dynamic Growth regressions) /*
>                                         */ stfmt(%6.5f)

Dynamic Growth regressions

------------------------------------------------------------------
    Variable |    ols           fe           fd          sys      
-------------+----------------------------------------------------
      lnwage |
         L1. |  0.9392***   -0.0794***    0.0072       0.0081     
             |
        educ |  0.0080***    0.0665***    0.0796***    0.0704***  
       exper |  0.0011**     0.0283***   -0.0039       0.0066***  
      exper2 | -0.0000*     -0.0000       0.0007      -0.0000     
-------------+----------------------------------------------------
          r2 | 0.97857      0.92661                               
          ll | 5.6e+03      7.8e+03                               
      sargan |                           51.55561      3.6e+02     
     sarganp |                           0.60702      0.00000     
      hansen |                                        37.40025     
     hansenp |                                        0.88700     
------------------------------------------------------------------
                               Legend: * p<.1; ** p<.05; *** p<.02
r; t=0.01 21:37:18

. 
.                                         outreg2 [ols fe fd sys] using dynamic_results, bdec(4) sdec(4) /*
>                                                 */addstat(Hansen, e(hansen), Hansen p-value, e(hansenp)) word /*
>                                                 */ replace keep(l.lnwage educ) /*
>                                                 */ sortvar(l.lnwage education)
dynamic_results.rtf
dir : seeout
r; t=0.11 21:37:18

. 
. 
.                                 sh start dynamic_results.rtf    // execute a DOS command == !start

zsh:1: command not found: start
r; t=0.03 21:37:18

. 
.                 // 7.4. UNIT ROOT TESTS
.                 
.                         // define a balanced panel
.                         
.                                 egen nobs = count(workerid),by(workerid)
r; t=0.00 21:37:18

.                                         tab nobs

       nobs |      Freq.     Percent        Cum.
------------+-----------------------------------
         10 |      4,460       89.22       89.22
         11 |        539       10.78      100.00
------------+-----------------------------------
      Total |      4,999      100.00
r; t=0.00 21:37:18

.                                         
.                                                 keep if nobs == 10
(539 observations deleted)
r; t=0.00 21:37:18

.                                                         drop nobs
r; t=0.00 21:37:18

. 
.                 // # 7.4.1. LLC test, using the AIC to choose the number of lags for regressions and using an HAC variance
.                 // estimator based on the Bartlett kernel and the number of lags chosen using Newey and West's method
.                         
.                         xtunitroot llc lnwage, demean lags(aic 2) kernel(bartlett nwest)

Levin–Lin–Chu unit-root test for lnwage
---------------------------------------
H0: Panels contain unit roots               Number of panels  =    446
Ha: Panels are stationary                   Number of periods =     10

AR parameter: Common                        Asymptotics: N/T -> 0
Panel means:  Included
Time trend:   Not included                  Cross-sectional means removed

ADF regressions: 0.66 lags average (chosen by AIC)
LR variance:     Bartlett kernel, 3.66 lags average 
                 (chosen by Newey–West)
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 Unadjusted t       -46.5235
 Adjusted t*        -26.3186        0.0000
------------------------------------------------------------------------------
r; t=11.53 21:37:30

. 
.                 // # 7.4.2. HT test, removing cross-sectional means from data
.                         
.                         xtunitroot ht lnwage, demean

Harris-Tzavalis unit-root test for lnwage
-----------------------------------------
H0: Panels contain unit roots               Number of panels  =    446
Ha: Panels are stationary                   Number of periods =     10

AR parameter: Common                        Asymptotics: N -> Infinity
Panel means:  Included                                   T Fixed
Time trend:   Not included                  Cross-sectional means removed
------------------------------------------------------------------------------
                    Statistic         z         p-value
------------------------------------------------------------------------------
 rho                  0.2898      -33.5142       0.0000
------------------------------------------------------------------------------
r; t=0.03 21:37:30

. 
.                 // # 7.4.3. Robust version of the Breitung test on a subset of OECD countries, using 3 lags for the prewhitening
.                 // step
.                         
.                         xtunitroot breitung lnwage, lags(3)

Breitung unit-root test for lnwage
------------------------------------
H0: Panels contain unit roots               Number of panels  =    446
Ha: Panels are stationary                   Number of periods =     10

AR parameter: Common                        Asymptotics:  T,N -> Infinity
Panel means:  Included                                        sequentially
Time trend:   Not included                  Prewhitening: 3 lags
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 lambda               0.3079        0.6209
------------------------------------------------------------------------------
r; t=4.22 21:37:34

.                         
.                                 preserve
r; t=0.00 21:37:34

.                                         sample2 0.7,cluster(workerid)
(4,430 observations deleted)
r; t=0.00 21:37:34

.                                         xtunitroot breitung lnwage, lags(3) robust

Breitung unit-root test for lnwage
------------------------------------
H0: Panels contain unit roots               Number of panels  =      3
Ha: Panels are stationary                   Number of periods =     10

AR parameter: Common                        Asymptotics:  T,N -> Infinity
Panel means:  Included                                        sequentially
Time trend:   Not included                  Prewhitening: 3 lags
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 lambda*             -1.3316        0.0915
------------------------------------------------------------------------------
 * Lambda robust to cross-sectional correlation
r; t=0.02 21:37:34

.                                 restore
r; t=0.00 21:37:34

. 
.                 // # 7.4.4. IPS test, using the AIC to choose the number of lags for regressions
.                         
.                         xtunitroot ips lnwage, lags(aic 5)

Im–Pesaran–Shin unit-root test for lnwage
-----------------------------------------
H0: All panels contain unit roots           Number of panels  =    446
Ha: Some panels are stationary              Number of periods =     10

AR parameter: Panel-specific                Asymptotics: T,N -> Infinity
Panel means:  Included                                        sequentially
Time trend:   Not included

ADF regressions: 0.51 lags average (chosen by AIC)
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 W-t-bar             21.0776        1.0000
------------------------------------------------------------------------------
r; t=11.14 21:37:45

. 
.                 // # 7.4.5. Fisher-type test based on ADF tests with 3 lags, allowing for a drift term in each panel
.                         
.                         xtunitroot fisher lnwage, dfuller lags(3) drift

Fisher-type unit-root test for lnwage
Based on augmented Dickey–Fuller tests
--------------------------------------
H0: All panels contain unit roots           Number of panels  =    446
Ha: At least one panel is stationary        Number of periods =     10

AR parameter: Panel-specific                Asymptotics: T -> Infinity
Panel means:  Included
Time trend:   Not included
Drift term:   Included                      ADF regressions: 3 lags
------------------------------------------------------------------------------
                                  Statistic      p-value
------------------------------------------------------------------------------
 Inverse chi-squared(892)  P       901.6544       0.4038
 Inverse normal            Z        -1.0338       0.1506
 Inverse logit t(2234)     L*       -0.9887       0.1615
 Modified inv. chi-squared Pm        0.2286       0.4096
------------------------------------------------------------------------------
 P statistic requires number of panels to be finite.
 Other statistics are suitable for finite or infinite number of panels.
------------------------------------------------------------------------------
r; t=2.66 21:37:48

. 
.                 // # 7.4.6. Hadri LM test of stationarity, using an HAC variance estimator based on the Parzen kernel with 5 lags
.                         
.                         xtunitroot hadri lnwage, kernel(parzen 5)

Hadri LM test for lnwage
--------------------------
H0: All panels are stationary               Number of panels  =    446
Ha: Some panels contain unit roots          Number of periods =     10

Time trend:         Not included            Asymptotics: T, N -> Infinity
Heteroskedasticity: Robust                                    sequentially
LR variance:        Parzen kernel, 5 lags
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 z                   28.3246        0.0000
------------------------------------------------------------------------------
r; t=1.53 21:37:49

. 
.         // # 7.5. DYNAMIC FORMULATION OF WAGE
. 
.                 use ../data/data_simulation, clear
r; t=0.00 21:37:49

.                         tab year, ge(yy)

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        495        9.90        9.90
          2 |        495        9.90       19.80
          3 |        495        9.90       29.71
          4 |        495        9.90       39.61
          5 |        495        9.90       49.51
          6 |        495        9.90       59.41
          7 |        495        9.90       69.31
          8 |        495        9.90       79.22
          9 |        495        9.90       89.12
         10 |        495        9.90       99.02
         11 |         49        0.98      100.00
------------+-----------------------------------
      Total |      4,999      100.00
r; t=0.00 21:37:49

.                                 set seed 234
r; t=0.00 21:37:49

. 
.                         drop lnwage
r; t=0.00 21:37:49

.                         bysort workerid (year): gen lnwage = ln(600) + ui + uniform()/ln(600) if _n == 1
(4,504 missing values generated)
r; t=0.00 21:37:49

.                                 bysort workerid (year): replace lnwage = ln(600) + 0.7*l.lnwage + ///
>                                         0.06*educ + 0.007*exper - 0.00001*exper2 + ///
>                                         0.02*year + ui + uniform()/ln(600) if _n > 1
(4,504 real changes made)
r; t=0.00 21:37:49

. 
.                                 
.                                 reg lnwage l.lnwage educ exper exper2 yy2-yy10

      Source |       SS           df       MS      Number of obs   =     4,504
-------------+----------------------------------   F(13, 4490)     >  99999.00
       Model |  78379.1415        13  6029.16473   Prob > F        =    0.0000
    Residual |  78.8086506     4,490  .017552038   R-squared       =    0.9990
-------------+----------------------------------   Adj R-squared   =    0.9990
       Total |  78457.9502     4,503  17.4234844   Root MSE        =    .13248

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .9843197   .0028083   350.50   0.000      .978814    .9898255
             |
        educ |   .0370529   .0008781    42.20   0.000     .0353313    .0387744
       exper |   .0089362   .0013989     6.39   0.000     .0061937    .0116787
      exper2 |  -.0002324   .0000466    -4.99   0.000    -.0003237   -.0001411
         yy2 |   4.728211   .0510584    92.60   0.000     4.628112    4.828311
         yy3 |   3.281363   .0383528    85.56   0.000     3.206172    3.356553
         yy4 |   2.272645   .0302528    75.12   0.000     2.213334    2.331955
         yy5 |   1.550718   .0253654    61.14   0.000     1.500989    1.600446
         yy6 |   1.041653   .0226271    46.04   0.000     .9972928    1.086013
         yy7 |   .6894938   .0211765    32.56   0.000     .6479774    .7310103
         yy8 |   .4321051   .0204401    21.14   0.000     .3920325    .4721777
         yy9 |    .249478   .0200761    12.43   0.000     .2101189    .2888371
        yy10 |   .1188519     .01991     5.97   0.000     .0798184    .1578854
       _cons |   .3877287   .0671468     5.77   0.000      .256088    .5193695
------------------------------------------------------------------------------
r; t=0.00 21:37:49

.                                         est store ols_dd
r; t=0.00 21:37:49

. 
.                                 xtreg lnwage l.lnwage educ exper exper2 yy2-yy10, fe
note: yy10 omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,504
Group variable: workerid                        Number of groups  =        495

R-squared:                                      Obs per group:
     Within  = 0.9999                                         min =          9
     Between = 0.9646                                         avg =        9.1
     Overall = 0.9943                                         max =         10

                                                F(12,3997)        =   2.91e+06
corr(u_i, Xb) = 0.1628                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .6990519   .0018292   382.16   0.000     .6954656    .7026382
             |
        educ |    .060448   .0010832    55.81   0.000     .0583244    .0625717
       exper |   .0279911   .0072293     3.87   0.000     .0138176    .0421647
      exper2 |  -.0000203   .0000223    -0.91   0.363    -.0000641    .0000235
         yy2 |  -.0131732   .0619494    -0.21   0.832    -.1346285    .1082821
         yy3 |  -.0107553   .0524644    -0.21   0.838    -.1136147    .0921041
         yy4 |  -.0008534   .0442003    -0.02   0.985    -.0875106    .0858038
         yy5 |  -.0034769   .0365668    -0.10   0.924    -.0751683    .0682144
         yy6 |  -.0067875   .0292559    -0.23   0.817    -.0641453    .0505704
         yy7 |  -.0018091   .0221079    -0.08   0.935    -.0451529    .0415347
         yy8 |  -.0042693   .0150643    -0.28   0.777    -.0338038    .0252651
         yy9 |  -.0030417   .0081919    -0.37   0.710    -.0191024    .0130191
        yy10 |          0  (omitted)
       _cons |   6.795262   .1368466    49.66   0.000     6.526966    7.063558
-------------+----------------------------------------------------------------
     sigma_u |  .31646482
     sigma_e |  .04539706
         rho |  .97983685   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(494, 3997) = 69.93                  Prob > F = 0.0000
r; t=0.01 21:37:49

.                                         est store fe_dd
r; t=0.00 21:37:49

. 
.                                 xtabond2 lnwage l.lnwage educ exper exper2 yy3-yy10, ///
>                                         gmm(lnwage, lag(2 5) collapse) gmm(educ, lag(2 5) collapse) ///
>                                         gmm(exper exper2, lag(0 5) collapse) iv(yy3-yy10) ar(2) noleveleq
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4009
Time variable : year                            Number of groups   =       495
Number of instruments = 25                      Obs per group: min =         8
Wald chi2(0)  =         .                                      avg =      8.10
Prob > chi2   =         .                                      max =         9
------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .7093935   .0045601   155.57   0.000     .7004559    .7183312
             |
        educ |   .0373883    .027898     1.34   0.180    -.0172907    .0920673
       exper |   .0207243    .007237     2.86   0.004     .0065401    .0349085
      exper2 |  -.0000456   .0000269    -1.70   0.090    -.0000983    7.07e-06
         yy3 |  -.0332548   .0159556    -2.08   0.037    -.0645272   -.0019823
         yy4 |  -.0434032    .024713    -1.76   0.079    -.0918399    .0050335
         yy5 |  -.0549718   .0285502    -1.93   0.054    -.1109291    .0009855
         yy6 |  -.0585673   .0280694    -2.09   0.037    -.1135823   -.0035522
         yy7 |  -.0481323   .0249681    -1.93   0.054     -.097069    .0008043
         yy8 |  -.0404219   .0194243    -2.08   0.037    -.0784928   -.0023509
         yy9 |   -.027517   .0144396    -1.91   0.057    -.0558181    .0007841
        yy10 |  -.0111869   .0103192    -1.08   0.278    -.0314122    .0090385
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(0/5).(exper exper2) collapsed
    L(2/5).educ collapsed
    L(2/5).lnwage collapsed
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -22.45  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   1.69  Pr > z =  0.091
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(13)   =  12.94  Prob > chi2 =  0.453
  (Not robust, but not weakened by many instruments.)

Difference-in-Sargan tests of exogeneity of instrument subsets:
  gmm(lnwage, collapse lag(2 5))
    Sargan test excluding group:     chi2(9)    =   9.24  Prob > chi2 =  0.416
    Difference (null H = exogenous): chi2(4)    =   3.70  Prob > chi2 =  0.448
  gmm(educ, collapse lag(2 5))
    Sargan test excluding group:     chi2(9)    =   8.40  Prob > chi2 =  0.495
    Difference (null H = exogenous): chi2(4)    =   4.54  Prob > chi2 =  0.338
  gmm(exper exper2, collapse lag(0 5))
    Sargan test excluding group:     chi2(4)    =   2.04  Prob > chi2 =  0.729
    Difference (null H = exogenous): chi2(9)    =  10.90  Prob > chi2 =  0.283
  iv(yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10)
    Sargan test excluding group:     chi2(5)    =   6.47  Prob > chi2 =  0.263
    Difference (null H = exogenous): chi2(8)    =   6.47  Prob > chi2 =  0.594

r; t=0.26 21:37:50

.                                                 est store fd_dd
r; t=0.00 21:37:50

. 
.                                 xtabond2 lnwage l.lnwage educ exper exper2 yy2-yy10, ///
>                                         gmm(lnwage, lag(2 5) collapse) gmm(educ, lag(2 5) collapse) ///
>                                         gmm(exper exper2, lag(0 5) collapse) iv(yy2-yy10, eq(level)) ar(2) robust small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: workerid                        Number of obs      =      4504
Time variable : year                            Number of groups   =       495
Number of instruments = 30                      Obs per group: min =         9
F(13, 494)    = 651461.49                                      avg =      9.10
Prob > F      =     0.000                                      max =        10
------------------------------------------------------------------------------
             |               Robust
      lnwage | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      lnwage |
         L1. |   .7432339    .006734   110.37   0.000      .730003    .7564647
             |
        educ |   .1248841   .0028436    43.92   0.000     .1192971    .1304712
       exper |   .0069954   .0023084     3.03   0.003       .00246    .0115309
      exper2 |  -.0000546   .0000684    -0.80   0.425    -.0001891    .0000798
         yy2 |   .8682511   .1261477     6.88   0.000     .6203989    1.116103
         yy3 |   .6339774   .0936453     6.77   0.000     .4499853    .8179696
         yy4 |    .473965   .0715977     6.62   0.000     .3332914    .6146386
         yy5 |    .347116   .0571824     6.07   0.000     .2347653    .4594667
         yy6 |    .249951   .0480133     5.21   0.000     .1556155    .3442865
         yy7 |   .1831195   .0421704     4.34   0.000      .100264     .265975
         yy8 |   .1216988   .0389971     3.12   0.002     .0450782    .1983195
         yy9 |   .0783636   .0368464     2.13   0.034     .0059686    .1507586
        yy10 |   .0453638   .0358548     1.27   0.206    -.0250829    .1158106
       _cons |   5.608356   .1708999    32.82   0.000     5.272576    5.944136
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(0/5).(exper exper2) collapsed
    L(2/5).educ collapsed
    L(2/5).lnwage collapsed
Instruments for levels equation
  Standard
    yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    DL.(exper exper2) collapsed
    DL.educ collapsed
    DL.lnwage collapsed
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z = -15.10  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   1.90  Pr > z =  0.057
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(16)   =4272.40  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(16)   = 139.56  Prob > chi2 =  0.000
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(12)   =   8.86  Prob > chi2 =  0.715
    Difference (null H = exogenous): chi2(4)    = 130.69  Prob > chi2 =  0.000
  gmm(lnwage, collapse lag(2 5))
    Hansen test excluding group:     chi2(11)   =   9.29  Prob > chi2 =  0.595
    Difference (null H = exogenous): chi2(5)    = 130.26  Prob > chi2 =  0.000
  gmm(educ, collapse lag(2 5))
    Hansen test excluding group:     chi2(11)   =   8.04  Prob > chi2 =  0.710
    Difference (null H = exogenous): chi2(5)    = 131.52  Prob > chi2 =  0.000
  gmm(exper exper2, collapse lag(0 5))
    Hansen test excluding group:     chi2(5)    =  15.44  Prob > chi2 =  0.009
    Difference (null H = exogenous): chi2(11)   = 124.11  Prob > chi2 =  0.000
  iv(yy2 yy3 yy4 yy5 yy6 yy7 yy8 yy9 yy10, eq(level))
    Hansen test excluding group:     chi2(7)    =  11.52  Prob > chi2 =  0.118
    Difference (null H = exogenous): chi2(9)    = 128.04  Prob > chi2 =  0.000

r; t=0.42 21:37:50

.                                                 est store sys_dd
r; t=0.00 21:37:50

. 
.                                 est table ols_dd fe_dd fd_dd sys_dd, star(.1 .05 .02) drop(yy* _cons) ///
>                                         stats(r2 ll sargan sarganp hansen hansenp) b(%5.4f) title(Dynamic Growth regressions)

Dynamic Growth regressions

------------------------------------------------------------------
    Variable |   ols_dd       fe_dd        fd_dd        sys_dd    
-------------+----------------------------------------------------
      lnwage |
         L1. |  0.9843***    0.6991***    0.7094***    0.7432***  
             |
        educ |  0.0371***    0.0604***    0.0374       0.1249***  
       exper |  0.0089***    0.0280***    0.0207***    0.0070***  
      exper2 | -0.0002***   -0.0000      -0.0000*     -0.0001     
-------------+----------------------------------------------------
          r2 |  0.9990       0.9999                               
          ll | 2.7e+03      7.8e+03                               
      sargan |                           12.9382      4.3e+03     
     sarganp |                            0.4526       0.0000     
      hansen |                                        139.5578     
     hansenp |                                         0.0000     
------------------------------------------------------------------
                               Legend: * p<.1; ** p<.05; *** p<.02
r; t=0.01 21:37:50

. 
. 
.                 esttab ols_dd fe_dd fd_dd sys_dd using ../tex_paper/estimation_gmm_analysis.tex, replace ///
>                         keep(educ exper exper2) ///
>                         mtitle("OLS" "FE" "GMM-FD" "GMM-Sys") nonumbers ///
>                         coeflabel (educ Education exper "Experience" exper2 "Experience sq.") ///
>                         b(%5.4f) se(%5.4f) star(* 0.1 ** 0.05 *** 0.01) ///
>                                 scalars("N Observations" "N_g Workers" ///
>                                 "r2 \$R^{2}\$" "rmse Root MSE" ///
>                                 "ar1 AR(1)" "ar1p p-value" "ar2 AR(2)" "ar2p p-value" ///
>                                 "hansen Hansen" "hansen_df df" "hansenp H p-value") ///
>                         nonotes addnotes("Notes: standard errors in parenthesis. Significance levels: *, 10\%;" "**, 5\%; ***, 1\
> %. The dependent variable is ln real GDP per workers." "Source: own computations.")
(output written to ../tex_paper/estimation_gmm_analysis.tex)
r; t=0.04 21:37:50

. 
. // # 8. High-Dimensional Fixed-Effects
. 
. clear
r; t=0.00 21:37:50

. 
. // # 8.1. build simulated data
. 
.         set obs 10000                   //      define the number of observations
Number of observations (_N) was 0, now 10,000.
r; t=0.00 21:37:50

.         set seed 345567789              //      define the 'seed' in order to be able
r; t=0.00 21:37:50

.                                                         //      to replicate the results
. 
.         // # 8.1.1 define worker's id and year of observation
.                 
.                 gen workerid = int(_n/10.1)+1
r; t=0.00 21:37:50

.                 bysort workerid: gen year = _n
r; t=0.00 21:37:50

. 
.         // # 8.1.2 define firms's id
.         
.                 gen firmid = int(_n/100.1)+1
r; t=0.00 21:37:50

. 
.                 sort workerid year
r; t=0.00 21:37:50

.                 tsset workerid year

Panel variable: workerid (unbalanced)
 Time variable: year, 1 to 11
         Delta: 1 unit
r; t=0.00 21:37:50

. 
.         // # 8.1.3 generate individual's specific effect, ui
.                 bysort workerid (year): gen double ui = runiform() if _n == 1
(9,009 missing values generated)
r; t=0.00 21:37:50

.                          bysort workerid (year): replace ui = ui[_n-1] if _n > 1
(9009 real changes made)
r; t=0.00 21:37:50

. 
.         // # 8.1.4 generate individual's specific effect, ui
.                 
.                 // bysort firmid (year): gen double fi = runiform() if _n == 1
.                 // bysort firmid (year): replace fi = fi[_n-1] if _n > 1
. 
.                          egen mean_ui = mean(ui),by(firmid)
r; t=0.00 21:37:50

. 
.                                 gen fi = mean_ui + runiform()
r; t=0.00 21:37:50

. 
.                          bysort firmid (year): replace fi = fi[_n-1] if _n > 1
(9900 real changes made)
r; t=0.00 21:37:50

. 
.         // # 8.1.5 build education and experience; education is a function of ui,
.         // the worker specific effect, as well as the instrument, q1
. 
.                 bysort workerid (year): gen educ= int(16*uniform())*ui if _n == 1
(9,009 missing values generated)
r; t=0.01 21:37:50

. 
.                         bysort workerid (year): replace educ = educ[_n-1] + round(uniform()) if _n > 1
(9,009 real changes made)
r; t=0.00 21:37:50

.                         egen sd = sd(educ),by(workerid)
r; t=0.00 21:37:50

.                                 sum sd, detail

                             sd
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .4772252              0
 5%     .6992059              0
10%     .8755951              0       Obs              10,000
25%     1.251666              0       Sum of wgt.      10,000

50%     1.577621                      Mean           1.570987
                        Largest       Std. dev.      .4993076
75%     1.892964        3.02765
90%     2.207426        3.02765       Variance        .249308
95%     2.403701        3.02765       Skewness      -.0334592
99%     2.733629        3.02765       Kurtosis       2.851623
r; t=0.00 21:37:50

.                                 drop sd
r; t=0.00 21:37:50

. 
.                 bysort workerid (year): gen exper= int(20*uniform()) if _n == 1
(9,009 missing values generated)
r; t=0.00 21:37:50

.                         bysort workerid (year): replace exper = exper[_n-1] + 1 if _n > 1
(9009 real changes made)
r; t=0.00 21:37:50

. 
.                         gen exper2 = exper^2
r; t=0.00 21:37:50

. 
.         // # 8.1.6 generate the true log wage equation, where the error term is
.         // defined by 'uniform()/ln(600)'; 600 is the minimum wage
.                 gen double lnwage = ln(600) + 0.06*educ + 0.007*exper - 0.00001*exper2 ///
>                                                         + 0.02*year + ui + fi + uniform()/ln(600)
r; t=0.00 21:37:50

. 
.         // 8.2. ESTIMATIONS
.         
.         tab year

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        991        9.91        9.91
          2 |        991        9.91       19.82
          3 |        990        9.90       29.72
          4 |        990        9.90       39.62
          5 |        990        9.90       49.52
          6 |        990        9.90       59.42
          7 |        990        9.90       69.32
          8 |        990        9.90       79.22
          9 |        990        9.90       89.12
         10 |        990        9.90       99.02
         11 |         98        0.98      100.00
------------+-----------------------------------
      Total |     10,000      100.00
r; t=0.00 21:37:50

.         drop if year == 11
(98 observations deleted)
r; t=0.00 21:37:50

. 
.                 reg lnwage educ exper exper2 i.year

      Source |       SS           df       MS      Number of obs   =     9,902
-------------+----------------------------------   F(12, 9889)     =   1081.76
       Model |  1911.13689        12  159.261408   Prob > F        =    0.0000
    Residual |  1455.90217     9,889  .147224408   R-squared       =    0.5676
-------------+----------------------------------   Adj R-squared   =    0.5671
       Total |  3367.03906     9,901  .340070605   Root MSE        =     .3837

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |   .1112755   .0010561   105.36   0.000     .1092053    .1133457
       exper |  -.0014622   .0024868    -0.59   0.557    -.0063369    .0034125
      exper2 |   .0002562   .0000863     2.97   0.003     .0000871    .0004253
             |
        year |
          2  |  -.0054022    .017273    -0.31   0.754    -.0392608    .0284565
          3  |  -.0068377   .0173694    -0.39   0.694    -.0408853    .0272099
          4  |  -.0110965   .0175016    -0.63   0.526    -.0454032    .0232102
          5  |  -.0148132   .0176587    -0.84   0.402    -.0494279    .0198014
          6  |  -.0169781   .0178392    -0.95   0.341    -.0519466    .0179905
          7  |  -.0230593   .0180436    -1.28   0.201    -.0584285    .0123099
          8  |  -.0270907   .0182665    -1.48   0.138    -.0628967    .0087152
          9  |  -.0353869    .018517    -1.91   0.056     -.071684    .0009103
         10  |  -.0402737    .018814    -2.14   0.032    -.0771529   -.0033945
             |
       _cons |   7.887448   .0186409   423.12   0.000     7.850908    7.923988
------------------------------------------------------------------------------
r; t=0.00 21:37:50

.                         est store ols_firm
r; t=0.00 21:37:50

.                 
.                 xtreg lnwage educ exper exper2 i.year,fe
note: 10.year omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      9,902
Group variable: workerid                        Number of groups  =        991

R-squared:                                      Obs per group:
     Within  = 0.8510                                         min =          2
     Between = 0.4037                                         avg =       10.0
     Overall = 0.4403                                         max =         10

                                                F(11,8900)        =    4620.53
corr(u_i, Xb) = 0.1672                          Prob > F          =     0.0000

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |    .060248   .0011556    52.14   0.000     .0579827    .0625132
       exper |   .0290335   .0009151    31.73   0.000     .0272396    .0308274
      exper2 |  -.0001016    .000022    -4.62   0.000    -.0001448   -.0000585
             |
        year |
          2  |  -.0021126   .0031186    -0.68   0.498    -.0082257    .0040006
          3  |  -.0010788   .0030002    -0.36   0.719    -.0069599    .0048023
          4  |  -.0016776   .0029212    -0.57   0.566    -.0074037    .0040486
          5  |  -.0024103   .0028814    -0.84   0.403    -.0080586    .0032379
          6  |   .0000522   .0028815     0.02   0.986    -.0055962    .0057006
          7  |   .0002418   .0029214     0.08   0.934    -.0054849    .0059685
          8  |   .0015474   .0030005     0.52   0.606    -.0043343    .0074291
          9  |  -.0015723     .00312    -0.50   0.614    -.0076882    .0045437
         10  |          0  (omitted)
             |
       _cons |   7.836322   .0062105  1261.79   0.000     7.824148    7.848496
-------------+----------------------------------------------------------------
     sigma_u |  .43755724
     sigma_e |  .07300291
         rho |  .97291763   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(990, 8900) = 267.08                 Prob > F = 0.0000
r; t=0.02 21:37:50

.                         est store fe_firm
r; t=0.00 21:37:50

. 
.                 reghdfe lnwage educ exper exper2 i.year, absorb(FE1=workerid FE2=firmid)
(MWFE estimator converged in 45 iterations)
note: 10.year omitted because of collinearity

HDFE Linear regression                            Number of obs   =      9,902
Absorbing 2 HDFE groups                           F(  11,   8810) =   11233.33
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.9945
                                                  Adj R-squared   =     0.9939
                                                  Within R-sq.    =     0.9334
                                                  Root MSE        =     0.0457

------------------------------------------------------------------------------
      lnwage | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        educ |    .060825   .0007373    82.50   0.000     .0593797    .0622703
       exper |   .0271836   .0005837    46.57   0.000     .0260394    .0283278
      exper2 |  -.0000393   .0000141    -2.78   0.005     -.000067   -.0000116
             |
        year |
          2  |  -.0005044   .0019573    -0.26   0.797    -.0043412    .0033325
          3  |    .000318   .0018859     0.17   0.866    -.0033788    .0040148
          4  |    .000962   .0018376     0.52   0.601    -.0026401     .004564
          5  |   -.000743   .0018134    -0.41   0.682    -.0042976    .0028117
          6  |  -.0002157   .0018134    -0.12   0.905    -.0037705     .003339
          7  |   .0017162   .0018378     0.93   0.350    -.0018863    .0053188
          8  |    .001987   .0018857     1.05   0.292    -.0017094    .0056833
          9  |  -.0000363   .0019582    -0.02   0.985    -.0038748    .0038022
         10  |          0  (omitted)
             |
       _cons |   7.842873    .003949  1986.03   0.000     7.835132    7.850614
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
    workerid |       991           0         991     |
      firmid |       100          10          90     |
-----------------------------------------------------+
r; t=0.42 21:37:51

.                         est store hdfe_firm
r; t=0.00 21:37:51

. 
.                         reg FE1 FE2

      Source |       SS           df       MS      Number of obs   =     9,902
-------------+----------------------------------   F(1, 9900)      =      3.57
       Model |  .388838061         1  .388838061   Prob > F        =    0.0589
    Residual |  1078.82469     9,900  .108972191   R-squared       =    0.0004
-------------+----------------------------------   Adj R-squared   =    0.0003
       Total |  1079.21353     9,901  .109000457   Root MSE        =    .33011

------------------------------------------------------------------------------
         FE1 | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         FE2 |   .0221255   .0117129     1.89   0.059    -.0008343    .0450852
       _cons |  -5.46e-11   .0033174    -0.00   1.000    -.0065028    .0065028
------------------------------------------------------------------------------
r; t=0.00 21:37:51

.                                 drop FE1 FE2
r; t=0.00 21:37:51

. 
.                         est table ols_firm fe_firm hdfe_firm, star(.1 .05 .02) keep(educ exper exper2) ///
>                                 stats(N r2 rmse) b(%5.4f) title(High-Dimensional FE results)

High-Dimensional FE results

-----------------------------------------------------
    Variable |  ols_firm     fe_firm     hdfe_firm   
-------------+---------------------------------------
        educ |  0.1113***    0.0602***    0.0608***  
       exper | -0.0015       0.0290***    0.0272***  
      exper2 |  0.0003***   -0.0001***   -0.0000***  
-------------+---------------------------------------
           N |    9902         9902         9902     
          r2 |  0.5676       0.8510       0.9945     
        rmse |  0.3837       0.0730       0.0457     
-----------------------------------------------------
                  Legend: * p<.1; ** p<.05; *** p<.02
r; t=0.01 21:37:51

. 
.                 esttab ols_firm fe_firm hdfe_firm using ../tex_paper/estimation_hdfe_analysis.tex, replace ///
>                         keep(educ exper exper2) ///
>                         mtitle("OLS" "FE" "HDFE") nonumbers ///
>                         coeflabel (education "Education" lnk "Experience" openk "Experience sq.") ///
>                         b(%5.1f) se(%5.3f) star(* 0.1 ** 0.05 *** 0.01) ///
>                         scalars("N Observations" "ll Log likelihood" "r2 \$R^{2}\$" "F F statistic (overall)" "rmse Root MSE") //
> /
>                         aic t(3) ///
>                         nonotes addnotes("Notes: standard errors in parenthesis. Significance levels: *, 10\%;" "**, 5\%; ***, 1\
> %. The dependent variable is ln real GDP per workers." "Source: own computations.")
(output written to ../tex_paper/estimation_hdfe_analysis.tex)
r; t=0.03 21:37:51

. 
.                         
. ////////////////////////////////////////////////////////////////////////////////                        
> ////////////////////////////////////////////////////////////////////////////////                        
> ////////////////////////////////////////////////////////////////////////////////                        
>                         
. 
. // # REPLICATE ARELLANO & BOND (1991) + Stata's 'xtabond2' command
. 
. /*
>         webuse abdata, clear
> 
>                 save ../data/abdata, replace
> 
> */
. 
. 
. // READ & DESCRIBE THE DATA
.         
.         use ../data/abdata, clear
r; t=0.00 21:37:51

.                 
.                 tsset id year, delta(1)

Panel variable: id (unbalanced)
 Time variable: year, 1976 to 1984
         Delta: 1 unit
r; t=0.00 21:37:51

.                 
.                 xtsum

Variable         |      Mean   Std. dev.       Min        Max |    Observations
-----------------+--------------------------------------------+----------------
c1       overall |         .          .          .          . |     N =       0
         between |                    .          .          . |     n =       0
         within  |                    .          .          . |     T =       .
                 |                                            |
ind      overall |  5.123181   2.678095          1          9 |     N =    1031
         between |             2.677405          1          9 |     n =     140
         within  |                    0   5.123181   5.123181 | T-bar = 7.36429
                 |                                            |
year     overall |  1979.651    2.21607       1976       1984 |     N =    1031
         between |             .6001349       1979       1981 |     n =     140
         within  |             2.133869   1975.651   1983.651 | T-bar = 7.36429
                 |                                            |
emp      overall |  7.891677   15.93492       .104    108.562 |     N =    1031
         between |             16.16889     .12975   102.1901 |     n =     140
         within  |             2.209997  -14.81247   34.76311 | T-bar = 7.36429
                 |                                            |
wage     overall |   23.9188   5.648418     8.0171    45.2318 |     N =    1031
         between |             5.184036   8.713344   36.06047 |     n =     140
         within  |              2.06765   11.72244   40.93513 | T-bar = 7.36429
                 |                                            |
cap      overall |  2.507432   6.248712      .0119    47.1079 |     N =    1031
         between |             6.104788   .0290571    38.4908 |     n =     140
         within  |             1.057896  -12.41607   12.48235 | T-bar = 7.36429
                 |                                            |
indoutpt overall |  103.8012   9.938008       86.9   128.3653 |     N =    1031
         between |             4.364938   96.52857   115.0673 |     n =     140
         within  |             8.950181   85.60127   121.9416 | T-bar = 7.36429
                 |                                            |
n        overall |  1.056002   1.341506  -2.263364   4.687321 |     N =    1031
         between |              1.33915  -2.043388    4.62618 |     n =     140
         within  |             .1945829    .242462   2.148389 | T-bar = 7.36429
                 |                                            |
w        overall |  3.142988   .2630081   2.081577     3.8118 |     N =    1031
         between |             .2439766   2.163658   3.583478 |     n =     140
         within  |             .0831353   2.427872   3.653328 | T-bar = 7.36429
                 |                                            |
k        overall | -.4415775   1.514132  -4.431217   3.852441 |     N =    1031
         between |             1.509255  -3.707425   3.625241 |     n =     140
         within  |             .2159628  -1.201903   .7753638 | T-bar = 7.36429
                 |                                            |
ys       overall |  4.638015   .0939611   4.464758    4.85488 |     N =    1031
         between |             .0393496   4.564672   4.738875 |     n =     140
         within  |             .0855069   4.472483    4.79896 | T-bar = 7.36429
                 |                                            |
rec      overall |       516   297.7684          1       1031 |     N =    1031
         between |             292.1768          4       1027 |     n =     140
         within  |             2.133869        512        520 | T-bar = 7.36429
                 |                                            |
yearm1   overall |  1979.644   2.213454       1976       1984 |     N =    1031
         between |             .5551319       1979   1980.714 |     n =     140
         within  |             2.142796   1975.644   1984.019 | T-bar = 7.36429
                 |                                            |
id       overall |  73.20369   41.23333          1        140 |     N =    1031
         between |              40.5586          1        140 |     n =     140
         within  |                    0   73.20369   73.20369 | T-bar = 7.36429
                 |                                            |
nL1      overall |  1.083518   1.338469  -2.095571   4.687321 |     N =     891
         between |             1.340891  -2.034767   4.631017 |     n =     140
         within  |             .1645276   .4121642   2.148692 | T-bar = 6.36429
                 |                                            |
nL2      overall |  1.107716   1.333478  -2.079442   4.687321 |     N =     751
         between |             1.340429  -2.024633   4.630025 |     n =     140
         within  |              .133065   .4091591     2.1586 | T-bar = 5.36429
                 |                                            |
wL1      overall |  3.132166   .2639638   2.081577     3.8118 |     N =     891
         between |             .2458396   2.156535   3.566466 |     n =     140
         within  |             .0778219   2.462948   3.637863 | T-bar = 6.36429
                 |                                            |
kL1      overall | -.4131872   1.501461  -4.431217   3.852441 |     N =     891
         between |             1.501169  -3.625378   3.608243 |     n =     140
         within  |             .1888234  -1.219026   .7132781 | T-bar = 6.36429
                 |                                            |
kL2      overall |  -.392113   1.486371  -4.431217   3.852441 |     N =     751
         between |             1.489908  -3.542483   3.589017 |     n =     140
         within  |             .1669889  -1.280847   .6616517 | T-bar = 5.36429
                 |                                            |
ysL1     overall |  4.651039   .0923352   4.464758    4.85488 |     N =     891
         between |             .0468502   4.580368   4.766464 |     n =     140
         within  |             .0798721   4.470286   4.797645 | T-bar = 6.36429
                 |                                            |
ysL2     overall |   4.67097       .085   4.490414    4.85488 |     N =     751
         between |             .0573333   4.585131   4.802614 |     n =     140
         within  |             .0632824   4.484873   4.797996 | T-bar = 5.36429
                 |                                            |
yr1976   overall |  .0775946   .2676624          0          1 |     N =    1031
         between |             .0683845          0   .1428571 |     n =     140
         within  |             .2589885  -.0652626   .9664835 | T-bar = 7.36429
                 |                                            |
yr1977   overall |  .1338506    .340657          0          1 |     N =    1031
         between |             .0195199          0   .1428571 |     n =     140
         within  |              .340104  -.0090065    1.02274 | T-bar = 7.36429
                 |                                            |
yr1978   overall |  .1357905   .3427322          0          1 |     N =    1031
         between |             .0108023   .1111111   .1428571 |     n =     140
         within  |             .3425421  -.0070666   1.024679 | T-bar = 7.36429
                 |                                            |
yr1979   overall |  .1357905   .3427322          0          1 |     N =    1031
         between |             .0108023   .1111111   .1428571 |     n =     140
         within  |             .3425421  -.0070666   1.024679 | T-bar = 7.36429
                 |                                            |
yr1980   overall |  .1357905   .3427322          0          1 |     N =    1031
         between |             .0108023   .1111111   .1428571 |     n =     140
         within  |             .3425421  -.0070666   1.024679 | T-bar = 7.36429
                 |                                            |
yr1981   overall |  .1357905   .3427322          0          1 |     N =    1031
         between |             .0108023   .1111111   .1428571 |     n =     140
         within  |             .3425421  -.0070666   1.024679 | T-bar = 7.36429
                 |                                            |
yr1982   overall |  .1357905   .3427322          0          1 |     N =    1031
         between |             .0108023   .1111111   .1428571 |     n =     140
         within  |             .3425421  -.0070666   1.024679 | T-bar = 7.36429
                 |                                            |
yr1983   overall |  .0756547   .2645732          0          1 |     N =    1031
         between |             .0664069          0   .1428571 |     n =     140
         within  |             .2563983  -.0672024   .9645436 | T-bar = 7.36429
                 |                                            |
yr1984   overall |  .0339476   .1811823          0          1 |     N =    1031
         between |             .0525297          0   .1428571 |     n =     140
         within  |             .1728789  -.1089095   .9228365 | T-bar = 7.36429
r; t=0.02 21:37:51

.                 
.                 xtsum n

Variable         |      Mean   Std. dev.       Min        Max |    Observations
-----------------+--------------------------------------------+----------------
n        overall |  1.056002   1.341506  -2.263364   4.687321 |     N =    1031
         between |              1.33915  -2.043388    4.62618 |     n =     140
         within  |             .1945829    .242462   2.148389 | T-bar = 7.36429
r; t=0.00 21:37:51

.                 sum n

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
           n |      1,031    1.056002    1.341506  -2.263364   4.687321
r; t=0.00 21:37:51

.                 
.                         preserve
r; t=0.00 21:37:51

.                                 collapse (mean) mean_n = n (count) T_bar = n, by(id)
r; t=0.00 21:37:51

.                                         sum mean_n T_bar

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
      mean_n |        140     1.08682     1.33915  -2.043388    4.62618
       T_bar |        140    7.364286    .6593076          7          9
r; t=0.00 21:37:51

.                         restore
r; t=0.00 21:37:51

.                 
.                 egen mean_n_overall = mean(n)
r; t=0.00 21:37:51

.                 egen mean_n_id = mean(n),by(id)
r; t=0.00 21:37:51

.                 
.                         gen n_alt = n - mean_n_id + mean_n_overall
r; t=0.00 21:37:51

.                                 
.                                 sum n_alt

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
       n_alt |      1,031    1.056002    .1945829    .242462   2.148389
r; t=0.00 21:37:51

.                 xtsum n

Variable         |      Mean   Std. dev.       Min        Max |    Observations
-----------------+--------------------------------------------+----------------
n        overall |  1.056002   1.341506  -2.263364   4.687321 |     N =    1031
         between |              1.33915  -2.043388    4.62618 |     n =     140
         within  |             .1945829    .242462   2.148389 | T-bar = 7.36429
r; t=0.00 21:37:51

. 
. // REGRESSION ANALYSIS
.         
.         // code in ROODMAN (2009)
. 
.                 regress n nL1 nL2 w wL1 k kL1 kL2 ys ysL1 ysL2 yr*
note: yr1976 omitted because of collinearity.
note: yr1977 omitted because of collinearity.
note: yr1978 omitted because of collinearity.

      Source |       SS           df       MS      Number of obs   =       751
-------------+----------------------------------   F(16, 734)      =   8136.58
       Model |  1343.31797        16  83.9573732   Prob > F        =    0.0000
    Residual |  7.57378164       734  .010318504   R-squared       =    0.9944
-------------+----------------------------------   Adj R-squared   =    0.9943
       Total |  1350.89175       750    1.801189   Root MSE        =    .10158

------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         nL1 |   1.044643   .0336647    31.03   0.000     .9785523    1.110734
         nL2 |  -.0765426   .0328437    -2.33   0.020    -.1410214   -.0120639
           w |  -.5236727   .0487799   -10.74   0.000    -.6194374    -.427908
         wL1 |   .4767538   .0486954     9.79   0.000      .381155    .5723527
           k |   .3433951   .0255185    13.46   0.000     .2932972    .3934931
         kL1 |  -.2018991   .0400683    -5.04   0.000    -.2805613    -.123237
         kL2 |  -.1156467   .0284922    -4.06   0.000    -.1715826   -.0597107
          ys |   .4328752   .1226806     3.53   0.000     .1920285     .673722
        ysL1 |  -.7679125   .1658165    -4.63   0.000    -1.093444   -.4423813
        ysL2 |   .3124721    .111457     2.80   0.005     .0936596    .5312846
      yr1976 |          0  (omitted)
      yr1977 |          0  (omitted)
      yr1978 |          0  (omitted)
      yr1979 |   .0158888   .0143976     1.10   0.270    -.0123765    .0441541
      yr1980 |   .0219933   .0166632     1.32   0.187      -.01072    .0547065
      yr1981 |  -.0221532   .0204143    -1.09   0.278    -.0622306    .0179243
      yr1982 |  -.0150344   .0206845    -0.73   0.468    -.0556422    .0255735
      yr1983 |   .0073931   .0204243     0.36   0.717    -.0327038    .0474901
      yr1984 |   .0153956   .0230101     0.67   0.504    -.0297779     .060569
       _cons |   .2747256   .3505305     0.78   0.433    -.4134363    .9628875
------------------------------------------------------------------------------
r; t=0.00 21:37:51

.                 xi: regress n nL1 nL2 w wL1 k kL1 kL2 ys ysL1 ysL2 yr* i.id
i.id              _Iid_1-140          (naturally coded; _Iid_1 omitted)
note: yr1976 omitted because of collinearity.
note: yr1977 omitted because of collinearity.
note: yr1978 omitted because of collinearity.

      Source |       SS           df       MS      Number of obs   =       751
-------------+----------------------------------   F(155, 595)     =    983.39
       Model |  1345.63898       155  8.68154179   Prob > F        =    0.0000
    Residual |  5.25277539       595  .008828194   R-squared       =    0.9961
-------------+----------------------------------   Adj R-squared   =    0.9951
       Total |  1350.89175       750    1.801189   Root MSE        =    .09396

------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         nL1 |   .7329476    .039304    18.65   0.000     .6557563     .810139
         nL2 |  -.1394773    .040026    -3.48   0.001    -.2180867   -.0608678
           w |  -.5597445    .057033    -9.81   0.000    -.6717551   -.4477339
         wL1 |   .3149987   .0609756     5.17   0.000     .1952451    .4347522
           k |   .3884188   .0309544    12.55   0.000     .3276256    .4492119
         kL1 |  -.0805185   .0384648    -2.09   0.037    -.1560618   -.0049751
         kL2 |  -.0278013   .0328257    -0.85   0.397    -.0922695     .036667
          ys |    .468666   .1231278     3.81   0.000     .2268481    .7104839
        ysL1 |  -.6285587     .15796    -3.98   0.000    -.9387856   -.3183318
        ysL2 |   .0579764   .1345353     0.43   0.667    -.2062454    .3221982
      yr1976 |          0  (omitted)
      yr1977 |          0  (omitted)
      yr1978 |          0  (omitted)
      yr1979 |   .0046562   .0137521     0.34   0.735    -.0223523    .0316647
      yr1980 |   .0112327   .0164917     0.68   0.496    -.0211564    .0436218
      yr1981 |  -.0253693   .0217036    -1.17   0.243    -.0679942    .0172557
      yr1982 |  -.0343973   .0223548    -1.54   0.124    -.0783012    .0095066
      yr1983 |  -.0280344   .0240741    -1.16   0.245    -.0753149    .0192461
      yr1984 |  -.0119152   .0261724    -0.46   0.649    -.0633167    .0394862
      _Iid_2 |   .2809286   .1197976     2.35   0.019     .0456511    .5162061
      _Iid_3 |   .1147461   .0984317     1.17   0.244    -.0785697     .308062
      _Iid_4 |    .109751   .0980072     1.12   0.263     -.082731     .302233
      _Iid_5 |   .2630759   .1298768     2.03   0.043     .0080033    .5181485
      _Iid_6 |  -.1084596    .091929    -1.18   0.239    -.2890043    .0720851
      _Iid_7 |   -.282537   .0960348    -2.94   0.003    -.4711453   -.0939286
      _Iid_8 |  -.0210795   .0944167    -0.22   0.823    -.2065102    .1643511
      _Iid_9 |   .0796857    .074423     1.07   0.285    -.0664781    .2258495
     _Iid_10 |  -.1154229   .0755243    -1.53   0.127    -.2637495    .0329038
     _Iid_11 |  -.2756613   .0850738    -3.24   0.001    -.4427427   -.1085799
     _Iid_12 |  -.0091779   .0943023    -0.10   0.923    -.1943837    .1760279
     _Iid_13 |  -.0004181   .0805969    -0.01   0.996     -.158707    .1578708
     _Iid_14 |   .0964487   .0753894     1.28   0.201     -.051613    .2445103
     _Iid_15 |   -.002134   .0770551    -0.03   0.978     -.153467    .1491989
     _Iid_16 |  -.0158687   .0813011    -0.20   0.845    -.1755407    .1438033
     _Iid_17 |   .1074392   .0902029     1.19   0.234    -.0697155    .2845939
     _Iid_18 |   .1397229   .0775628     1.80   0.072    -.0126072    .2920531
     _Iid_19 |   .2325247   .1023598     2.27   0.023     .0314943    .4335551
     _Iid_20 |  -.0977103   .0891818    -1.10   0.274    -.2728597    .0774391
     _Iid_21 |  -.0383072   .0794945    -0.48   0.630     -.194431    .1178167
     _Iid_22 |   .0299681   .0828278     0.36   0.718    -.1327022    .1926385
     _Iid_23 |    .179595   .0814776     2.20   0.028     .0195763    .3396137
     _Iid_24 |  -.1374195   .0808388    -1.70   0.090    -.2961836    .0213445
     _Iid_25 |   .1179097   .1039804     1.13   0.257    -.0863037     .322123
     _Iid_26 |   .0639374   .0780006     0.82   0.413    -.0892525    .2171274
     _Iid_27 |   .1033794   .0806242     1.28   0.200    -.0549633     .261722
     _Iid_28 |  -.0355817   .0953696    -0.37   0.709    -.2228837    .1517203
     _Iid_29 |   .0400762   .0928669     0.43   0.666    -.1423106    .2224629
     _Iid_30 |  -.0794542   .0899104    -0.88   0.377    -.2560346    .0971263
     _Iid_31 |  -.0143192    .079542    -0.18   0.857    -.1705365    .1418981
     _Iid_32 |   .2029874   .0787164     2.58   0.010     .0483916    .3575833
     _Iid_33 |   .1944954   .0810788     2.40   0.017     .0352599    .3537309
     _Iid_34 |   .0946854   .0780464     1.21   0.226    -.0585946    .2479655
     _Iid_35 |   .1353832    .092366     1.47   0.143    -.0460199    .3167863
     _Iid_36 |  -.4684146   .1022706    -4.58   0.000    -.6692698   -.2675594
     _Iid_37 |   .2908603   .0921002     3.16   0.002     .1099793    .4717413
     _Iid_38 |   .0616443   .0821326     0.75   0.453    -.0996607    .2229493
     _Iid_39 |  -.1322534   .0859522    -1.54   0.124      -.30106    .0365532
     _Iid_40 |   .3538017   .0832931     4.25   0.000     .1902175     .517386
     _Iid_41 |   .3477259   .0869091     4.00   0.000     .1770399    .5184119
     _Iid_42 |  -.1902394   .0801689    -2.37   0.018    -.3476878    -.032791
     _Iid_43 |   .2377634   .0780041     3.05   0.002     .0845666    .3909602
     _Iid_44 |  -.2219463   .0894785    -2.48   0.013    -.3976785   -.0462141
     _Iid_45 |   .1990331   .1145189     1.74   0.083    -.0258772    .4239435
     _Iid_46 |  -.1353744   .0761881    -1.78   0.076    -.2850048    .0142559
     _Iid_47 |  -.0994684   .0790761    -1.26   0.209    -.2547706    .0558338
     _Iid_48 |   -.034924   .0813258    -0.43   0.668    -.1946446    .1247965
     _Iid_49 |  -.0606939   .0737008    -0.82   0.411    -.2054393    .0840514
     _Iid_50 |   .2060415   .1282458     1.61   0.109     -.045828    .4579111
     _Iid_51 |  -.2085653   .0981396    -2.13   0.034    -.4013075   -.0158231
     _Iid_52 |    .171898   .0814905     2.11   0.035      .011854    .3319419
     _Iid_53 |   .1485321   .0711168     2.09   0.037     .0088617    .2882026
     _Iid_54 |   .1352127   .0743939     1.82   0.070     -.010894    .2813193
     _Iid_55 |   .5259449   .0979647     5.37   0.000     .3335462    .7183435
     _Iid_56 |  -.0152995   .0742584    -0.21   0.837    -.1611398    .1305409
     _Iid_57 |   .0418916   .0798809     0.52   0.600    -.1149911    .1987743
     _Iid_58 |   .0635644   .1029558     0.62   0.537    -.1386365    .2657654
     _Iid_59 |   .1786853   .0647793     2.76   0.006     .0514615    .3059092
     _Iid_60 |   -.113058   .0862445    -1.31   0.190    -.2824387    .0563227
     _Iid_61 |  -.0216629   .0724414    -0.30   0.765    -.1639349    .1206091
     _Iid_62 |   .2743896   .0781782     3.51   0.000     .1208509    .4279283
     _Iid_63 |  -.3369223   .1075185    -3.13   0.002    -.5480843   -.1257603
     _Iid_64 |   .2063876   .0844248     2.44   0.015     .0405806    .3721945
     _Iid_65 |   .2033548   .1036512     1.96   0.050    -.0002118    .4069215
     _Iid_66 |  -.1549804   .1049083    -1.48   0.140     -.361016    .0510551
     _Iid_67 |   .4969457   .0751251     6.61   0.000     .3494032    .6444883
     _Iid_68 |  -.2580701   .1101541    -2.34   0.019    -.4744081    -.041732
     _Iid_69 |  -.1454507   .0896026    -1.62   0.105    -.3214266    .0305252
     _Iid_70 |  -.0682156   .0736987    -0.93   0.355    -.2129569    .0765257
     _Iid_71 |  -.1362032   .0800405    -1.70   0.089    -.2933995    .0209931
     _Iid_72 |   .2587145   .0921358     2.81   0.005     .0777636    .4396654
     _Iid_73 |  -.1317325   .0952606    -1.38   0.167    -.3188205    .0553554
     _Iid_74 |   .0179829   .0706436     0.25   0.799    -.1207581     .156724
     _Iid_75 |  -.0696992   .0792816    -0.88   0.380    -.2254051    .0860066
     _Iid_76 |   .1303152   .0771522     1.69   0.092    -.0212086     .281839
     _Iid_77 |   .0388582   .0685179     0.57   0.571    -.0957082    .1734245
     _Iid_78 |   .2758307   .0764357     3.61   0.000     .1257142    .4259473
     _Iid_79 |  -.2021672   .0931352    -2.17   0.030     -.385081   -.0192535
     _Iid_80 |  -.0692053   .0745195    -0.93   0.353    -.2155585    .0771479
     _Iid_81 |  -.1360437   .0923139    -1.47   0.141    -.3173444     .045257
     _Iid_82 |   .3980734   .0929297     4.28   0.000     .2155633    .5805835
     _Iid_83 |   .0464647   .0781376     0.59   0.552    -.1069944    .1999238
     _Iid_84 |   .1113037   .0836023     1.33   0.184    -.0528877    .2754951
     _Iid_85 |   .1273466   .0998889     1.27   0.203     -.068831    .3235242
     _Iid_86 |   .2115646   .1378619     1.53   0.125    -.0591904    .4823197
     _Iid_87 |   .2951375     .11106     2.66   0.008     .0770201    .5132548
     _Iid_88 |   .1579277   .0922196     1.71   0.087    -.0231879    .3390433
     _Iid_89 |  -.4903976   .1053932    -4.65   0.000    -.6973855   -.2834097
     _Iid_90 |  -.1584976   .1017384    -1.56   0.120    -.3583077    .0413126
     _Iid_91 |  -.3795049   .1257137    -3.02   0.003    -.6264015   -.1326083
     _Iid_92 |  -.2046982   .1282107    -1.60   0.111    -.4564988    .0471024
     _Iid_93 |   .2540069   .1347239     1.89   0.060    -.0105854    .5185992
     _Iid_94 |   .0576752   .0817216     0.71   0.481    -.1028226     .218173
     _Iid_95 |  -.2071006   .0945189    -2.19   0.029    -.3927318   -.0214695
     _Iid_96 |   .3655964   .1119053     3.27   0.001      .145819    .5853738
     _Iid_97 |   .2653858   .0929023     2.86   0.004     .0829296    .4478421
     _Iid_98 |   -.163375   .1093342    -1.49   0.136     -.378103    .0513529
     _Iid_99 |  -.1611573   .0898173    -1.79   0.073    -.3375548    .0152402
    _Iid_100 |   .1069444   .0787283     1.36   0.175    -.0476749    .2615636
    _Iid_101 |   .0317006   .0680143     0.47   0.641    -.1018766    .1652778
    _Iid_102 |  -.3106869   .0981809    -3.16   0.002    -.5035102   -.1178636
    _Iid_103 |  -.3351878    .099712    -3.36   0.001    -.5310181   -.1393575
    _Iid_104 |  -.4041926    .080748    -5.01   0.000    -.5627784   -.2456067
    _Iid_105 |  -.6496226   .1180398    -5.50   0.000     -.881448   -.4177972
    _Iid_106 |  -.3142806   .0708454    -4.44   0.000    -.4534179   -.1751432
    _Iid_107 |  -.4433775   .0799838    -5.54   0.000    -.6004625   -.2862926
    _Iid_108 |   -.658625   .1088786    -6.05   0.000    -.8724581    -.444792
    _Iid_109 |  -.1285566   .0669492    -1.92   0.055    -.2600421    .0029289
    _Iid_110 |   .0539733   .0716005     0.75   0.451    -.0866471    .1945937
    _Iid_111 |   .0214999   .0769685     0.28   0.780    -.1296631    .1726628
    _Iid_112 |   .0686043   .0705805     0.97   0.331    -.0700128    .2072215
    _Iid_113 |  -.0058332   .0774401    -0.08   0.940    -.1579224    .1462559
    _Iid_114 |   .0385479   .0993885     0.39   0.698     -.156647    .2337429
    _Iid_115 |   .0678202   .0732896     0.93   0.355    -.0761176     .211758
    _Iid_116 |   .0272439   .0713142     0.38   0.703    -.1128143    .1673021
    _Iid_117 |   .0041697   .0735549     0.06   0.955    -.1402891    .1486286
    _Iid_118 |   .1268932   .0594736     2.13   0.033     .0100895    .2436969
    _Iid_119 |  -.0086312   .0782741    -0.11   0.912    -.1623584    .1450959
    _Iid_120 |  -.0327141   .0807938    -0.40   0.686    -.1913899    .1259617
    _Iid_121 |  -.0702842   .0825067    -0.85   0.395     -.232324    .0917556
    _Iid_122 |   .0067514   .0776512     0.09   0.931    -.1457523    .1592552
    _Iid_123 |  -.1864202   .0894523    -2.08   0.038    -.3621009   -.0107395
    _Iid_124 |  -.5063811   .1379344    -3.67   0.000    -.7772786   -.2354837
    _Iid_125 |  -.2411192   .1015007    -2.38   0.018    -.4404624    -.041776
    _Iid_126 |  -.3689442   .1248044    -2.96   0.003     -.614055   -.1238334
    _Iid_127 |  -.4553613   .0807139    -5.64   0.000      -.61388   -.2968426
    _Iid_128 |  -.2672474    .064916    -4.12   0.000    -.3947397   -.1397551
    _Iid_129 |  -.4979922   .0855841    -5.82   0.000     -.666076   -.3299085
    _Iid_130 |  -.4918557   .1469412    -3.35   0.001    -.7804423   -.2032692
    _Iid_131 |    .014022   .0681442     0.21   0.837    -.1198104    .1478544
    _Iid_132 |  -.0782982   .0869495    -0.90   0.368    -.2490635    .0924672
    _Iid_133 |   .1142165   .0739379     1.54   0.123    -.0309944    .2594275
    _Iid_134 |   .3379907    .066655     5.07   0.000     .2070831    .4688983
    _Iid_135 |  -.0675258   .0669768    -1.01   0.314    -.1990654    .0640138
    _Iid_136 |  -.2133832   .1010725    -2.11   0.035    -.4118855    -.014881
    _Iid_137 |  -.1688331   .0907954    -1.86   0.063    -.3471515    .0094853
    _Iid_138 |   .1061479   .0779063     1.36   0.174    -.0468569    .2591528
    _Iid_139 |  -.1528492   .0762046    -2.01   0.045     -.302512   -.0031865
    _Iid_140 |  -.2106616   .0883662    -2.38   0.017    -.3842093    -.037114
       _cons |   1.821028    .495499     3.68   0.000     .8478883    2.794168
------------------------------------------------------------------------------
r; t=0.09 21:37:51

.                 xtreg n nL1 nL2 w wL1 k kL1 kL2 ys ysL1 ysL2 yr*, fe
note: yr1976 omitted because of collinearity.
note: yr1977 omitted because of collinearity.
note: yr1984 omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =        751
Group variable: id                              Number of groups  =        140

R-squared:                                      Obs per group:
     Within  = 0.7973                                         min =          5
     Between = 0.9809                                         avg =        5.4
     Overall = 0.9758                                         max =          7

                                                F(16,595)         =     146.27
corr(u_i, Xb) = 0.5459                          Prob > F          =     0.0000

------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         nL1 |   .7329476    .039304    18.65   0.000     .6557563     .810139
         nL2 |  -.1394773    .040026    -3.48   0.001    -.2180867   -.0608678
           w |  -.5597445    .057033    -9.81   0.000    -.6717551   -.4477339
         wL1 |   .3149987   .0609756     5.17   0.000     .1952451    .4347522
           k |   .3884188   .0309544    12.55   0.000     .3276256    .4492119
         kL1 |  -.0805185   .0384648    -2.09   0.037    -.1560618   -.0049751
         kL2 |  -.0278013   .0328257    -0.85   0.397    -.0922695     .036667
          ys |    .468666   .1231278     3.81   0.000     .2268481    .7104839
        ysL1 |  -.6285587     .15796    -3.98   0.000    -.9387856   -.3183318
        ysL2 |   .0579764   .1345353     0.43   0.667    -.2062454    .3221982
      yr1976 |          0  (omitted)
      yr1977 |          0  (omitted)
      yr1978 |   .0119152   .0261724     0.46   0.649    -.0394862    .0633167
      yr1979 |   .0165714    .024721     0.67   0.503    -.0319795    .0651224
      yr1980 |   .0231479   .0249969     0.93   0.355    -.0259449    .0722408
      yr1981 |   -.013454   .0260231    -0.52   0.605    -.0645623    .0376542
      yr1982 |  -.0224821   .0229812    -0.98   0.328    -.0676163    .0226521
      yr1983 |  -.0161192   .0209498    -0.77   0.442    -.0572636    .0250253
      yr1984 |          0  (omitted)
       _cons |   1.780205   .5014522     3.55   0.000     .7953734    2.765036
-------------+----------------------------------------------------------------
     sigma_u |  .22568151
     sigma_e |  .09395847
         rho |  .85227336   (fraction of variance due to u_i)
------------------------------------------------------------------------------
F test that all u_i=0: F(139, 595) = 1.89                    Prob > F = 0.0000
r; t=0.01 21:37:51

. 
.         use ../data/abdata, clear
r; t=0.00 21:37:51

.                 xtset

Panel variable: id (unbalanced)
 Time variable: year, 1976 to 1984
         Delta: 1 unit
r; t=0.00 21:37:51

.                 
.                 xtdata n nL1 nL2 w wL1 k kL1 kL2 ys ysL1 ysL2 yr*, fe
r; t=0.00 21:37:51

.                 regress n nL1 nL2 w wL1 k kL1 kL2 ys ysL1 ysL2 yr*
note: yr1976 omitted because of collinearity.
note: yr1977 omitted because of collinearity.
note: yr1978 omitted because of collinearity.

      Source |       SS           df       MS      Number of obs   =       751
-------------+----------------------------------   F(16, 734)      =    180.44
       Model |   20.661288        16   1.2913305   Prob > F        =    0.0000
    Residual |  5.25277539       734   .00715637   R-squared       =    0.7973
-------------+----------------------------------   Adj R-squared   =    0.7929
       Total |  25.9140634       750  .034552084   Root MSE        =     .0846

------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         nL1 |   .7329476   .0353873    20.71   0.000     .6634753      .80242
         nL2 |  -.1394773   .0360373    -3.87   0.000    -.2102258   -.0687287
           w |  -.5597445   .0513496   -10.90   0.000    -.6605541   -.4589349
         wL1 |   .3149987   .0548993     5.74   0.000     .2072204     .422777
           k |   .3884188   .0278697    13.94   0.000     .3337049    .4431327
         kL1 |  -.0805185   .0346317    -2.32   0.020    -.1485076   -.0125294
         kL2 |  -.0278013   .0295545    -0.94   0.347    -.0858227    .0302202
          ys |    .468666   .1108579     4.23   0.000     .2510297    .6863023
        ysL1 |  -.6285587    .142219    -4.42   0.000    -.9077631   -.3493543
        ysL2 |   .0579764   .1211286     0.48   0.632    -.1798234    .2957762
      yr1976 |          0  (omitted)
      yr1977 |          0  (omitted)
      yr1978 |          0  (omitted)
      yr1979 |   .0046562   .0123816     0.38   0.707    -.0196515    .0289639
      yr1980 |   .0112327   .0148483     0.76   0.450    -.0179175    .0403829
      yr1981 |  -.0253693   .0195408    -1.30   0.195    -.0637318    .0129932
      yr1982 |  -.0343973   .0201271    -1.71   0.088    -.0739109    .0051162
      yr1983 |  -.0280344    .021675    -1.29   0.196    -.0705869    .0145181
      yr1984 |  -.0119152   .0235643    -0.51   0.613    -.0581766    .0343461
       _cons |    1.79212   .4571846     3.92   0.000     .8945748    2.689665
------------------------------------------------------------------------------
r; t=0.00 21:37:51

. 
. // ROODMAN.3.2 Instrumenting with lags
.         
.         use ../data/abdata, clear
r; t=0.00 21:37:51

.                 xtset

Panel variable: id (unbalanced)
 Time variable: year, 1976 to 1984
         Delta: 1 unit
r; t=0.00 21:37:51

. 
.         ivregress 2sls D.n (D.nL1= nL2) D.(nL2 w wL1 k kL1 kL2 ys ysL1 ysL2 yr1979 yr1980 yr1981 yr1982 yr1983)

Instrumental variables 2SLS regression            Number of obs   =        611
                                                  Wald chi2(15)   =      89.93
                                                  Prob > chi2     =     0.0000
                                                  R-squared       =          .
                                                  Root MSE        =       .247

------------------------------------------------------------------------------
         D.n | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
         nL1 |
         D1. |   2.307626   1.973193     1.17   0.242    -1.559762    6.175013
             |
         nL2 |
         D1. |  -.2240271    .179043    -1.25   0.211    -.5749448    .1268907
             |
           w |
         D1. |  -.8103626    .261805    -3.10   0.002    -1.323491   -.2972342
             |
         wL1 |
         D1. |   1.422246   1.179492     1.21   0.228    -.8895156    3.734007
             |
           k |
         D1. |   .2530975   .1447404     1.75   0.080    -.0305884    .5367835
             |
         kL1 |
         D1. |  -.5524613   .6154929    -0.90   0.369    -1.758805    .6538825
             |
         kL2 |
         D1. |  -.2126364   .2397909    -0.89   0.375    -.6826179    .2573451
             |
          ys |
         D1. |   .9905803   .4630105     2.14   0.032     .0830965    1.898064
             |
        ysL1 |
         D1. |  -1.937912   1.438225    -1.35   0.178     -4.75678    .8809566
             |
        ysL2 |
         D1. |   .4870838   .5099415     0.96   0.339    -.5123832    1.486551
             |
      yr1979 |
         D1. |   .0467148   .0448599     1.04   0.298    -.0412089    .1346385
             |
      yr1980 |
         D1. |   .0761344   .0624919     1.22   0.223    -.0463474    .1986163
             |
      yr1981 |
         D1. |    .022623   .0557394     0.41   0.685    -.0866242    .1318701
             |
      yr1982 |
         D1. |   .0127801   .0548402     0.23   0.816    -.0947048     .120265
             |
      yr1983 |
         D1. |   .0099072   .0456113     0.22   0.828    -.0794894    .0993037
             |
       _cons |   .0159337   .0273445     0.58   0.560    -.0376605    .0695279
------------------------------------------------------------------------------
Instrumented: D.nL1
 Instruments: D.nL2 D.w D.wL1 D.k D.kL1 D.kL2 D.ys D.ysL1 D.ysL2 D.yr1979
              D.yr1980 D.yr1981 D.yr1982 D.yr1983 nL2
r; t=0.04 21:37:51

.         
.         
. forvalues yr=1978/1984 {
  2.         forvalues lag = 2 / `= `yr' - 1976' {
  3.                 quietly generate z`yr'L`lag' = L`lag'.n if year == `yr'
  4.         }
  5. }
r; t=0.00 21:37:51

. 
. quietly recode z* (. = 0)
r; t=0.01 21:37:51

. 
. ivregress 2sls D.n D.(L2.n w L.w k L.k L2.k ys L.ys L2.ys yr1978 yr1979 yr1980 yr1981 yr1982 yr1983) (DL.n = z*), nocons
note: z1978L2 omitted because of collinearity.
note: z1984L3 omitted because of collinearity.

Instrumental variables 2SLS regression            Number of obs   =        611
                                                  Wald chi2(16)   =          .
                                                  Prob > chi2     =          .
                                                  R-squared       =          .
                                                  Root MSE        =     .10885

------------------------------------------------------------------------------
         D.n | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         LD. |   .2689418   .1447008     1.86   0.063    -.0146665    .5525501
        L2D. |  -.0669834   .0431623    -1.55   0.121    -.1515799    .0176131
             |
           w |
         D1. |  -.5723355   .0573518    -9.98   0.000     -.684743    -.459928
         LD. |   .2112242   .1037099     2.04   0.042     .0079564    .4144919
             |
           k |
         D1. |   .3843826   .0319335    12.04   0.000     .3217941    .4469711
         LD. |   .0796079   .0538637     1.48   0.139     -.025963    .1851788
        L2D. |   .0231674   .0364836     0.64   0.525    -.0483391     .094674
             |
          ys |
         D1. |   .5976429    .119675     4.99   0.000     .3630842    .8322016
         LD. |  -.4806272   .1614112    -2.98   0.003    -.7969874    -.164267
        L2D. |   .0581721   .1340154     0.43   0.664    -.2044932    .3208374
             |
      yr1978 |
         D1. |   .0429548   .0427985     1.00   0.316    -.0409287    .1268384
             |
      yr1979 |
         D1. |    .047082   .0410286     1.15   0.251    -.0333325    .1274966
             |
      yr1980 |
         D1. |   .0566061   .0390769     1.45   0.147    -.0199833    .1331955
             |
      yr1981 |
         D1. |   .0263295   .0357589     0.74   0.462    -.0437567    .0964158
             |
      yr1982 |
         D1. |   .0018456   .0280028     0.07   0.947    -.0530388    .0567301
             |
      yr1983 |
         D1. |  -.0062288   .0195166    -0.32   0.750    -.0444805     .032023
------------------------------------------------------------------------------
Instrumented: LD.n
 Instruments: L2D.n D.w LD.w D.k LD.k L2D.k D.ys LD.ys L2D.ys D.yr1978
              D.yr1979 D.yr1980 D.yr1981 D.yr1982 D.yr1983 z1979L2 z1979L3
              z1980L2 z1980L3 z1980L4 z1981L2 z1981L3 z1981L4 z1981L5
              z1982L2 z1982L3 z1982L4 z1982L5 z1982L6 z1983L2 z1983L3
              z1983L4 z1983L5 z1983L6 z1983L7 z1984L2 z1984L4 z1984L5
              z1984L6 z1984L7 z1984L8
r; t=0.07 21:37:51

. 
. // ROODMAN.3.3 Applying GMM
. 
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.n) iv(w L.w L(0/2).(k ys) yr*) h(1) nolevel small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1981 dropped due to collinearity

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 41                      Obs per group: min =         4
F(0, 611)     =         .                                      avg =      4.36
Prob > F      =         .                                      max =         6
------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .2689418   .1466334     1.83   0.067    -.0190248    .5569084
         L2. |  -.0669834   .0437388    -1.53   0.126    -.1528799    .0189132
             |
           w |
         --. |  -.5723355   .0581178    -9.85   0.000    -.6864705   -.4582006
         L1. |   .2112242   .1050951     2.01   0.045     .0048327    .4176156
             |
           k |
         --. |   .3843826     .03236    11.88   0.000     .3208322    .4479329
         L1. |   .0796079   .0545831     1.46   0.145    -.0275853    .1868012
         L2. |   .0231675   .0369709     0.63   0.531     -.049438    .0957729
             |
          ys |
         --. |   .5976429   .1212734     4.93   0.000     .3594796    .8358062
         L1. |  -.4806272   .1635671    -2.94   0.003    -.8018491   -.1594053
         L2. |   .0581721   .1358053     0.43   0.669    -.2085297    .3248739
             |
      yr1978 |   .0166253   .0274209     0.61   0.545    -.0372253    .0704759
      yr1979 |   .0207525   .0229988     0.90   0.367    -.0244138    .0659189
      yr1980 |   .0302766   .0149954     2.02   0.044     .0008278    .0597253
      yr1982 |  -.0244839   .0152452    -1.61   0.109    -.0544233    .0054555
      yr1983 |  -.0325583   .0279486    -1.16   0.244    -.0874452    .0223286
      yr1984 |  -.0263295   .0362365    -0.73   0.468    -.0974928    .0448337
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980
    yr1981 yr1982 yr1983 yr1984)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).L.n
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -1.21  Pr > z =  0.226
Arellano-Bond test for AR(2) in first differences: z =  -0.15  Pr > z =  0.881
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   =  46.06  Prob > chi2 =  0.006
  (Not robust, but not weakened by many instruments.)

Difference-in-Sargan tests of exogeneity of instrument subsets:
  iv(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984)
    Sargan test excluding group:     chi2(11)   =  24.17  Prob > chi2 =  0.012
    Difference (null H = exogenous): chi2(14)   =  21.89  Prob > chi2 =  0.081

r; t=0.16 21:37:51

. 
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.n) iv(w L.w L(0/2).(k ys) yr*) nolevel robust
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1981 dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 41                      Obs per group: min =         4
Wald chi2(0)  =         .                                      avg =      4.36
Prob > chi2   =         .                                      max =         6
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .6862261   .1445943     4.75   0.000     .4028266    .9696257
         L2. |  -.0853582   .0560155    -1.52   0.128    -.1951467    .0244302
             |
           w |
         --. |  -.6078208   .1782055    -3.41   0.001    -.9570972   -.2585445
         L1. |   .3926237   .1679931     2.34   0.019     .0633632    .7218842
             |
           k |
         --. |   .3568456   .0590203     6.05   0.000      .241168    .4725233
         L1. |  -.0580012   .0731797    -0.79   0.428    -.2014308    .0854284
         L2. |  -.0199475   .0327126    -0.61   0.542    -.0840631    .0441681
             |
          ys |
         --. |   .6085073   .1725313     3.53   0.000     .2703522    .9466624
         L1. |  -.7111651   .2317163    -3.07   0.002    -1.165321   -.2570095
         L2. |   .1057969   .1412021     0.75   0.454    -.1709542     .382548
             |
      yr1978 |   .0117743   .0295079     0.40   0.690      -.04606    .0696086
      yr1979 |   .0213288   .0251226     0.85   0.396    -.0279106    .0705682
      yr1980 |   .0337895   .0168736     2.00   0.045     .0007178    .0668612
      yr1982 |  -.0152845   .0162294    -0.94   0.346    -.0470935    .0165245
      yr1983 |  -.0095461   .0275743    -0.35   0.729    -.0635907    .0444984
      yr1984 |    .004071   .0298987     0.14   0.892    -.0545293    .0626713
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980
    yr1981 yr1982 yr1983 yr1984)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).L.n
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -3.60  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.52  Pr > z =  0.606
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   =  67.59  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   =  31.38  Prob > chi2 =  0.177
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984)
    Hansen test excluding group:     chi2(11)   =  12.01  Prob > chi2 =  0.363
    Difference (null H = exogenous): chi2(14)   =  19.37  Prob > chi2 =  0.151

r; t=0.10 21:37:51

. 
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.(n w k)) iv(L(0/2).ys yr*) nolevel robust small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1981 dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 90                      Obs per group: min =         4
F(0, 140)     =         .                                      avg =      4.36
Prob > F      =         .                                      max =         6
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .8179867   .0859779     9.51   0.000     .6480038    .9879695
         L2. |  -.1122756   .0502376    -2.23   0.027     -.211598   -.0129532
             |
           w |
         --. |  -.6816685   .1425842    -4.78   0.000    -.9635652   -.3997718
         L1. |   .6557083   .2023722     3.24   0.001     .2556076    1.055809
             |
           k |
         --. |   .3525689   .1218022     2.89   0.004     .1117594    .5933784
         L1. |  -.1536626   .0862946    -1.78   0.077    -.3242716    .0169464
         L2. |  -.0304529   .0321362    -0.95   0.345    -.0939879     .033082
             |
          ys |
         --. |   .6509498   .1895859     3.43   0.001     .2761283    1.025771
         L1. |  -.9162028   .2639328    -3.47   0.001    -1.438012   -.3943934
         L2. |   .2786584   .1855324     1.50   0.135    -.0881491     .645466
             |
      yr1978 |   .0136266   .0289906     0.47   0.639    -.0436895    .0709426
      yr1979 |   .0249536   .0261443     0.95   0.341     -.026735    .0766422
      yr1980 |   .0399954   .0189615     2.11   0.037     .0025074    .0774833
      yr1982 |  -.0214344   .0180256    -1.19   0.236    -.0570719    .0142031
      yr1983 |  -.0172179   .0298642    -0.58   0.565    -.0762611    .0418253
      yr1984 |  -.0102721   .0350004    -0.29   0.770    -.0794697    .0589254
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983
    yr1984)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.n L.w L.k)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -5.39  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.78  Pr > z =  0.436
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(74)   = 120.62  Prob > chi2 =  0.001
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(74)   =  73.72  Prob > chi2 =  0.487
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984)
    Hansen test excluding group:     chi2(65)   =  56.99  Prob > chi2 =  0.750
    Difference (null H = exogenous): chi2(9)    =  16.72  Prob > chi2 =  0.053

r; t=0.25 21:37:51

. 
. // ROODMAN.3.4 Instrumenting with variables orthogonal to the fixed effects
. 
. xtabond2 n L.n L(0/1).(w k) yr*, gmmstyle(L.(n w k)) ivstyle(yr*, equation(level)) robust small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1982 dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       891
Time variable : year                            Number of groups   =       140
Number of instruments = 113                     Obs per group: min =         6
F(12, 139)    =   6359.46                                      avg =      6.36
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .9356053   .0265692    35.21   0.000     .8830733    .9881373
             |
           w |
         --. |  -.6309761   .1192843    -5.29   0.000    -.8668224   -.3951297
         L1. |   .4826203   .1383143     3.49   0.001     .2091483    .7560922
             |
           k |
         --. |   .4839299   .0544285     8.89   0.000      .376315    .5915448
         L1. |  -.4243928   .0590885    -7.18   0.000    -.5412213   -.3075644
             |
      yr1977 |  -.0144379   .0277155    -0.52   0.603    -.0692363    .0403604
      yr1978 |  -.0080329   .0189286    -0.42   0.672    -.0454582    .0293923
      yr1979 |   .0069679   .0158957     0.44   0.662    -.0244608    .0383965
      yr1980 |  -.0077801   .0179305    -0.43   0.665    -.0432318    .0276715
      yr1981 |  -.0339089   .0145449    -2.33   0.021    -.0626668   -.0051511
      yr1983 |   .0134326   .0176951     0.76   0.449    -.0215537    .0484189
      yr1984 |   .0096193   .0186831     0.51   0.607    -.0273204    .0465591
       _cons |   .5425817   .1961218     2.77   0.006     .1548142    .9303493
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.n L.w L.k)
Instruments for levels equation
  Standard
    yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    D.(L.n L.w L.k)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -5.46  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.25  Pr > z =  0.804
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(100)  = 157.54  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(100)  = 110.70  Prob > chi2 =  0.218
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(79)   =  84.33  Prob > chi2 =  0.320
    Difference (null H = exogenous): chi2(21)   =  26.37  Prob > chi2 =  0.193
  iv(yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984, eq(level))
    Hansen test excluding group:     chi2(93)   = 107.79  Prob > chi2 =  0.140
    Difference (null H = exogenous): chi2(7)    =   2.91  Prob > chi2 =  0.893

r; t=0.33 21:37:52

. 
. 
. 
. // ROODMAN.4.2 More examples
. 
.         use ../data/abdata, clear
r; t=0.00 21:37:52

.                 xtset

Panel variable: id (unbalanced)
 Time variable: year, 1976 to 1984
         Delta: 1 unit
r; t=0.00 21:37:52

. 
. //              xi: xtabond2 y L.y i.t, gmmstyle(L.y) ivstyle(i.t) robust noleveleq     
. 
. //              xi: xtabond2 y L.y w1 w2 w3 i.t, gmmstyle(L.y w2 L.w3) ivstyle(i.t w1) twostep robust small orthogonal
. 
. 
. regress n w k

      Source |       SS           df       MS      Number of obs   =     1,031
-------------+----------------------------------   F(2, 1028)      =   2591.53
       Model |  1546.83293         2  773.416465   Prob > F        =    0.0000
    Residual |  306.795882     1,028  .298439574   R-squared       =    0.8345
-------------+----------------------------------   Adj R-squared   =    0.8342
       Total |  1853.62881     1,030  1.79963962   Root MSE        =     .5463

------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           w |  -.3636287   .0648472    -5.61   0.000    -.4908767   -.2363807
           k |   .8108467   .0112641    71.99   0.000     .7887435      .83295
       _cons |   2.556935    .204893    12.48   0.000     2.154878    2.958991
------------------------------------------------------------------------------
r; t=0.00 21:37:52

. abar
Arellano-Bond test for AR(1): z =  28.93  Pr > z = 0.0000
r; t=0.00 21:37:52

. xtabond2 n w k, ivstyle(w k, equation(level)) small arlevels artests(1)
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =      1031
Time variable : year                            Number of groups   =       140
Number of instruments = 3                       Obs per group: min =         7
F(2, 1028)    = 168967.77                                      avg =      7.36
Prob > F      =     0.000                                      max =         9
------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           w |  -.3636287   .0106035   -34.29   0.000    -.3844357   -.3428217
           k |   .8108467   .0018419   440.23   0.000     .8072325     .814461
       _cons |   2.556935   .0335032    76.32   0.000     2.491192    2.622677
------------------------------------------------------------------------------
Instruments for levels equation
  Standard
    w k
    _cons
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in levels:            z = 176.94  Pr > z =  0.000
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(0)    =   0.00  Prob > chi2 =      .
  (Not robust, but not weakened by many instruments.)

r; t=0.00 21:37:52

. 
. ivreg2 n cap (w = k ys), cluster(id)

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on id

Number of clusters (id) =          140                Number of obs =     1031
                                                      F(  2,   139) =     1.35
                                                      Prob > F      =   0.2629
Total (centered) SS     =  1853.628812                Centered R2   = -56.0061
Total (uncentered) SS   =   3003.33911                Uncentered R2 = -34.1836
Residual SS             =  105668.1615                Root MSE      =    10.12

------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           w |   38.22605    32.1738     1.19   0.235    -24.83343    101.2855
         cap |   .1306603   .1651131     0.79   0.429    -.1929555     .454276
       _cons |  -119.4156   101.0545    -1.18   0.237    -317.4789    78.64762
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              1.743
                                                   Chi-sq(2) P-val =    0.4183
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):                4.040
                         (Kleibergen-Paap rk Wald F statistic):          0.878
Stock-Yogo weak ID test critical values: 10% maximal IV size             19.93
                                         15% maximal IV size             11.59
                                         20% maximal IV size              8.75
                                         25% maximal IV size              7.25
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.058
                                                   Chi-sq(1) P-val =    0.8101
------------------------------------------------------------------------------
Instrumented:         w
Included instruments: cap
Excluded instruments: k ys
------------------------------------------------------------------------------
r; t=0.20 21:37:52

. abar, lags(2)
Arellano-Bond test for AR(1): z =   1.17  Pr > z = 0.2427
Arellano-Bond test for AR(2): z =   1.17  Pr > z = 0.2436
r; t=0.01 21:37:52

. xtabond2 n w cap, ivstyle(cap k ys, equation(level)) small robust arlevels
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =      1031
Time variable : year                            Number of groups   =       140
Number of instruments = 4                       Obs per group: min =         7
F(2, 139)     =      2.17                                      avg =      7.36
Prob > F      =     0.118                                      max =         9
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           w |   38.22605   32.32072     1.18   0.239    -25.67775    102.1299
         cap |   .1306603   .1658671     0.79   0.432    -.1972884     .458609
       _cons |  -119.4156    101.516    -1.18   0.241    -320.1308    81.29953
------------------------------------------------------------------------------
Instruments for levels equation
  Standard
    cap k ys
    _cons
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in levels:            z =   1.17  Pr > z =  0.243
Arellano-Bond test for AR(2) in levels:            z =   1.17  Pr > z =  0.244
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(1)    =   1.87  Prob > chi2 =  0.172
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(1)    =   0.06  Prob > chi2 =  0.810
  (Robust, but weakened by many instruments.)

r; t=0.01 21:37:52

. 
. ivreg2 n cap (w = k ys), cluster(id) gmm2s robust

2-Step GMM estimation
---------------------

Estimates efficient for arbitrary heteroskedasticity and clustering on id
Statistics robust to heteroskedasticity and clustering on id

Number of clusters (id) =          140                Number of obs =     1031
                                                      F(  2,   139) =     1.32
                                                      Prob > F      =   0.2695
Total (centered) SS     =  1853.628812                Centered R2   = -47.6071
Total (uncentered) SS   =   3003.33911                Uncentered R2 = -28.9998
Residual SS             =  90099.47967                Root MSE      =    9.348

------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           w |    35.2573   29.70696     1.19   0.235    -22.96729    93.48188
         cap |   .1393315   .1611212     0.86   0.387    -.1764602    .4551232
       _cons |  -110.1717   93.44525    -1.18   0.238     -293.321    72.97765
------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              1.743
                                                   Chi-sq(2) P-val =    0.4183
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):                4.040
                         (Kleibergen-Paap rk Wald F statistic):          0.878
Stock-Yogo weak ID test critical values: 10% maximal IV size             19.93
                                         15% maximal IV size             11.59
                                         20% maximal IV size              8.75
                                         25% maximal IV size              7.25
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.058
                                                   Chi-sq(1) P-val =    0.8101
------------------------------------------------------------------------------
Instrumented:         w
Included instruments: cap
Excluded instruments: k ys
------------------------------------------------------------------------------
r; t=0.03 21:37:52

. abar
Arellano-Bond test for AR(1): z =   1.22  Pr > z = 0.2221
r; t=0.00 21:37:52

. xtabond2 n w cap, ivstyle(cap k ys, equation(level)) twostep artests(1) arlevels
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.

Dynamic panel-data estimation, two-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =      1031
Time variable : year                            Number of groups   =       140
Number of instruments = 4                       Obs per group: min =         7
Wald chi2(2)  =      4.69                                      avg =      7.36
Prob > chi2   =     0.096                                      max =         9
------------------------------------------------------------------------------
           n | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           w |    35.2573   29.70697     1.19   0.235    -22.96729    93.48188
         cap |   .1393315   .1611212     0.86   0.387    -.1764602    .4551232
       _cons |  -110.1717   93.44525    -1.18   0.238     -293.321    72.97765
------------------------------------------------------------------------------
Warning: Uncorrected two-step standard errors are unreliable.

Instruments for levels equation
  Standard
    cap k ys
    _cons
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in levels:            z =   1.22  Pr > z =  0.222
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(1)    =   1.87  Prob > chi2 =  0.172
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(1)    =   0.06  Prob > chi2 =  0.810
  (Robust, but weakened by many instruments.)

r; t=0.01 21:37:52

. 
. xtabond n, lags(1) pre(w, lagstruct(1,.)) pre(k, endog) robust

Arellano–Bond dynamic panel-data estimation     Number of obs     =        751
Group variable: id                              Number of groups  =        140
Time variable: year
                                                Obs per group:
                                                              min =          5
                                                              avg =   5.364286
                                                              max =          7

Number of instruments =     85                  Wald chi2(4)      =     640.06
                                                Prob > chi2       =     0.0000
One-step results
                                     (Std. err. adjusted for clustering on id)
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .5053192   .0825559     6.12   0.000     .3435125    .6671258
             |
           w |
         --. |  -.8653123     .11532    -7.50   0.000    -1.091335   -.6392892
         L1. |    .513431   .1081153     4.75   0.000      .301529    .7253331
             |
           k |   .4402224   .0720008     6.11   0.000     .2991035    .5813414
       _cons |   1.796861   .5112261     3.51   0.000     .7948761    2.798846
------------------------------------------------------------------------------
Instruments for differenced equation
        GMM-type: L(2/.).n L(1/.).L.w L(2/.).k
Instruments for level equation
        Standard: _cons
r; t=0.04 21:37:52

. xtdpd n L.n w L.w k, dgmmiv(w k n) vce(robust)

Dynamic panel-data estimation                   Number of obs     =        891
Group variable: id                              Number of groups  =        140
Time variable: year
                                                Obs per group:
                                                              min =          6
                                                              avg =   6.364286
                                                              max =          8

Number of instruments =     85                  Wald chi2(4)      =     640.06
                                                Prob > chi2       =     0.0000
One-step results
                                     (Std. err. adjusted for clustering on id)
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .5053192   .0825559     6.12   0.000     .3435125    .6671258
             |
           w |
         --. |  -.8653123     .11532    -7.50   0.000    -1.091335   -.6392892
         L1. |    .513431   .1081153     4.75   0.000      .301529    .7253331
             |
           k |   .4402224   .0720008     6.11   0.000     .2991035    .5813414
       _cons |   1.796861   .5112261     3.51   0.000     .7948761    2.798846
------------------------------------------------------------------------------
Instruments for differenced equation
        GMM-type: L(2/.).w L(2/.).k L(2/.).n
Instruments for level equation
        Standard: _cons
r; t=0.01 21:37:52

. xtabond2 n L.n w L.w k, gmmstyle(L.(w n k), eq(diff)) robust
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       891
Time variable : year                            Number of groups   =       140
Number of instruments = 85                      Obs per group: min =         6
Wald chi2(4)  =   2809.92                                      avg =      6.36
Prob > chi2   =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .5053192   .0825559     6.12   0.000     .3435125    .6671258
             |
           w |
         --. |  -.8653123     .11532    -7.50   0.000    -1.091335   -.6392892
         L1. |    .513431   .1081153     4.75   0.000      .301529    .7253331
             |
           k |   .4402224   .0720008     6.11   0.000     .2991035    .5813414
       _cons |   1.796861   .5112261     3.51   0.000     .7948761    2.798846
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.w L.n L.k)
Instruments for levels equation
  Standard
    _cons
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -4.40  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.69  Pr > z =  0.490
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(80)   = 188.34  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(80)   =  98.69  Prob > chi2 =  0.077
  (Robust, but weakened by many instruments.)

r; t=0.20 21:37:52

. 
. 
. forvalues y = 1979/1984 { /* Make variables whose differences are time dummies */
  2.         gen yr`y'c = year>=`y'
  3. }
r; t=0.00 21:37:52

. 
. gen cons = year
r; t=0.00 21:37:52

. 
. xtabond2 n L(0/1).(L.n w) L(0/2).(k ys) yr198?c cons, gmmstyle(L.n) ivstyle(L(0/1).w L(0/2).(k ys) yr198?c cons) noleveleq nocons
> tant small robust
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 41                      Obs per group: min =         4
F(0, 140)     =         .                                      avg =      4.36
Prob > F      =         .                                      max =         6
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .6862261   .1469312     4.67   0.000     .3957352    .9767171
         L2. |  -.0853582   .0569209    -1.50   0.136    -.1978938    .0271774
             |
           w |
         --. |  -.6078208   .1810857    -3.36   0.001     -.965837   -.2498047
         L1. |   .3926237   .1707083     2.30   0.023     .0551242    .7301231
             |
           k |
         --. |   .3568456   .0599742     5.95   0.000     .2382734    .4754178
         L1. |  -.0580012   .0743625    -0.78   0.437    -.2050197    .0890174
         L2. |  -.0199475   .0332414    -0.60   0.549    -.0856674    .0457725
             |
          ys |
         --. |   .6085073   .1753198     3.47   0.001     .2618907    .9551239
         L1. |  -.7111651   .2354613    -3.02   0.003    -1.176685   -.2456454
         L2. |   .1057969   .1434843     0.74   0.462    -.1778792     .389473
             |
     yr1980c |   .0029062   .0160582     0.18   0.857    -.0288417    .0346542
     yr1981c |   -.043344   .0172708    -2.51   0.013    -.0774892   -.0091987
     yr1982c |   -.024839   .0205967    -1.21   0.230    -.0655599    .0158819
     yr1983c |  -.0038161   .0222972    -0.17   0.864    -.0478989    .0402667
     yr1984c |   .0040626   .0222514     0.18   0.855    -.0399297    .0480549
        cons |   .0095545   .0104559     0.91   0.362    -.0111174    .0302263
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(w L.w k L.k L2.k ys L.ys L2.ys yr1980c yr1981c yr1982c yr1983c yr1984c
    cons)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).L.n
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -3.60  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.52  Pr > z =  0.606
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   =  67.59  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   =  31.38  Prob > chi2 =  0.177
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(w L.w k L.k L2.k ys L.ys L2.ys yr1980c yr1981c yr1982c yr1983c yr1984c cons)
    Hansen test excluding group:     chi2(11)   =  12.01  Prob > chi2 =  0.363
    Difference (null H = exogenous): chi2(14)   =  19.37  Prob > chi2 =  0.151

r; t=0.10 21:37:52

. 
. xtdpd n L.n L(0/1).(w k) yr1978-yr1984, dgmm(w k n) lgmm(w k n) liv(yr1978-yr1984) vce(robust) two hascons

Dynamic panel-data estimation                   Number of obs     =        891
Group variable: id                              Number of groups  =        140
Time variable: year
                                                Obs per group:
                                                              min =          6
                                                              avg =   6.364286
                                                              max =          8

Number of instruments =    113                  Wald chi2(12)     =    5912.36
                                                Prob > chi2       =     0.0000
Two-step results
                                     (Std. err. adjusted for clustering on id)
------------------------------------------------------------------------------
             |              WC-robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |    .872881   .0452841    19.28   0.000     .7841259    .9616362
             |
           w |
         --. |  -.7797449   .1165601    -6.69   0.000    -1.008199   -.5512913
         L1. |   .5268032   .1620827     3.25   0.001     .2091269    .8444795
             |
           k |
         --. |   .4700773   .0798591     5.89   0.000     .3135562    .6265983
         L1. |  -.3576081   .0800305    -4.47   0.000     -.514465   -.2007512
             |
      yr1978 |   .0058018   .0197099     0.29   0.768    -.0328288    .0444325
      yr1979 |   .0188977   .0227673     0.83   0.407    -.0257254    .0635207
      yr1980 |   .0028196   .0240708     0.12   0.907    -.0443583    .0499976
      yr1981 |  -.0200226   .0274419    -0.73   0.466    -.0738078    .0337625
      yr1982 |   .0152802   .0233063     0.66   0.512    -.0303992    .0609597
      yr1983 |    .031731   .0234974     1.35   0.177    -.0143231    .0777852
      yr1984 |   .0224206   .0310743     0.72   0.471     -.038484    .0833251
       _cons |   .9484881   .3775501     2.51   0.012     .2085035    1.688473
------------------------------------------------------------------------------
Instruments for differenced equation
        GMM-type: L(2/.).w L(2/.).k L(2/.).n
Instruments for level equation
        GMM-type: LD.w LD.k LD.n
        Standard: yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 _cons
r; t=0.04 21:37:52

. 
. xtabond2 n L.n L(0/1).(w k) yr1978-yr1984, gmmstyle(L.(w k n)) ivstyle(yr1978-yr1984, equation(level)) h(2) robust twostep small
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate optimal weighting matrix for two-step estimation.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, two-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       891
Time variable : year                            Number of groups   =       140
Number of instruments = 113                     Obs per group: min =         6
F(12, 139)    =   2496.76                                      avg =      6.36
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
             |              Corrected
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |    .872881   .0457562    19.08   0.000     .7824129    .9633492
             |
           w |
         --. |  -.7797449   .1177753    -6.62   0.000    -1.012608   -.5468822
         L1. |   .5268032   .1637725     3.22   0.002     .2029958    .8506106
             |
           k |
         --. |   .4700773   .0806917     5.83   0.000     .3105354    .6296191
         L1. |  -.3576081   .0808649    -4.42   0.000    -.5174923   -.1977239
             |
      yr1978 |   .0058018   .0199154     0.29   0.771    -.0335744     .045178
      yr1979 |   .0188977   .0230046     0.82   0.413    -.0265866    .0643819
      yr1980 |   .0028196   .0243218     0.12   0.908    -.0452689    .0509082
      yr1981 |  -.0200226    .027728    -0.72   0.471    -.0748458    .0348006
      yr1982 |   .0152802   .0235492     0.65   0.517    -.0312808    .0618413
      yr1983 |    .031731   .0237424     1.34   0.184     -.015212     .078674
      yr1984 |   .0224206   .0313983     0.71   0.476    -.0396594    .0845005
       _cons |   .9484881   .3814863     2.49   0.014     .1942219    1.702754
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.w L.k L.n)
Instruments for levels equation
  Standard
    yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    D.(L.w L.k L.n)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -5.81  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.15  Pr > z =  0.883
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(100)  = 157.41  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(100)  = 111.59  Prob > chi2 =  0.201
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(79)   =  88.15  Prob > chi2 =  0.225
    Difference (null H = exogenous): chi2(21)   =  23.43  Prob > chi2 =  0.321
  iv(yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984, eq(level))
    Hansen test excluding group:     chi2(93)   = 109.91  Prob > chi2 =  0.111
    Difference (null H = exogenous): chi2(7)    =   1.68  Prob > chi2 =  0.976

r; t=0.39 21:37:53

. 
. 
. //      Arellano & Bond (1991) Table 4
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.n)iv(w L.w L(0/2).(k ys) yr*) nolevel robust //collumn a1
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1978 dropped due to collinearity
yr1980 dropped due to collinearity
yr1981 dropped due to collinearity
yr1983 dropped due to collinearity
yr1980c dropped due to collinearity
yr1982c dropped due to collinearity
yr1984c dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 41                      Obs per group: min =         4
Wald chi2(0)  =         .                                      avg =      4.36
Prob > chi2   =         .                                      max =         6
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .6862261   .1445943     4.75   0.000     .4028266    .9696257
         L2. |  -.0853582   .0560155    -1.52   0.128    -.1951467    .0244302
             |
           w |
         --. |  -.6078208   .1782055    -3.41   0.001    -.9570972   -.2585445
         L1. |   .3926237   .1679931     2.34   0.019     .0633632    .7218842
             |
           k |
         --. |   .3568456   .0590203     6.05   0.000      .241168    .4725233
         L1. |  -.0580012   .0731797    -0.79   0.428    -.2014308    .0854284
         L2. |  -.0199475   .0327126    -0.61   0.542    -.0840631    .0441681
             |
          ys |
         --. |   .6085073   .1725313     3.53   0.000     .2703522    .9466624
         L1. |  -.7111651   .2317163    -3.07   0.002    -1.165321   -.2570095
         L2. |   .1057969   .1412021     0.75   0.454    -.1709542     .382548
             |
      yr1979 |  -.0124607   .0132596    -0.94   0.347    -.0384491    .0135277
      yr1982 |  -.0152845   .0162294    -0.94   0.346    -.0470935    .0165245
      yr1984 |   .0136171   .0188263     0.72   0.469    -.0232818     .050516
     yr1979c |   .0220152   .0177104     1.24   0.214    -.0126966     .056727
     yr1981c |  -.0337895   .0168736    -2.00   0.045    -.0668612   -.0007178
     yr1983c |  -.0095461   .0275743    -0.35   0.729    -.0635907    .0444984
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980
    yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c
    yr1984c)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).L.n
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -3.60  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.52  Pr > z =  0.606
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   =  67.59  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   =  31.38  Prob > chi2 =  0.177
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c 
> yr1983c yr1984c)
    Hansen test excluding group:     chi2(11)   =  12.01  Prob > chi2 =  0.363
    Difference (null H = exogenous): chi2(14)   =  19.37  Prob > chi2 =  0.151

r; t=0.10 21:37:53

. 
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.n)iv(w L.w L(0/2).(k ys) yr*) nolevel twostep //collumn a2
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1978 dropped due to collinearity
yr1980 dropped due to collinearity
yr1981 dropped due to collinearity
yr1983 dropped due to collinearity
yr1980c dropped due to collinearity
yr1982c dropped due to collinearity
yr1984c dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate optimal weighting matrix for two-step estimation.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, two-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 41                      Obs per group: min =         4
Wald chi2(0)  =         .                                      avg =      4.36
Prob > chi2   =         .                                      max =         6
------------------------------------------------------------------------------
           n | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .6287089   .0904543     6.95   0.000     .4514216    .8059961
         L2. |  -.0651882   .0265009    -2.46   0.014     -.117129   -.0132474
             |
           w |
         --. |  -.5257597   .0537692    -9.78   0.000    -.6311453    -.420374
         L1. |   .3112899   .0940116     3.31   0.001     .1270305    .4955492
             |
           k |
         --. |   .2783619   .0449083     6.20   0.000     .1903432    .3663807
         L1. |   .0140994   .0528046     0.27   0.789    -.0893957    .1175946
         L2. |  -.0402484   .0258038    -1.56   0.119    -.0908229     .010326
             |
          ys |
         --. |   .5919243   .1162114     5.09   0.000     .3641542    .8196943
         L1. |  -.5659863   .1396738    -4.05   0.000    -.8397419   -.2922306
         L2. |   .1005433   .1126749     0.89   0.372    -.1202955     .321382
             |
      yr1979 |  -.0118533   .0107297    -1.10   0.269    -.0328832    .0091766
      yr1982 |   -.009758   .0137275    -0.71   0.477    -.0366635    .0171474
      yr1984 |  -.0053743   .0122757    -0.44   0.662    -.0294343    .0186856
     yr1979c |   .0230688   .0136626     1.69   0.091    -.0037094    .0498471
     yr1981c |  -.0444267   .0132806    -3.35   0.001    -.0704561   -.0183972
     yr1983c |   .0033647   .0195715     0.17   0.864    -.0349948    .0417242
------------------------------------------------------------------------------
Warning: Uncorrected two-step standard errors are unreliable.

Instruments for first differences equation
  Standard
    D.(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980
    yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c
    yr1984c)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).L.n
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -3.00  Pr > z =  0.003
Arellano-Bond test for AR(2) in first differences: z =  -0.42  Pr > z =  0.678
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(25)   =  67.59  Prob > chi2 =  0.000
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(25)   =  31.38  Prob > chi2 =  0.177
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(w L.w k L.k L2.k ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c 
> yr1983c yr1984c)
    Hansen test excluding group:     chi2(11)   =  12.01  Prob > chi2 =  0.363
    Difference (null H = exogenous): chi2(14)   =  19.37  Prob > chi2 =  0.151

r; t=0.11 21:37:53

. 
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.(n w k)) iv(L(0/2).ys yr*) nolevel robust small //collumn c
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1978 dropped due to collinearity
yr1980 dropped due to collinearity
yr1981 dropped due to collinearity
yr1983 dropped due to collinearity
yr1980c dropped due to collinearity
yr1982c dropped due to collinearity
yr1984c dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 90                      Obs per group: min =         4
F(0, 140)     =         .                                      avg =      4.36
Prob > F      =         .                                      max =         6
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .8179867   .0859779     9.51   0.000     .6480038    .9879695
         L2. |  -.1122756   .0502376    -2.23   0.027     -.211598   -.0129532
             |
           w |
         --. |  -.6816685   .1425842    -4.78   0.000    -.9635652   -.3997718
         L1. |   .6557083   .2023722     3.24   0.001     .2556076    1.055809
             |
           k |
         --. |   .3525689   .1218022     2.89   0.004     .1117594    .5933784
         L1. |  -.1536626   .0862946    -1.78   0.077    -.3242716    .0169464
         L2. |  -.0304529   .0321362    -0.95   0.345    -.0939879     .033082
             |
          ys |
         --. |   .6509498   .1895859     3.43   0.001     .2761283    1.025771
         L1. |  -.9162028   .2639328    -3.47   0.001    -1.438012   -.3943934
         L2. |   .2786584   .1855324     1.50   0.135    -.0881491     .645466
             |
      yr1979 |  -.0150417   .0139742    -1.08   0.284    -.0426696    .0125861
      yr1982 |  -.0214344   .0180256    -1.19   0.236    -.0570719    .0142031
      yr1984 |   .0069458   .0191615     0.36   0.718    -.0309376    .0448291
     yr1979c |   .0263688   .0173746     1.52   0.131    -.0079817    .0607193
     yr1981c |  -.0399954   .0189615    -2.11   0.037    -.0774833   -.0025074
     yr1983c |  -.0172179   .0298642    -0.58   0.565    -.0762611    .0418253
------------------------------------------------------------------------------
Instruments for first differences equation
  Standard
    D.(ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983
    yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c yr1984c)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.n L.w L.k)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -5.39  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.78  Pr > z =  0.436
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(74)   = 120.62  Prob > chi2 =  0.001
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(74)   =  73.72  Prob > chi2 =  0.487
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c yr1984c)
    Hansen test excluding group:     chi2(65)   =  56.99  Prob > chi2 =  0.750
    Difference (null H = exogenous): chi2(9)    =  16.72  Prob > chi2 =  0.053

r; t=0.24 21:37:53

. 
. xtabond2 n L.n L2.n w L.w L(0/2).(k ys) yr*, gmm(L.(n w k)) iv(L(0/2).ys yr*) nolevel twostep small //collumn d
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1978 dropped due to collinearity
yr1980 dropped due to collinearity
yr1981 dropped due to collinearity
yr1983 dropped due to collinearity
yr1980c dropped due to collinearity
yr1982c dropped due to collinearity
yr1984c dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate optimal weighting matrix for two-step estimation.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, two-step difference GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       611
Time variable : year                            Number of groups   =       140
Number of instruments = 90                      Obs per group: min =         4
F(0, 140)     =         .                                      avg =      4.36
Prob > F      =         .                                      max =         6
------------------------------------------------------------------------------
           n | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .8242881   .0271067    30.41   0.000     .7706968    .8778795
         L2. |  -.1013473   .0158176    -6.41   0.000    -.1326196    -.070075
             |
           w |
         --. |  -.7113729    .024609   -28.91   0.000    -.7600263   -.6627195
         L1. |   .6313503   .0374304    16.87   0.000     .5573484    .7053523
             |
           k |
         --. |   .3765693   .0333274    11.30   0.000     .3106793    .4424593
         L1. |  -.1686157   .0307898    -5.48   0.000    -.2294887   -.1077426
         L2. |  -.0581173    .015815    -3.67   0.000    -.0893843   -.0268502
             |
          ys |
         --. |   .6622805   .0645927    10.25   0.000     .5345773    .7899838
         L1. |  -.9428695   .0832546   -11.33   0.000    -1.107468   -.7782706
         L2. |   .3606436   .0815112     4.42   0.000     .1994916    .5217956
             |
      yr1979 |  -.0130269   .0058379    -2.23   0.027    -.0245686   -.0014851
      yr1982 |  -.0101348   .0077956    -1.30   0.196    -.0255472    .0052776
      yr1984 |   .0031253   .0050711     0.62   0.539    -.0069005    .0131512
     yr1979c |   .0298765   .0074797     3.99   0.000     .0150887    .0446643
     yr1981c |  -.0417535   .0079975    -5.22   0.000    -.0575649   -.0259421
     yr1983c |   .0072302   .0138158     0.52   0.602    -.0200844    .0345447
------------------------------------------------------------------------------
Warning: Uncorrected two-step standard errors are unreliable.

Instruments for first differences equation
  Standard
    D.(ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983
    yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c yr1984c)
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.n L.w L.k)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -4.97  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.93  Pr > z =  0.352
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(74)   = 120.62  Prob > chi2 =  0.001
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(74)   =  73.72  Prob > chi2 =  0.487
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  iv(ys L.ys L2.ys yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c yr1984c)
    Hansen test excluding group:     chi2(65)   =  56.99  Prob > chi2 =  0.750
    Difference (null H = exogenous): chi2(9)    =  16.72  Prob > chi2 =  0.053

r; t=0.26 21:37:54

. 
. //Bludell & Bond (1998) Table 4
. xtabond2 n L.n L(0/1).(w k) yr*, gmmstyle(L.(n w k)) ivstyle(yr*, equation(level)) h(1) robust small // collumn 4
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1978 dropped due to collinearity
yr1980 dropped due to collinearity
yr1981 dropped due to collinearity
yr1983 dropped due to collinearity
yr1980c dropped due to collinearity
yr1982c dropped due to collinearity
yr1984c dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       891
Time variable : year                            Number of groups   =       140
Number of instruments = 113                     Obs per group: min =         6
F(12, 139)    =   1521.06                                      avg =      6.36
Prob > F      =     0.000                                      max =         8
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .8113292   .0585228    13.86   0.000     .6956193    .9270392
             |
           w |
         --. |  -.7935619   .0980775    -8.09   0.000    -.9874786   -.5996452
         L1. |    .550311   .1527133     3.60   0.000     .2483696    .8522523
             |
           k |
         --. |   .4263322      .0773     5.52   0.000     .2734963     .579168
         L1. |  -.2781138   .0785579    -3.54   0.001    -.4334367   -.1227908
             |
      yr1977 |  -.0077522   .0203681    -0.38   0.704    -.0480235    .0325192
      yr1979 |   .0221674   .0114505     1.94   0.055    -.0004723    .0448071
      yr1982 |   .0285095   .0139066     2.05   0.042     .0010137    .0560052
      yr1984 |  -.0139941   .0181196    -0.77   0.441    -.0498199    .0218317
     yr1979c |  -.0083882   .0114564    -0.73   0.465    -.0310396    .0142632
     yr1981c |  -.0269097   .0144458    -1.86   0.065    -.0554717    .0016523
     yr1983c |   .0417968   .0219433     1.90   0.059    -.0015891    .0851826
       _cons |   1.009684   .4210624     2.40   0.018     .1771684    1.842199
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/8).(L.n L.w L.k)
Instruments for levels equation
  Standard
    yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c
    yr1980c yr1981c yr1982c yr1983c yr1984c
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    D.(L.n L.w L.k)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -6.48  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =  -0.08  Pr > z =  0.933
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(100)  = 114.01  Prob > chi2 =  0.160
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(100)  = 114.87  Prob > chi2 =  0.147
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(79)   =  90.85  Prob > chi2 =  0.171
    Difference (null H = exogenous): chi2(21)   =  24.03  Prob > chi2 =  0.292
  iv(yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c yr1984c, eq(level))
    Hansen test excluding group:     chi2(93)   = 111.63  Prob > chi2 =  0.091
    Difference (null H = exogenous): chi2(7)    =   3.24  Prob > chi2 =  0.862

r; t=0.31 21:37:54

. 
. drop if year==1976 | year==1977 | year==1978
(358 observations deleted)
r; t=0.00 21:37:54

. 
. xtabond2 n L.n L(0/1).(w k) yr*, gmmstyle(L.(n w k)) ivstyle(yr*, equation(level)) h(1) robust small // column 2
Favoring space over speed. To switch, type or click on mata: mata set matafavor speed, perm.
yr1976 dropped due to collinearity
yr1977 dropped due to collinearity
yr1978 dropped due to collinearity
yr1979 dropped due to collinearity
yr1982 dropped due to collinearity
yr1979c dropped due to collinearity
yr1980c dropped due to collinearity
yr1981c dropped due to collinearity
yr1982c dropped due to collinearity
yr1983c dropped due to collinearity
yr1984c dropped due to collinearity
Warning: Two-step estimated covariance matrix of moments is singular.
  Using a generalized inverse to calculate robust weighting matrix for Hansen test.
  Difference-in-Sargan/Hansen statistics may be negative.

Dynamic panel-data estimation, one-step system GMM
------------------------------------------------------------------------------
Group variable: id                              Number of obs      =       533
Time variable : year                            Number of groups   =       140
Number of instruments = 47                      Obs per group: min =         3
F(9, 139)     =   1798.26                                      avg =      3.81
Prob > F      =     0.000                                      max =         5
------------------------------------------------------------------------------
             |               Robust
           n | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
           n |
         L1. |   .9314821   .0635687    14.65   0.000     .8057955    1.057169
             |
           w |
         --. |  -1.112616   .2186147    -5.09   0.000    -1.544856   -.6803761
         L1. |   .8729011   .1518676     5.75   0.000     .5726318     1.17317
             |
           k |
         --. |   .9066123   .2381747     3.81   0.000     .4356987    1.377526
         L1. |  -.8766821   .2608927    -3.36   0.001    -1.392513   -.3608508
             |
      yr1980 |  -.0618582   .0300359    -2.06   0.041    -.1212445   -.0024719
      yr1981 |  -.0460462   .0190407    -2.42   0.017    -.0836931   -.0083993
      yr1983 |  -.0140872   .0238577    -0.59   0.556    -.0612581    .0330837
      yr1984 |   -.036851   .0363216    -1.01   0.312    -.1086652    .0349633
       _cons |   .8908582   .4977168     1.79   0.076    -.0932165    1.874933
------------------------------------------------------------------------------
Instruments for first differences equation
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    L(1/5).(L.n L.w L.k)
Instruments for levels equation
  Standard
    yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c
    yr1980c yr1981c yr1982c yr1983c yr1984c
    _cons
  GMM-type (missing=0, separate instruments for each period unless collapsed)
    D.(L.n L.w L.k)
------------------------------------------------------------------------------
Arellano-Bond test for AR(1) in first differences: z =  -3.48  Pr > z =  0.000
Arellano-Bond test for AR(2) in first differences: z =   0.83  Pr > z =  0.405
------------------------------------------------------------------------------
Sargan test of overid. restrictions: chi2(37)   =  30.14  Prob > chi2 =  0.781
  (Not robust, but not weakened by many instruments.)
Hansen test of overid. restrictions: chi2(37)   =  38.61  Prob > chi2 =  0.397
  (Robust, but weakened by many instruments.)

Difference-in-Hansen tests of exogeneity of instrument subsets:
  GMM instruments for levels
    Hansen test excluding group:     chi2(25)   =  18.79  Prob > chi2 =  0.807
    Difference (null H = exogenous): chi2(12)   =  19.82  Prob > chi2 =  0.071
  iv(yr1976 yr1977 yr1978 yr1979 yr1980 yr1981 yr1982 yr1983 yr1984 yr1979c yr1980c yr1981c yr1982c yr1983c yr1984c, eq(level))
    Hansen test excluding group:     chi2(32)   =  33.66  Prob > chi2 =  0.387
    Difference (null H = exogenous): chi2(5)    =   4.95  Prob > chi2 =  0.422

r; t=0.16 21:37:54

. 
. 
. ////////
> 
. // -> UNIT ROOT TESTS (URT)
. 
.         /*
>         
>         // The dataset 'pennxrate.dta' contains real exchange-rate data for a panel of countries observed over 34 years
> 
>                 use https://www.stata-press.com/data/r16/pennxrate, clear
>                         save ../data/pennxrate, replace
>         
>         */
. 
. 
. use ../data/pennxrate, clear
r; t=0.00 21:37:54

. 
. // URT.1 Levin–Lin–Chu test
. 
.         xtunitroot llc lnrxrate if g7, lags(aic 10)

Levin–Lin–Chu unit-root test for lnrxrate
-----------------------------------------
H0: Panels contain unit roots               Number of panels  =      6
Ha: Panels are stationary                   Number of periods =     34

AR parameter: Common                        Asymptotics: N/T -> 0
Panel means:  Included
Time trend:   Not included

ADF regressions: 1.00 lags average (chosen by AIC)
LR variance:     Bartlett kernel, 10.00 lags average (chosen by LLC)
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 Unadjusted t        -6.7538
 Adjusted t*         -4.0277        0.0000
------------------------------------------------------------------------------
r; t=0.39 21:37:54

.         xtunitroot llc lnrxrate if g7, lags(aic 10) demean

Levin–Lin–Chu unit-root test for lnrxrate
-----------------------------------------
H0: Panels contain unit roots               Number of panels  =      6
Ha: Panels are stationary                   Number of periods =     34

AR parameter: Common                        Asymptotics: N/T -> 0
Panel means:  Included
Time trend:   Not included                  Cross-sectional means removed

ADF regressions: 1.50 lags average (chosen by AIC)
LR variance:     Bartlett kernel, 10.00 lags average (chosen by LLC)
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 Unadjusted t        -5.5473
 Adjusted t*         -2.0813        0.0187
------------------------------------------------------------------------------
r; t=0.42 21:37:55

.         
. // URT.2 Harris–Tsavalis test
. 
.         xtunitroot ht lnrxrate, demean

Harris-Tzavalis unit-root test for lnrxrate
-------------------------------------------
H0: Panels contain unit roots               Number of panels  =    151
Ha: Panels are stationary                   Number of periods =     34

AR parameter: Common                        Asymptotics: N -> Infinity
Panel means:  Included                                   T Fixed
Time trend:   Not included                  Cross-sectional means removed
------------------------------------------------------------------------------
                    Statistic         z         p-value
------------------------------------------------------------------------------
 rho                  0.8184      -13.1239       0.0000
------------------------------------------------------------------------------
r; t=0.04 21:37:55

.         
.         
. // URT.3 Breitung test
. 
.         xtunitroot breitung lnrxrate if oecd, robust

Breitung unit-root test for lnrxrate
--------------------------------------
H0: Panels contain unit roots               Number of panels  =     27
Ha: Panels are stationary                   Number of periods =     34

AR parameter: Common                        Asymptotics:  T,N -> Infinity
Panel means:  Included                                        sequentially
Time trend:   Not included                  Prewhitening: Not performed
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 lambda*             -1.6794        0.0465
------------------------------------------------------------------------------
 * Lambda robust to cross-sectional correlation
r; t=0.02 21:37:55

.         
. 
. // URT.4 Im–Pesaran–Shin test
. 
.         xtunitroot ips lnrxrate if oecd, demean

Im–Pesaran–Shin unit-root test for lnrxrate
-------------------------------------------
H0: All panels contain unit roots           Number of panels  =     27
Ha: Some panels are stationary              Number of periods =     34

AR parameter: Panel-specific                Asymptotics: T,N -> Infinity
Panel means:  Included                                        sequentially
Time trend:   Not included                  Cross-sectional means removed

ADF regressions: No lags included
------------------------------------------------------------------------------
                                              Fixed-N exact critical values
                    Statistic      p-value         1%      5%      10%
------------------------------------------------------------------------------
 t-bar               -3.1327                     -1.810  -1.730  -1.680
 t-tilde-bar         -2.5771
 Z-t-tilde-bar       -7.3911        0.0000
------------------------------------------------------------------------------
r; t=0.13 21:37:55

.         
.         xtunitroot ips lnrxrate if oecd, lags(aic 8) demean

Im–Pesaran–Shin unit-root test for lnrxrate
-------------------------------------------
H0: All panels contain unit roots           Number of panels  =     27
Ha: Some panels are stationary              Number of periods =     34

AR parameter: Panel-specific                Asymptotics: T,N -> Infinity
Panel means:  Included                                        sequentially
Time trend:   Not included                  Cross-sectional means removed

ADF regressions: 1.48 lags average (chosen by AIC)
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 W-t-bar             -7.3075        0.0000
------------------------------------------------------------------------------
r; t=1.02 21:37:56

.         
. // URT.5 Fisher-type tests
. 
.         xtunitroot fisher lnrxrate, dfuller drift lags(2) demean

Fisher-type unit-root test for lnrxrate
Based on augmented Dickey–Fuller tests
---------------------------------------
H0: All panels contain unit roots           Number of panels  =    151
Ha: At least one panel is stationary        Number of periods =     34

AR parameter: Panel-specific                Asymptotics: T -> Infinity
Panel means:  Included
Time trend:   Not included                  Cross-sectional means removed
Drift term:   Included                      ADF regressions: 2 lags
------------------------------------------------------------------------------
                                  Statistic      p-value
------------------------------------------------------------------------------
 Inverse chi-squared(302)  P       975.9130       0.0000
 Inverse normal            Z       -19.6183       0.0000
 Inverse logit t(759)      L*      -20.9768       0.0000
 Modified inv. chi-squared Pm       27.4211       0.0000
------------------------------------------------------------------------------
 P statistic requires number of panels to be finite.
 Other statistics are suitable for finite or infinite number of panels.
------------------------------------------------------------------------------
r; t=0.96 21:37:57

. 
. // URT.6 Hadri LM test
. 
.         xtunitroot hadri lnrxrate if oecd, kernel(bartlett 5) demean

Hadri LM test for lnrxrate
----------------------------
H0: All panels are stationary               Number of panels  =     27
Ha: Some panels contain unit roots          Number of periods =     34

Time trend:         Not included            Asymptotics: T, N -> Infinity
Heteroskedasticity: Robust                                    sequentially
LR variance:        Bartlett kernel, 5 lags Cross-sectional means removed
------------------------------------------------------------------------------
                    Statistic      p-value
------------------------------------------------------------------------------
 z                    9.6473        0.0000
------------------------------------------------------------------------------
r; t=0.12 21:37:57

. 
. //////////////////////
> 
.         timer off 1
r; t=0.00 21:37:57

.         timer list 1
   1:     44.54 /        1 =      44.5410
r; t=0.00 21:37:57

.                 
.                 di _new(2) "SECONDS: " %9.1f round(r(t1),0.1)  "                MINUTES: " %9.2f round(r(t1)/60,0.01) _new(1)


SECONDS:      44.5                MINUTES:      0.74

r; t=0.00 21:37:57

. 
.                 timer clear 1
r; t=0.00 21:37:57

. 
. log close
      name:  <unnamed>
       log:  /Users/miguelportela/Documents/GitHub/Stata_Training/3.Panel_Data/logs/paneldata.txt
  log type:  text
 closed on:  28 Dec 2021, 21:37:57
-----------------------------------------------------------------------------------------------------------------------------------
